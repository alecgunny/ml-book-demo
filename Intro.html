

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>AI, Machine Learning, and Deep Learning &#8212; Intro to ML</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Intro to ML</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="#">
   AI, Machine Learning, and Deep Learning
  </a>
 </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Intro.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ai-machine-learning-and-deep-learning">
<h1>AI, Machine Learning, and Deep Learning<a class="headerlink" href="#ai-machine-learning-and-deep-learning" title="Permalink to this headline">¶</a></h1>
<p>Artificial Intelligence (AI), a broad technical term generally agreed to be first discussed <em>in concept</em> by <a class="reference external" href="https://watermark.silverchair.com/lix-236-433.pdf?token=AQECAHi208BE49Ooan9kkhW_Ercy7Dm3ZL_9Cf3qfKAc485ysgAAAqwwggKoBgkqhkiG9w0BBwagggKZMIIClQIBADCCAo4GCSqGSIb3DQEHATAeBglghkgBZQMEAS4wEQQMVWWgpsCtEoCPpAH6AgEQgIICXwN8ibRzPvazu4YkOlMZpU9IQu68dd6TzcVh1OKSNO9WZMqUXy6ZtavbAc4-wyUhIo6FfM4cR2RFflVL7vnXK5k12SV372kHP5QbLwVMH9LI5lheHcTPNaNzEYJ4tq5smjYYvmYOs5Cf1topdvP4rmoRymRujjy00HvO6A2WtV5iOAcOI3FISuG4Hp3Cf-_WKdor3SJgMNSd6x_ZZnqk3WiYx2uyL7D6n96nCG7BsdpGSc7F27Z-YwGben1q0NEYxa8QK5B1rwi_n4Q31usLo0V3TGTAb9gANpynV6Y0sg23QM9z4aFPnW1kPazK4lTR4KikRP112subUBix3M1dMABtLAE0ts105m5QUCv3VDXvPVwl2ePKB8PKyiAUvuoW65Yoif5QtjONthEZMcjenO6gi3YrFFDgNw1KqoXvxjU_v0Ii1ujQLAacpBUvA45eg8AD5KbE4I8SRd8zHIQud67sYahj4jwNBKPfrDOL_SwyNAAQM7Kdpaot8xJ0Km8-LPhjZ2rLXMnjEAIsruDOfRjTKzkPT3Uqz2imynq9XxgS9YLJ2y77mHRwWfsF8WH7_hCdSbXzW4Vr5_ZXLWOQcdugZCM1DHefxAhMthjBMuYd-50xgPKdDbGEhAZTSKxPjS8vbayJWg465J-VfE4LGpt3iJ978XYBy7v_KtCfy5m_FK18DLiw8AXiZkKKNpx074Kipg9pwr_hXX3Llz5CG_JyNQ0lYqyxAbAOt5-bbpgepHCYe_cQ0Uy4Z-oQTFVTKvoLKYe6Gyc8p8yJLhj9g1GA7_TP-KGL6CGaWyovEgw">Alan Turing’s excellent “Imitation Game” paper in 1950</a>, but first explicitly coined in 1956, has taken on a life of its own in the public imagination. In recent years, the apocalyptic connotations bestowed on it by films like <em>The Terminator</em> and <em>2001: A Space Odyssey</em> has begun to be supplanted by its liberal use in <a class="reference external" href="https://www.forbes.com/sites/bernardmarr/2018/05/25/stitch-fix-the-amazing-use-case-of-using-artificial-intelligence-in-fashion-retail/#53bc5c3f3292">banal</a> <a class="reference external" href="https://www.cmo.com.au/article/669073/how-thirdlove-used-ai-better-personalisation/">branding</a> <a class="reference external" href="https://www.forbes.com/sites/parmyolson/2019/03/04/nearly-half-of-all-ai-startups-are-cashing-in-on-hype/#d85ee88d0221">exercises</a> that stand in stark contrast to Elon Musk’s <a class="reference external" href="https://www.vanityfair.com/news/2017/03/elon-musk-billion-dollar-crusade-to-stop-ai-space-x">dire warnings about AI domination</a>, leaving most people wondering what it means when a company says they’re “using AI.”</p>
<p>Of course, the broad use of this term stems in no small part from its (several) broad definitions that play with both the concepts of “artificial” and “intelligence”. Recently, it has become common to refer more specifically to “machine learning” (ML), a term referring to a specific “flavor” of AI that manages to avoid the loaded connotations of “intelligence” and is generally more precise, as it is the most common way in which AI is practiced today. Unfortunately, it too has begun to inherit much of the vagueness and hype of AI, especially as it becomes fashionable to let people know both that you’re “doing” AI, but are also not one of the hucksters that uses the term “AI”.</p>
<p>At this point, volumes have been written about the merits of the “intelligence” displayed by modern machine learning (and specifically deep learning (DL), a sub-category of the sub-category of ML) systems like GPT3 and AlphaZero which are, intelligence aside, astonishing achievements of engineering that deserve praise and careful consideration by both industry professionals and the public. And while I find these conversations fascinating and enlightening, I’m not really interested in writing about it here, both because I consider myself far from an expert and because I feel like sharing code and graphs and other things that those discussions wouldn’t necessarily entail (at least not if I want to run it on my laptop, which I do).</p>
<p>Instead, I think it’s worth trying to clear up some of the confusion over what these terms <em>mean</em> and how these definitions emerge as practical implementations. In this way, we can exercise more skepticism when we hear these terms used popular culture and learn to separate the bland from the exciting from the horrifying.</p>
<p>So let’s start with the biggest tent we can: artificial intelligence. What does it mean for a machine to be intelligent? Francois Chollet, creator the deep learning library Keras, recently wrote a <a class="reference external" href="https://arxiv.org/abs/1911.01547">fascinating paper</a> on the subject, distinguishing “skilled” systems from “intelligent” ones. Skilled systems can perform a constrained and narrowly defined task in some specific domain, whereas intelligent systems (like ourselves) can perform a broad range of tasks across a variety of domains and, importantly, can quickly pick up <em>new</em> skills, often need only a handful of attempts and <em>without sacrificing skill on other tasks</em>.</p>
<p>More often than not, the “AI” systems in production today fall under the first category. And while this may seem disappointing in comparison to a truly intelligent system, the reality is that many of these narrow and constrained tasks are still extremely useful! Spam email filters may not be able to beat you in chess, but they make your inbox much less cluttered and risky. Object detectors on car backup cameras may not even be useful when fed images from a different camera, but they still keep kids in your driveway safer. In this sense, we can think of successful AI systems as the combination of intelligent engineering (done by us) of skilled artificial subsystems (whatever algorithm is flagging spam or detecting objects).</p>
<p>With this constrained definition of AI in mind, let’s implement a few differnt AI systems on such a simple task and start to get an idea of what makes ML a subset of AI, and what distinguishes the two. The task we’ll pick is a common toy problem in the AI/ML literature of classifying iris species based on measurements of their sepal and petal lengths and widths. Mathematically, we want to build a function that can map from these four <em>continuous</em> measurements to a single <em>categorical</em> value. This function is the “skill” in question.</p>
<p>Before we begin, it’s worth asking the question: why would I want to do this? Well, the reality is that <em>you</em> probably don’t. You probably get along just fine day-to-day without knowing what types of irises you’re looking at (or even measuring them for that matter). But the assumption is that if you’re reading this, you have some problem that can be solved with a skill <em>like</em> this one, and the techniques we’ll leverage will be as useful in solving your task. As for why we would want a machine to solve this problem (especially one that we’ll see is reasonably simple), the reality is that even slightly more complicated skills, and especially ones that involve more measurements (or <strong>features</strong>), grow exponentially in their difficulty for humans to solve. Moreover, perhaps your problem involves a <em>volume</em> of data that isn’t reasonable to expect someone (or many thousands of someones) to sit there and practice their skill on all day. Luckily, computers can manipulate numbers <em>really fast</em>, and so are well suited to these sorts of problems.</p>
<p>Ok, enough primer, let’s take a look at what measurements we have to go off of:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<p>So how can we use this information to get our computer to learn a new skill? Well, just staring at these numbers doesn’t give us a lot to go off. What if we looked at which measurement values are most common for a given class, and which aren’t? Then we could figure out a rule that looks like “sepal lengths between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are most commonly <em>setosas</em>. So if you’re in that range, then I’m going to say you’re a <em>setosa</em>”. If we can come up with a few good rules and encode them into our computer, then we should be able to feed our computer a <em>new</em> set of measurements and have it return the “right” class!</p>
<p>Would such a system be “intelligent”, in the sense that you and I are intelligent? Of course not. But if you’re a botanist collecting thousands of samples of petal and sepal measurements that you need to classify, that skill would be immensely useful. Let’s take a look at what I mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_notebook</span><span class="p">,</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">column</span><span class="p">,</span> <span class="n">row</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">LegendItem</span><span class="p">,</span> <span class="n">Legend</span>
<span class="kn">import</span> <span class="nn">plot_utils</span>
<span class="n">output_notebook</span><span class="p">()</span>

<span class="c1"># plot distributions for each feature</span>
<span class="c1"># make the last one a little wider to accommodate</span>
<span class="c1"># a legend that all four can use</span>
<span class="n">figures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">):</span>
    <span class="n">fig_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">feature_name</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot; (cm)&quot;</span><span class="p">),</span>
        <span class="s2">&quot;x_axis_label&quot;</span><span class="p">:</span> <span class="n">feature_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;y_axis_label&quot;</span><span class="p">:</span> <span class="s2">&quot;Probability&quot;</span><span class="p">,</span>
        <span class="s2">&quot;plot_height&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;plot_width&quot;</span><span class="p">:</span> <span class="mi">520</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">3</span> <span class="k">else</span> <span class="mi">400</span>
    <span class="p">}</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">plot_utils</span><span class="o">.</span><span class="n">make_distribution_plot</span><span class="p">(</span>
        <span class="n">df</span><span class="p">[[</span><span class="n">feature_name</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">]],</span>
        <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">label_column</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
        <span class="n">fig_kwargs</span><span class="o">=</span><span class="n">fig_kwargs</span>
    <span class="p">)</span>
    <span class="n">figures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># configure a legend on just the last plot</span>
<span class="n">legend_items</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">class_name</span><span class="p">)</span>
    <span class="n">legend_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LegendItem</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">class_name</span><span class="p">,</span> <span class="n">renderers</span><span class="o">=</span><span class="n">r</span><span class="p">))</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">Legend</span><span class="p">(</span>
    <span class="n">items</span><span class="o">=</span><span class="n">legend_items</span><span class="p">,</span>
    <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">column</span><span class="p">(</span><span class="n">row</span><span class="p">(</span><span class="n">figures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">figures</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">row</span><span class="p">(</span><span class="n">figures</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">figures</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">show</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div class="bk-root">
    <a href="https://bokeh.org" target="_blank" class="bk-logo bk-logo-small bk-logo-notebook"></a>
    <span id="1001">Loading BokehJS ...</span>
</div></div><script type="application/javascript">
(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }

  
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById("1001");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    const hashes = {"https://cdn.bokeh.org/bokeh/release/bokeh-2.2.1.min.js": "qkRvDQVAIfzsJo40iRBbxt6sttt0hv4lh74DG7OK4MCHv4C5oohXYoHUM5W11uqS", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.2.1.min.js": "Sb7Mr06a9TNlet/GEBeKaf5xH3eb6AlCzwjtU82wNPyDrnfoiVl26qnvlKjmcAd+", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.2.1.min.js": "HaJ15vgfmcfRtB4c4YBOI4f1MUujukqInOWVqZJZZGK7Q+ivud0OKGSTn/Vm2iso"};

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      if (url in hashes) {
        element.crossOrigin = "anonymous";
        element.integrity = "sha384-" + hashes[url];
      }
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  
  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.2.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.2.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.2.1.min.js"];
  var css_urls = [];
  

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {
    
    
    }
  ];

  function run_inline_js() {
    
    if (root.Bokeh !== undefined || force === true) {
      
    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById("1001")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><div class="output text_html">





<div class="bk-root" id="f728b29e-42c5-4bd7-8c70-f645176d208c" data-root-id="1181"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
    
  var docs_json = {"84b0e2f8-5c7e-4ac2-82d1-815cc4b7f17a":{"roots":{"references":[{"attributes":{"children":[{"id":"1179"},{"id":"1180"}]},"id":"1181","type":"Column"},{"attributes":{"data_source":{"id":"1022"},"glyph":{"id":"1023"},"hover_glyph":null,"muted_glyph":null,"name":"setosa","nonselection_glyph":{"id":"1024"},"selection_glyph":null,"view":{"id":"1026"}},"id":"1025","type":"GlyphRenderer"},{"attributes":{},"id":"1194","type":"BasicTickFormatter"},{"attributes":{"label":{"value":"versicolor"},"renderers":[{"id":"1135"}]},"id":"1165","type":"LegendItem"},{"attributes":{},"id":"1192","type":"BasicTickFormatter"},{"attributes":{},"id":"1196","type":"BasicTickFormatter"},{"attributes":{},"id":"1148","type":"UnionRenderers"},{"attributes":{},"id":"1202","type":"Selection"},{"attributes":{},"id":"1203","type":"UnionRenderers"},{"attributes":{},"id":"1147","type":"Selection"},{"attributes":{"source":{"id":"1137"}},"id":"1141","type":"CDSView"},{"attributes":{},"id":"1204","type":"Selection"},{"attributes":{},"id":"1205","type":"UnionRenderers"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto"},"id":"1056","type":"Toolbar"},{"attributes":{},"id":"1206","type":"Selection"},{"attributes":{"data_source":{"id":"1137"},"glyph":{"id":"1138"},"hover_glyph":null,"muted_glyph":null,"name":"virginica","nonselection_glyph":{"id":"1139"},"selection_glyph":null,"view":{"id":"1141"}},"id":"1140","type":"GlyphRenderer"},{"attributes":{},"id":"1207","type":"UnionRenderers"},{"attributes":{"axis":{"id":"1052"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1055","type":"Grid"},{"attributes":{},"id":"1208","type":"Selection"},{"attributes":{"source":{"id":"1022"}},"id":"1026","type":"CDSView"},{"attributes":{},"id":"1209","type":"UnionRenderers"},{"attributes":{"line_alpha":0.6,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1028","type":"Line"},{"attributes":{},"id":"1210","type":"Selection"},{"attributes":{"line_alpha":0.6,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1033","type":"Line"},{"attributes":{},"id":"1211","type":"UnionRenderers"},{"attributes":{"line_alpha":0.1,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1024","type":"Line"},{"attributes":{},"id":"1212","type":"Selection"},{"attributes":{"data":{"x":{"__ndarray__":"gjwlyFOCEkDPDoEby6ASQBzh3G5CvxJAabM4wrndEkC2hZQVMfwSQANY8GioGhNAUCpMvB85E0Cd/KcPl1cTQOrOA2MOdhNAN6FftoWUE0CEc7sJ/bITQNFFF1100RNAHhhzsOvvE0Br6s4DYw4UQLi8KlfaLBRABY+GqlFLFEBSYeL9yGkUQJ8zPlFAiBRA7AWapLemFEA52PX3LsUUQIaqUUum4xRA03ytnh0CFUAgTwnylCAVQG4hZUUMPxVAuvPAmINdFUAIxhzs+nsVQFSYeD9ymhVAomrUkum4FUDuPDDmYNcVQDwPjDnY9RVAieHnjE8UFkDWs0PgxjIWQCOGnzM+URZAcFj7hrVvFkC9KlfaLI4WQAr9si2krBZAV88OgRvLFkCkoWrUkukWQPFzxicKCBdAPkYie4EmF0CLGH7O+EQXQNjq2SFwYxdAJb01deeBF0Byj5HIXqAXQL9h7RvWvhdADDRJb03dF0BZBqXCxPsXQKbYABY8GhhA86pcabM4GEBAfbi8KlcYQI1PFBCidRhA2iFwYxmUGEAn9Mu2kLIYQHTGJwoI0RhAwZiDXX/vGEAOa9+w9g0ZQFs9OwRuLBlAqA+XV+VKGUD14fKqXGkZQEK0Tv7ThxlAj4aqUUumGUDcWAalwsQZQCkrYvg54xlAdv29S7EBGkDDzxmfKCAaQBCidfKfPhpAXXTRRRddGkCqRi2ZjnsaQPgYiewFmhpAROvkP324GkCSvUCT9NYaQN6PnOZr9RpALGL4OeMTG0B4NFSNWjIbQMYGsODRUBtAEtkLNElvG0Bgq2eHwI0bQKx9w9o3rBtA+k8fLq/KG0BGInuBJukbQJT01tSdBxxA4MYyKBUmHEAumY57jEQcQHpr6s4DYxxAyD1GInuBHEAUEKJ18p8cQGLi/chpvhxArrRZHOHcHED8hrVvWPscQEhZEcPPGR1AlittFkc4HUDj/chpvlYdQDDQJL01dR1AfaKAEK2THUDKdNxjJLIdQBdHOLeb0B1AZBmUChPvHUCx6+9dig0eQP69S7EBLB5AS5CnBHlKHkA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"a0m8AvaYVz/ORVlwQcKhP7qeYILbYa8/VeYMNZfxtD+dV7lV6ca4PwCTLGWwVLs/Tohdpbi+vD9TJ0NYzii9P9pf1L+9trw/rSEIHlOMuz+nXNW0Ws25P4QAM8agnbc/HP0XlPEgtT87QntgGXuyP1N/p9rIn68/b8ow+T2Gqj9iRYCgKvGlP8vPg1QnKKI/gZJSMpnlnj+9Ir3kZTGcP24PI8jlwpw/8gsw8qSUoD+m/aeg4fmkP6Y8Z3PB2Ks/5NMtd268sj/8adtaTwe5P2+sB5ksUMA/bl7G546dxD+4mytVhEXJP002uZzCIc4/hH/4vP+F0T+2YypU+O7TP2ows/GlONY/Ss5Tc+NP2D8DJs22iyHaP0Ug4Jl5mts/uKVN+oen3D+IQuwoozfdP0qO60sRT90/aVDgFbH+3D8dNKHmilfcP6LkBB6nats/LA3iGw5J2j/7WA9AyAPZP0JzY+rdq9c/QAe1eldS1j8vwNpQPQjVP0FJq8yX3tM/t039TW/m0j8aHRbY2i/SP/7QLfLVvNE//E+5AoCE0T8KNnTssH3RPywfGpJAn9E/XKdm1gbg0T+dahWc2zbSP+oE4sWWmtI/QBKINhAC0z+gLsPQH2TTPwX2Tnedt9M/cQTnDGHz0z9UnFTPgQ7UP270mirIBdQ/0zf3uK3b0z8MOLRv65LTP5vGHEQ6LtM/CLV7K1Ow0j/b1Bsb7xvSP5P3RwjHc9E/xu5K6JO60D/EF99gHebPPxJBAazgP84/TPyRnOOHzD/cT9CUksPKP10w1OKC98g/L6KfbzInxz/lVxB4DFbFP4MEBDl8h8M/mVpY7+y+wT9SGtavk/+/P5OdM1/8mrw/7aSEZupWuT+RlYQ/NDq2P3/V7mOwS7M/4cl+TTWSsD/CFaLCGymsP763eA0KrKc/5XBAwe2noz+iMmfoWBagP9XetRq74Zk/oTETdRtilD9fhITp7UGPP5LoPV3jIoc/vFcKb19NgD+bM0ORVE91P77a7U4wYGg/hbJ90GcmVD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1204"},"selection_policy":{"id":"1205"}},"id":"1027","type":"ColumnDataSource"},{"attributes":{},"id":"1213","type":"UnionRenderers"},{"attributes":{},"id":"1214","type":"Selection"},{"attributes":{"source":{"id":"1027"}},"id":"1031","type":"CDSView"},{"attributes":{},"id":"1215","type":"UnionRenderers"},{"attributes":{},"id":"1216","type":"Selection"},{"attributes":{},"id":"1217","type":"UnionRenderers"},{"attributes":{"data":{"x":{"__ndarray__":"gjwlyFOCEkDPDoEby6ASQBzh3G5CvxJAabM4wrndEkC2hZQVMfwSQANY8GioGhNAUCpMvB85E0Cd/KcPl1cTQOrOA2MOdhNAN6FftoWUE0CEc7sJ/bITQNFFF1100RNAHhhzsOvvE0Br6s4DYw4UQLi8KlfaLBRABY+GqlFLFEBSYeL9yGkUQJ8zPlFAiBRA7AWapLemFEA52PX3LsUUQIaqUUum4xRA03ytnh0CFUAgTwnylCAVQG4hZUUMPxVAuvPAmINdFUAIxhzs+nsVQFSYeD9ymhVAomrUkum4FUDuPDDmYNcVQDwPjDnY9RVAieHnjE8UFkDWs0PgxjIWQCOGnzM+URZAcFj7hrVvFkC9KlfaLI4WQAr9si2krBZAV88OgRvLFkCkoWrUkukWQPFzxicKCBdAPkYie4EmF0CLGH7O+EQXQNjq2SFwYxdAJb01deeBF0Byj5HIXqAXQL9h7RvWvhdADDRJb03dF0BZBqXCxPsXQKbYABY8GhhA86pcabM4GEBAfbi8KlcYQI1PFBCidRhA2iFwYxmUGEAn9Mu2kLIYQHTGJwoI0RhAwZiDXX/vGEAOa9+w9g0ZQFs9OwRuLBlAqA+XV+VKGUD14fKqXGkZQEK0Tv7ThxlAj4aqUUumGUDcWAalwsQZQCkrYvg54xlAdv29S7EBGkDDzxmfKCAaQBCidfKfPhpAXXTRRRddGkCqRi2ZjnsaQPgYiewFmhpAROvkP324GkCSvUCT9NYaQN6PnOZr9RpALGL4OeMTG0B4NFSNWjIbQMYGsODRUBtAEtkLNElvG0Bgq2eHwI0bQKx9w9o3rBtA+k8fLq/KG0BGInuBJukbQJT01tSdBxxA4MYyKBUmHEAumY57jEQcQHpr6s4DYxxAyD1GInuBHEAUEKJ18p8cQGLi/chpvhxArrRZHOHcHED8hrVvWPscQEhZEcPPGR1AlittFkc4HUDj/chpvlYdQDDQJL01dR1AfaKAEK2THUDKdNxjJLIdQBdHOLeb0B1AZBmUChPvHUCx6+9dig0eQP69S7EBLB5AS5CnBHlKHkA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"96C8HCMpRj8Edfw0eGF7PzbJrAbyM4g/pRr3os6DkD/xnuyTkyOUPw1RAn78Bpc/jJADCb47mT/+vLvcjM+aP/I19qAd0Js/91p+/SRLnD+hix+aV06cP30npR5q55s/HY7aMhEkmz8WH4t+ARKaP/A5gqnvvpg/Qz6LW5A4lz+Wi3E8mIyVP36BAPS7yJM/kX8DKrD6kT9a5UWGKTCQP9MkJmG57Yw/mcxsofy4iT80gfYcht2GP68BWiO/doQ/Xw0uBBGggj8jYwkP5XSBP0PCgpOkEIE/4+kw4biOgT8CmapHiwqDP/COhhaFn4U/q4pbnQ9piT9fS8ArlIKOPxTIpQi+g5I/EQzKTpiJlj8+URiQjWCbP5P7LTopi6A/rS6w0U3coz+9XR8SUKqnPx4ztQdD+as/Q7mgl91lsD/kieMJJBKzP2aHJKC8ArY/tC3lH+84uT+4+KZOA7a8PzKy9XigPcA/UPaZ5/dEwj+yBgHWq3HEP0ih6yZgxMY/DIQavbg9yT/XAbJl393LP4WvNi/bnc4/44Zwdpq40D/Qq8qiqCXSPwvkG3DKj9M/Gk3WMbLw1D+BBGw7EkLWP8MnT+Ccfdc/YNTxcwSd2D/hJ8ZJ+5nZP8Q/PrUzbto/jTnMCWAT2z+1ygeLaIPbPy1P6Q8Ovds/dMnJAurD2z/10ye+y5vbPxoJgpyCSNs/VgNX+N3N2j8KXSUsrS/aP5+wa5K/cdk/mJioheSX2D9Br1pg66XXPyiPAH2jn9Y/ktIYNtyI1T8RFCLmZGXUP+vtmucMOdM/tPoBlaMH0j+w1NVI+NTQP90sKru0Sc8/b7R8WzL2zD83daAnCLfKP8WjktTUk8g/NHVQFzeUxj8ZHtekzb/EP4bTIzI3HsM/I8ozdBK3wT8hLFc475HAPyePNi+4Y78/GrBv0Ikkvj85RVpOsFu9P+jY9qKI/rw/X/VFyG8CvT/nJEi4wly9P8/x/WzeAr4/VuZn4B/qvj9hRkMG8gPAP7I3rfXDqMA/PAxyOzRewT8mCZJU8R7CP5RzDb6p5cI/ppDk9Autwz8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1206"},"selection_policy":{"id":"1207"}},"id":"1032","type":"ColumnDataSource"},{"attributes":{"data_source":{"id":"1027"},"glyph":{"id":"1028"},"hover_glyph":null,"muted_glyph":null,"name":"versicolor","nonselection_glyph":{"id":"1029"},"selection_glyph":null,"view":{"id":"1031"}},"id":"1030","type":"GlyphRenderer"},{"attributes":{},"id":"1218","type":"Selection"},{"attributes":{},"id":"1219","type":"UnionRenderers"},{"attributes":{},"id":"1005","type":"DataRange1d"},{"attributes":{"line_alpha":0.1,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1029","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"gjwlyFOCEkDPDoEby6ASQBzh3G5CvxJAabM4wrndEkC2hZQVMfwSQANY8GioGhNAUCpMvB85E0Cd/KcPl1cTQOrOA2MOdhNAN6FftoWUE0CEc7sJ/bITQNFFF1100RNAHhhzsOvvE0Br6s4DYw4UQLi8KlfaLBRABY+GqlFLFEBSYeL9yGkUQJ8zPlFAiBRA7AWapLemFEA52PX3LsUUQIaqUUum4xRA03ytnh0CFUAgTwnylCAVQG4hZUUMPxVAuvPAmINdFUAIxhzs+nsVQFSYeD9ymhVAomrUkum4FUDuPDDmYNcVQDwPjDnY9RVAieHnjE8UFkDWs0PgxjIWQCOGnzM+URZAcFj7hrVvFkC9KlfaLI4WQAr9si2krBZAV88OgRvLFkCkoWrUkukWQPFzxicKCBdAPkYie4EmF0CLGH7O+EQXQNjq2SFwYxdAJb01deeBF0Byj5HIXqAXQL9h7RvWvhdADDRJb03dF0BZBqXCxPsXQKbYABY8GhhA86pcabM4GEBAfbi8KlcYQI1PFBCidRhA2iFwYxmUGEAn9Mu2kLIYQHTGJwoI0RhAwZiDXX/vGEAOa9+w9g0ZQFs9OwRuLBlAqA+XV+VKGUD14fKqXGkZQEK0Tv7ThxlAj4aqUUumGUDcWAalwsQZQCkrYvg54xlAdv29S7EBGkDDzxmfKCAaQBCidfKfPhpAXXTRRRddGkCqRi2ZjnsaQPgYiewFmhpAROvkP324GkCSvUCT9NYaQN6PnOZr9RpALGL4OeMTG0B4NFSNWjIbQMYGsODRUBtAEtkLNElvG0Bgq2eHwI0bQKx9w9o3rBtA+k8fLq/KG0BGInuBJukbQJT01tSdBxxA4MYyKBUmHEAumY57jEQcQHpr6s4DYxxAyD1GInuBHEAUEKJ18p8cQGLi/chpvhxArrRZHOHcHED8hrVvWPscQEhZEcPPGR1AlittFkc4HUDj/chpvlYdQDDQJL01dR1AfaKAEK2THUDKdNxjJLIdQBdHOLeb0B1AZBmUChPvHUCx6+9dig0eQP69S7EBLB5AS5CnBHlKHkA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"zBnsS+9E0T8tDOrkmfLUP41Qw43/Jtg/5elSlGjo2j8023NGHT3dP3UnAfJlK98/1OhqcsVc4D9ibmY26vbgP+Kl4GtFZ+E/1BDHOfuw4T+4MAfHL9fhPwiHjjoH3eE/RJVKu6XF4T/r3ChwL5ThP3rfFoDIS+E/bx4CEpXv4D9IG9hMuYLgP4VXhldZCOA/Qqn0sTIH3z84KEPwOu/dP+gu07cTz9w/TsB/VgWt2z9m3yMaWI/aPyOPmlBUfNk/nNK+R0J62D9SjIIEjY7XP+ar/Bw8uNY/keW/JXrz1T9FSTs+bjzVP7/m3YU/j9Q/480WHBXo0z+DDlUgFkPTP3W4B7JpnNI/jdud8Dbw0T+hh4b7pDrRP4fMMPLad9A/KHQX6P9Hzz9KkD9/YXfNP6D+t7WQgMs/20ZiT9xryT9EzqWUpUHHPy766c1NCsU/3y+WQzbOwj+s1BE+wJXAP7ibiAua0rw/gQEqxnuiuD9LpdY86Ku0P7BRXQCi/7A/lqIZQ9dcqz/jZkW+M5ClP/t/fO81naA/dvEZS6fkmD+uhAOC6/qRPwo4l4kUsog/sWcgUlVrfz8zgzvJeXBxP+4wXfN1i1s/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOXafYvYsiP2JnDdpxBUE/gItk/woATT9Z5m4ylDpUP3TYk8Sbo1k/g2B49VKsXj/k4DlC+KJhPxGgbpjVsGM/qw8G3Vx4ZT+Q0atvKfJmP6CHC7DWFmg/udPQ/f/eaD+4V6e4QENpP321OkA0PGk/44429HXCaD8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1202"},"selection_policy":{"id":"1203"}},"id":"1022","type":"ColumnDataSource"},{"attributes":{"line_alpha":0.6,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1023","type":"Line"},{"attributes":{"source":{"id":"1032"}},"id":"1036","type":"CDSView"},{"attributes":{"text":"sepal length"},"id":"1003","type":"Title"},{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1048"}],"center":[{"id":"1051"},{"id":"1055"}],"left":[{"id":"1052"}],"plot_height":200,"plot_width":400,"renderers":[{"id":"1060"},{"id":"1065"},{"id":"1070"}],"title":{"id":"1038"},"toolbar":{"id":"1056"},"x_range":{"id":"1040"},"x_scale":{"id":"1044"},"y_range":{"id":"1042"},"y_scale":{"id":"1046"}},"id":"1037","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1040","type":"DataRange1d"},{"attributes":{},"id":"1007","type":"DataRange1d"},{"attributes":{"data_source":{"id":"1032"},"glyph":{"id":"1033"},"hover_glyph":null,"muted_glyph":null,"name":"virginica","nonselection_glyph":{"id":"1034"},"selection_glyph":null,"view":{"id":"1036"}},"id":"1035","type":"GlyphRenderer"},{"attributes":{"text":"sepal width"},"id":"1038","type":"Title"},{"attributes":{},"id":"1009","type":"LinearScale"},{"attributes":{"line_alpha":0.1,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1034","type":"Line"},{"attributes":{},"id":"1011","type":"LinearScale"},{"attributes":{"axis_label":"length (cm)","formatter":{"id":"1186"},"ticker":{"id":"1014"}},"id":"1013","type":"LinearAxis"},{"attributes":{},"id":"1042","type":"DataRange1d"},{"attributes":{"items":[{"id":"1153"},{"id":"1165"},{"id":"1177"}],"location":[10,60]},"id":"1178","type":"Legend"},{"attributes":{},"id":"1014","type":"BasicTicker"},{"attributes":{"axis":{"id":"1017"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1020","type":"Grid"},{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1013"}],"center":[{"id":"1016"},{"id":"1020"}],"left":[{"id":"1017"}],"plot_height":200,"plot_width":400,"renderers":[{"id":"1025"},{"id":"1030"},{"id":"1035"}],"title":{"id":"1003"},"toolbar":{"id":"1021"},"x_range":{"id":"1005"},"x_scale":{"id":"1009"},"y_range":{"id":"1007"},"y_scale":{"id":"1011"}},"id":"1002","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1044","type":"LinearScale"},{"attributes":{},"id":"1018","type":"BasicTicker"},{"attributes":{"axis_label":"Probability","formatter":{"id":"1188"},"ticker":{"id":"1018"}},"id":"1017","type":"LinearAxis"},{"attributes":{},"id":"1046","type":"LinearScale"},{"attributes":{"axis":{"id":"1048"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1051","type":"Grid"},{"attributes":{"axis_label":"width (cm)","formatter":{"id":"1190"},"ticker":{"id":"1049"}},"id":"1048","type":"LinearAxis"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto"},"id":"1021","type":"Toolbar"},{"attributes":{},"id":"1049","type":"BasicTicker"},{"attributes":{"line_alpha":0.6,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1138","type":"Line"},{"attributes":{"axis":{"id":"1087"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1090","type":"Grid"},{"attributes":{},"id":"1053","type":"BasicTicker"},{"attributes":{},"id":"1088","type":"BasicTicker"},{"attributes":{"axis":{"id":"1013"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1016","type":"Grid"},{"attributes":{"axis_label":"Probability","formatter":{"id":"1192"},"ticker":{"id":"1053"}},"id":"1052","type":"LinearAxis"},{"attributes":{"axis_label":"Probability","formatter":{"id":"1196"},"ticker":{"id":"1088"}},"id":"1087","type":"LinearAxis"},{"attributes":{},"id":"1112","type":"DataRange1d"},{"attributes":{"data":{"x":{"__ndarray__":"XXTRRRdd1D/ojE8UEKLVP3OlzeII59Y//r1LsQEs2D+I1sl/+nDZPxPvR07ztdo/ngfGHOz62z8oIETr5D/dP7Q4wrndhN4/PlFAiNbJ3z/kNF+rZ4fgPypBnhLkKeE/cE3deWDM4T+1WRzh3G7iP/plW0hZEeM/QHKar9Wz4z+FftkWUlbkP8qKGH7O+OQ/EJdX5Uqb5T9Vo5ZMxz3mP5qv1bND4OY/4LsUG8CC5z8myFOCPCXoP2vUkum4x+g/sODRUDVq6T/27BC4sQzqPzz5Tx8ur+o/gAWPhqpR6z/GEc7tJvTrPwweDVWjluw/UCpMvB857T+WNosjnNvtP9xCyooYfu4/IE8J8pQg7z9mW0hZEcPvP9azQ+DGMvA/+TnjEwWE8D8bwIJHQ9XwPz5GInuBJvE/YczBrr938T+DUmHi/cjxP6bYABY8GvI/yV6gSXpr8j/r5D99uLzyPw5r37D2DfM/MfF+5DRf8z9Udx4Yc7DzP3b9vUuxAfQ/mYNdf+9S9D+8Cf2yLaT0P96PnOZr9fQ/ARY8GqpG9T8knNtN6Jf1P0Yie4Em6fU/aagatWQ69j+MLrrooov2P660WRzh3PY/0Tr5Tx8u9z/0wJiDXX/3PxZHOLeb0Pc/Oc3X6tkh+D9cU3ceGHP4P3/ZFlJWxPg/oV+2hZQV+T/E5VW50mb5P+dr9ewQuPk/CfKUIE8J+j8seDRUjVr6P0/+04fLq/o/coRzuwn9+j+UChPvR077P7eQsiKGn/s/2hZSVsTw+z/8nPGJAkL8Px8jkb1Ak/w/Qqkw8X7k/D9kL9AkvTX9P4e1b1j7hv0/qjsPjDnY/T/Nwa6/dyn+P+9HTvO1ev4/Es7tJvTL/j81VI1aMh3/P1faLI5wbv8/emDMwa6//z9P87V6dggAQGC2hZQVMQBAcXlVrrRZAECDPCXIU4IAQJT/9OHyqgBApcLE+5HTAEC3hZQVMfwAQMhIZC/QJAFA2Qs0SW9NAUDrzgNjDnYBQPyR03ytngFADlWjlkzHAUAfGHOw6+8BQDDbQsqKGAJAQZ4S5ClBAkA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlknOxqHxFD9OqJ2nfUUlP9+rFyI8CTA/ga7Erl5INT/dcAzMpDg6P86HJcyMsj4/K0SjgEpHQT+eA9PendJCP7hMval/50M/6ml9Ci9yRD+kpS4q615EP1xK7DHzmUM/eKLRSoYPQj/m8PM7x1c/P5ItAamUtjg/sI8BL/MTMD+EsK6AhCEVPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxNyQZSgwBP7csw6HgoGU/BISC9K9neD80xCIJoJOEP7PiQs+YUI4/aZ02R4l4lD+ous0V0/yZP3id40V2d58/OI36pF9Voj/1gj9KfaykPyYa/0s6oqY/GL1347wXqD/y1edJK+6oP/TOjbirBqk/VRKoaGRCqD+jtFDK/ISmPwcYXju466M/WexiB3bNoD9DF5thLQebPxigGHT1zpQ/AU82lgpKjz8qw/7WO3iIP1sFRLQAjoY/En6/N9vwij/GSpW1JoOTP1daH6zsGZ4/81AtQsD3pj9SNBFKWOywP2t2T+so0Lc/CtfptjTdvz92SSZMd2LEP5rzcb1kHMk/UAgOJRz1zT8EU1h8q2LRP5H1B1fnstM/FvtwXZ7X1T/Fcm5KLb3XP9Br29jwT9k/d/WSw0V82j82NJLTry7bP2XWGYmAX9s/U+EPaQsb2z/jhKwdlG/aP/3wJ1Fea9k/iFW6ra0c2D9b4pvdxZHWP3nHBIvq2NQ/tDQtYF8A0z/rWU0HaBbRPznOOlWQUs4/IBir6IaOyj+U8VsdO/3GP0a6vUc0u8M//tFAvPnkwD8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1151"},"selection_policy":{"id":"1152"}},"id":"1137","type":"ColumnDataSource"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto"},"id":"1091","type":"Toolbar"},{"attributes":{},"id":"1114","type":"LinearScale"},{"attributes":{"text":"petal width"},"id":"1108","type":"Title"},{"attributes":{},"id":"1116","type":"LinearScale"},{"attributes":{"axis_label":"width (cm)","formatter":{"id":"1143"},"ticker":{"id":"1119"}},"id":"1118","type":"LinearAxis"},{"attributes":{"axis":{"id":"1122"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1125","type":"Grid"},{"attributes":{"data":{"x":{"__ndarray__":"v2HtG9a+AUDQJL01decBQOLnjE8UEAJA86pcabM4AkAEbiyDUmECQBYx/JzxiQJAJ/TLtpCyAkA5t5vQL9sCQEp6a+rOAwNAWz07BG4sA0BtAAseDVUDQH7D2jesfQNAj4aqUUumA0ChSXpr6s4DQLIMSoWJ9wNAxM8ZnyggBEDVkum4x0gEQOZVudJmcQRA+BiJ7AWaBEAJ3FgGpcIEQBqfKCBE6wRALGL4OeMTBUA9JchTgjwFQE7ol20hZQVAYKtnh8CNBUBxbjehX7YFQIIxB7v+3gVAlPTW1J0HBkClt6buPDAGQLd6dgjcWAZAyD1GInuBBkDaABY8GqoGQOvD5VW50gZA/Ia1b1j7BkAOSoWJ9yMHQB8NVaOWTAdAMNAkvTV1B0BCk/TW1J0HQFNWxPBzxgdAZBmUChPvB0B23GMkshcIQIefMz5RQAhAmGIDWPBoCECqJdNxj5EIQLvooosuughAzKtypc3iCEDebkK/bAsJQO8xEtkLNAlAAPXh8qpcCUASuLEMSoUJQCN7gSbprQlAND5RQIjWCUBGASFaJ/8JQFjE8HPGJwpAaYfAjWVQCkB6SpCnBHkKQIwNYMGjoQpAndAv20LKCkCuk//04fIKQMBWzw6BGwtA0RmfKCBEC0Di3G5Cv2wLQPSfPlxelQtABWMOdv29C0AWJt6PnOYLQCjprak7DwxAOax9w9o3DEBKb03deWAMQFwyHfcYiQxAbvXsELixDEB+uLwqV9oMQJB7jET2Ag1Aoj5cXpUrDUCzASx4NFQNQMTE+5HTfA1A1ofLq3KlDUDnSpvFEc4NQPgNa9+w9g1ACtE6+U8fDkAblAoT70cOQCxX2iyOcA5APhqqRi2ZDkBP3XlgzMEOQGCgSXpr6g5AcmMZlAoTD0CDJumtqTsPQJTpuMdIZA9ApqyI4eeMD0C4b1j7hrUPQMgyKBUm3g9A7fp7l2IDEEB23GMkshcQQP69S7EBLBBAh58zPlFAEEAQgRvLoFQQQJhiA1jwaBBAIUTr5D99EECqJdNxj5EQQDIHu/7epRBAu+iiiy66EEA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"AAAAAAAAAAA1fRCWuRR7P+bx7gh2dIs/hHo/X8hskz+QTRFrSvGXP4wbIh01XJs/rA2navzBnT9yTdVIFDefPyME4qzwz58/MlsCjAWhnz/7e2vbxr6eP+iPUpCoPZ0/TsDsnx4ymz+MNm//nLCYPxUcD6SXzZU/KJoBg4Kdkj+jtPcio2mOP74LZonxT4c/H4y4I9gWgD/1EbO4fc5xP5hNNdvZoE4/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiMTVvqLbSj9T2PwZsXJ8P/sjA7P1XI0/jOsyxLyglz8Np3Q8JQKhP4A5RDhf4qY/iN61Td1brT/ezOwNpiyyPwu33yCs4rU/oK87L1fFuT9UuIiI/cm9P1hpJ7768sA/PAALrUoHwz++IbO4mRzFP5bO4wiTLcc/sgdhxeE0yT/xze4VMS3LPxAiUSIsEc0/9wRMEn7bzj/Du9EGaUPQP0a9DZ7pBtE/bQe8Ypa10T+mmr7oxEzSP2J398PKydI/CJ5IiP0p0z8DD5TJsmrTP8TKuxtAidM/stGhEvuC0z/kK9HyZlXTP0qRBOAhAtM/wmkm3eSO0j/LJMqdlgHSP90xg9UdYNE/hQDlN2Gw0D9yAAbxjvDPP/BA4ZVue84/iaGCxS4NzT9KARHnnLHLPxI/s2GGdMo/9DmQnLhhyT9qO2Nfx4TIPzs4cVyG4Mc/USZGU2tsxz/64mKJKR/HP4JLSER078Y/LD13yf7Txj9ElXBefMPGPxcxtUigtMY/5u3FzR2exj8GqSMzqHbGP7c/T77yNMY/RY/JtLDPxT8VxiNapj3FPz/z+ae6esQ/f9a1HomLwz/j6awchXXCP4WnNAAiPsE/oRJFT6bVvz+5EpjiFwK9P5FDDXd/DLo/85hPycP/tj8SBwqWy+azPzCC55l9zLA/HPwlI4F3qz8UgIhn/n6lP1TzQCe9l58/2zrpen4SlT8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1208"},"selection_policy":{"id":"1209"}},"id":"1057","type":"ColumnDataSource"},{"attributes":{},"id":"1119","type":"BasicTicker"},{"attributes":{"line_alpha":0.6,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1133","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"v2HtG9a+AUDQJL01decBQOLnjE8UEAJA86pcabM4AkAEbiyDUmECQBYx/JzxiQJAJ/TLtpCyAkA5t5vQL9sCQEp6a+rOAwNAWz07BG4sA0BtAAseDVUDQH7D2jesfQNAj4aqUUumA0ChSXpr6s4DQLIMSoWJ9wNAxM8ZnyggBEDVkum4x0gEQOZVudJmcQRA+BiJ7AWaBEAJ3FgGpcIEQBqfKCBE6wRALGL4OeMTBUA9JchTgjwFQE7ol20hZQVAYKtnh8CNBUBxbjehX7YFQIIxB7v+3gVAlPTW1J0HBkClt6buPDAGQLd6dgjcWAZAyD1GInuBBkDaABY8GqoGQOvD5VW50gZA/Ia1b1j7BkAOSoWJ9yMHQB8NVaOWTAdAMNAkvTV1B0BCk/TW1J0HQFNWxPBzxgdAZBmUChPvB0B23GMkshcIQIefMz5RQAhAmGIDWPBoCECqJdNxj5EIQLvooosuughAzKtypc3iCEDebkK/bAsJQO8xEtkLNAlAAPXh8qpcCUASuLEMSoUJQCN7gSbprQlAND5RQIjWCUBGASFaJ/8JQFjE8HPGJwpAaYfAjWVQCkB6SpCnBHkKQIwNYMGjoQpAndAv20LKCkCuk//04fIKQMBWzw6BGwtA0RmfKCBEC0Di3G5Cv2wLQPSfPlxelQtABWMOdv29C0AWJt6PnOYLQCjprak7DwxAOax9w9o3DEBKb03deWAMQFwyHfcYiQxAbvXsELixDEB+uLwqV9oMQJB7jET2Ag1Aoj5cXpUrDUCzASx4NFQNQMTE+5HTfA1A1ofLq3KlDUDnSpvFEc4NQPgNa9+w9g1ACtE6+U8fDkAblAoT70cOQCxX2iyOcA5APhqqRi2ZDkBP3XlgzMEOQGCgSXpr6g5AcmMZlAoTD0CDJumtqTsPQJTpuMdIZA9ApqyI4eeMD0C4b1j7hrUPQMgyKBUm3g9A7fp7l2IDEEB23GMkshcQQP69S7EBLBBAh58zPlFAEEAQgRvLoFQQQJhiA1jwaBBAIUTr5D99EECqJdNxj5EQQDIHu/7epRBAu+iiiy66EEA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"GQrJmXyKrD96enHADnWuP0x9kGLVVbA/0p9ph4GUsT98/0EC5fOyP/92lwZZcbQ/7+DnxzYKtj8FGLF517u3P9P2cE+Ug7k/C1ilfMZeuz9kFsw0x0q9P2sMY6vvRL8/agr0iUylwD8phexQjqzBP7rjWcTptsI/fhP7fQvDwz+6AY8XoM/EP8yb1CpU28U/C8+KUdTkxj+9iHAlzerHPz62REDr68g/6kTGO9vmyT8DIrSxSdrKP+k6zTvjxMs/8XzQc1SlzD9m1XzzSXrNP50xkVRwQs4/8n7MMHT8zj+yqu0hAqfPPxvR2WBjINA/ZKnuVDdk0D/j1BQ6U57QPz/KK10NztA/IgATC7zy0D847amQtQvRPycI0DpQGNE/ncdkVuIX0T/M9T/i1QnRP/AOlTBg7tA/27UZhy7G0D8+VWe475HQP9BXF5dSUtA/RyjD9QUI0D+bYghOcWfPP0S75/oyrM4/5S9Xl67fzT/jlYnIQQPNP6rCsTNKGMw/pYsCfiUgyz8txq5MMRzKP7tH6UTLDck/ruXkC1H2xz9oddRGINfGP1PM6pqWscU/5b9arRGHxD93JVcj71jDP2vSEqKMKMI/OpzAzkf3wD+CsCad/Iy/P7+3e40bL70/G/nluKfXuj+prubpWIm4P9fyeG2WRrY/sMARE3cRtD9XokEqDuyxP/NDMgXesK8/2pNR11mxqz+vSAJqtt2nP9F2ZVwaOqQ/yTKcTazKoD9VIo+5JSebPzBMEVLpMZU/qxgCRuF7jz/F0pUpxqaFP2aFKdyk0nk/oVKzVaflZD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH2UdKqg5EE/irDghfYcYD/5ckQE4/1qPzmEa6WranI/LodTf16udj8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1210"},"selection_policy":{"id":"1211"}},"id":"1062","type":"ColumnDataSource"},{"attributes":{"axis":{"id":"1118"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1121","type":"Grid"},{"attributes":{"line_alpha":0.6,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1068","type":"Line"},{"attributes":{"source":{"id":"1132"}},"id":"1136","type":"CDSView"},{"attributes":{"line_alpha":0.6,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1058","type":"Line"},{"attributes":{},"id":"1143","type":"BasicTickFormatter"},{"attributes":{},"id":"1123","type":"BasicTicker"},{"attributes":{"axis_label":"Probability","formatter":{"id":"1145"},"ticker":{"id":"1123"}},"id":"1122","type":"LinearAxis"},{"attributes":{"line_alpha":0.6,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1063","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"XXTRRRdd1D/ojE8UEKLVP3OlzeII59Y//r1LsQEs2D+I1sl/+nDZPxPvR07ztdo/ngfGHOz62z8oIETr5D/dP7Q4wrndhN4/PlFAiNbJ3z/kNF+rZ4fgPypBnhLkKeE/cE3deWDM4T+1WRzh3G7iP/plW0hZEeM/QHKar9Wz4z+FftkWUlbkP8qKGH7O+OQ/EJdX5Uqb5T9Vo5ZMxz3mP5qv1bND4OY/4LsUG8CC5z8myFOCPCXoP2vUkum4x+g/sODRUDVq6T/27BC4sQzqPzz5Tx8ur+o/gAWPhqpR6z/GEc7tJvTrPwweDVWjluw/UCpMvB857T+WNosjnNvtP9xCyooYfu4/IE8J8pQg7z9mW0hZEcPvP9azQ+DGMvA/+TnjEwWE8D8bwIJHQ9XwPz5GInuBJvE/YczBrr938T+DUmHi/cjxP6bYABY8GvI/yV6gSXpr8j/r5D99uLzyPw5r37D2DfM/MfF+5DRf8z9Udx4Yc7DzP3b9vUuxAfQ/mYNdf+9S9D+8Cf2yLaT0P96PnOZr9fQ/ARY8GqpG9T8knNtN6Jf1P0Yie4Em6fU/aagatWQ69j+MLrrooov2P660WRzh3PY/0Tr5Tx8u9z/0wJiDXX/3PxZHOLeb0Pc/Oc3X6tkh+D9cU3ceGHP4P3/ZFlJWxPg/oV+2hZQV+T/E5VW50mb5P+dr9ewQuPk/CfKUIE8J+j8seDRUjVr6P0/+04fLq/o/coRzuwn9+j+UChPvR077P7eQsiKGn/s/2hZSVsTw+z/8nPGJAkL8Px8jkb1Ak/w/Qqkw8X7k/D9kL9AkvTX9P4e1b1j7hv0/qjsPjDnY/T/Nwa6/dyn+P+9HTvO1ev4/Es7tJvTL/j81VI1aMh3/P1faLI5wbv8/emDMwa6//z9P87V6dggAQGC2hZQVMQBAcXlVrrRZAECDPCXIU4IAQJT/9OHyqgBApcLE+5HTAEC3hZQVMfwAQMhIZC/QJAFA2Qs0SW9NAUDrzgNjDnYBQPyR03ytngFADlWjlkzHAUAfGHOw6+8BQDDbQsqKGAJAQZ4S5ClBAkA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"6fN6HTfAMT9Ahu/Q92x7PxtKxoSWVIc/B0xmhb+8jT8oVPNwsqGQPzwf60h6HpE/8/ZhRu5+kD8Tlj7KitqNP2gW1UFtJ4k/bU4W6/E4gz8bOyJ7Dcd4P5aMUcNm7mM/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZdfAxWK/aj8EKcQ5MMuJP1Nk+yi2JZg/MtUdbQdToj8cxC2LGvqoP3TPieHdzq8/3COHcQ1Msz/cvkuBTY62P//ggNmTkbk/ibKUM0U5vD/aW/VIxmi+P5uCiOm9AcA/eOuqRWV2wD8QqU20k4bAP0w2uqGmQMA/rxYPjM2Evz8XMum7n1O+P3yggEy7Kb0/hUNTtxdDvD/t/N51rNu7P12uoQFxL7w/gzkZ1Fx6vT8RgMNmZ/i/P9MxjxnE8sE/B+NTWdu+xD96y8umWHvIP7ov2LSMFM0/1ZlvqXgp0T9Q8NsmCv/TP/2fHLnB7tY/oy2dRmbc2T/tHcm1vqvcP4b1C+2RQN8/n5xoaVO/4D/XNsIm4qThP82LyKHYQuI/212xTRqL4j8Kq0r5IHDiPyjOD67o8eE/zn4psO8d4T87sFifSgLgP2arvDYcWt0/CcX2h51Y2j/Lk+FxQhzXP0L+/jM0wdM/9OrQDZxj0D/vgLJ9Rj/KP3nKMw3mIsQ/X/9SktJUvT9gpsjJjBq0P8dCiVP+hak/fUlm9hCNnD/eQQmNPFWIP4xuRI0sHVI/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANqE2gx/p3I/md03GGiLgz+MyZhqQ0uMPzxLkp5nVZE/tiyOBz5kkz8I9h1rGW6UPwOUH0TujpQ/fPNwDbHikz9GAfBBVoWSP0eqelzSkpA/mbbdrzNOjD82AlVeQryGP1gRF7q5p4A/s3q/cQWRdD8LAleDMrRePwAAAAAAAAAAAAAAAAAAAAA=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1149"},"selection_policy":{"id":"1150"}},"id":"1132","type":"ColumnDataSource"},{"attributes":{},"id":"1084","type":"BasicTicker"},{"attributes":{"label":{"value":"setosa"},"renderers":[{"id":"1130"}]},"id":"1153","type":"LegendItem"},{"attributes":{"text":"petal length"},"id":"1073","type":"Title"},{"attributes":{"source":{"id":"1057"}},"id":"1061","type":"CDSView"},{"attributes":{"line_alpha":0.1,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1134","type":"Line"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto"},"id":"1126","type":"Toolbar"},{"attributes":{"data_source":{"id":"1132"},"glyph":{"id":"1133"},"hover_glyph":null,"muted_glyph":null,"name":"versicolor","nonselection_glyph":{"id":"1134"},"selection_glyph":null,"view":{"id":"1136"}},"id":"1135","type":"GlyphRenderer"},{"attributes":{},"id":"1149","type":"Selection"},{"attributes":{"data_source":{"id":"1057"},"glyph":{"id":"1058"},"hover_glyph":null,"muted_glyph":null,"name":"setosa","nonselection_glyph":{"id":"1059"},"selection_glyph":null,"view":{"id":"1061"}},"id":"1060","type":"GlyphRenderer"},{"attributes":{"children":[{"id":"1072"},{"id":"1107"}]},"id":"1180","type":"Row"},{"attributes":{},"id":"1188","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.1,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1059","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"lSBPCfKU+D8A9eHyqlz5P2rJdNxjJPo/1Z0Hxhzs+j9Acpqv1bP7P6pGLZmOe/w/FRvAgkdD/T+A71JsAAv+P+rD5VW50v4/VZh4P3Ka/z9gtoWUFTEAQJUgTwnylABAyooYfs74AEAA9eHyqlwBQDVfq2eHwAFAasl03GMkAkCgMz5RQIgCQNWdB8Yc7AJACgjROvlPA0BAcpqv1bMDQHXcYySyFwRAqkYtmY57BEDgsPYNa98EQBUbwIJHQwVASoWJ9yOnBUCA71JsAAsGQLVZHOHcbgZA6sPlVbnSBkAgLq/KlTYHQFWYeD9ymgdAigJCtE7+B0DAbAspK2IIQPXW1J0HxghAKkGeEuQpCUBgq2eHwI0JQJUVMfyc8QlAyn/6cHlVCkAA6sPlVbkKQDVUjVoyHQtAar5Wzw6BC0CgKCBE6+QLQNWS6bjHSAxACv2yLaSsDEBAZ3yigBANQHTRRRdddA1AqjsPjDnYDUDgpdgAFjwOQBQQonXynw5ASnpr6s4DD0CA5DRfq2cPQLRO/tOHyw9AddxjJLIXEECQkcheoEkQQKpGLZmOexBAxfuR03ytEEDgsPYNa98QQPplW0hZERFAFRvAgkdDEUAw0CS9NXURQEqFifcjpxFAZTruMRLZEUCA71JsAAsSQJqkt6buPBJAtVkc4dxuEkDQDoEby6ASQOrD5VW50hJABXlKkKcEE0AgLq/KlTYTQDrjEwWEaBNAVZh4P3KaE0BwTd15YMwTQIoCQrRO/hNApbem7jwwFEDAbAspK2IUQNohcGMZlBRA9dbUnQfGFEAQjDnY9fcUQCpBnhLkKRVARfYCTdJbFUBgq2eHwI0VQHpgzMGuvxVAlRUx/JzxFUCwypU2iyMWQMp/+nB5VRZA5TRfq2eHFkD/6cPlVbkWQBqfKCBE6xZANVSNWjIdF0BPCfKUIE8XQGq+Vs8OgRdAhXO7Cf2yF0CfKCBE6+QXQLrdhH7ZFhhA1ZLpuMdIGEDvR07ztXoYQAr9si2krBhAJbIXaJLeGEA/Z3yigBAZQFoc4dxuQhlAddFFF110GUA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"QehZPJb2/D+PkZ4UX+36P1VbNohl+fg/9gnaimUa9z/bYUIQG1D1P3knKAxCmvM/MR9Ecpb48T9xDU821GrwP1BtA5hu4e0/dL4pTvcT6z8sl4J2umzoP0yAf/gv6+U/qgKSu8+O4z8VpyunEVfhP9/se0Xbht4/DfN0K7em2j9ZciXPpgzXP4F8cP+Zt9M/JyM5i4Cm0D/b78SClLDLPyAZn+HNl8Y/Y+XG0IwAwj/i7wTcYdG7P2noL64znLQ/5PU1p5y6rD+/bVelUR6iP3El1iMCi5I/DQa6PzpNcD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAT21m7D0rsT4+B9PHJM5YP++wn7oBDGg/OtIpKY9scT+adryISVt2PxaNQW9Fxno/gd3yT5ihfj/fIKjc3/CAPy+dktZJQoI/WHdEUKNIgz8eTOyRuQeEP0e4uONZg4Q/oFjYjVG/hD/2yXnYbb+EPxGpywt8h4Q/vJL8b0kbhD+7IztNo36DP+T4tetWtYI/966bkzHDgT+84hqNAKyAPxtixEAi534/RG1AK2E7fD+YIAdqWFx5P8C1dY2iUXY/J2bpJdoicz/01n6HM69vP7n+qe737mg/c7YOojYUYj/k4s6ESVxWP0GMusHdL0E/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1214"},"selection_policy":{"id":"1215"}},"id":"1092","type":"ColumnDataSource"},{"attributes":{"data":{"x":{"__ndarray__":"lSBPCfKU+D8A9eHyqlz5P2rJdNxjJPo/1Z0Hxhzs+j9Acpqv1bP7P6pGLZmOe/w/FRvAgkdD/T+A71JsAAv+P+rD5VW50v4/VZh4P3Ka/z9gtoWUFTEAQJUgTwnylABAyooYfs74AEAA9eHyqlwBQDVfq2eHwAFAasl03GMkAkCgMz5RQIgCQNWdB8Yc7AJACgjROvlPA0BAcpqv1bMDQHXcYySyFwRAqkYtmY57BEDgsPYNa98EQBUbwIJHQwVASoWJ9yOnBUCA71JsAAsGQLVZHOHcbgZA6sPlVbnSBkAgLq/KlTYHQFWYeD9ymgdAigJCtE7+B0DAbAspK2IIQPXW1J0HxghAKkGeEuQpCUBgq2eHwI0JQJUVMfyc8QlAyn/6cHlVCkAA6sPlVbkKQDVUjVoyHQtAar5Wzw6BC0CgKCBE6+QLQNWS6bjHSAxACv2yLaSsDEBAZ3yigBANQHTRRRdddA1AqjsPjDnYDUDgpdgAFjwOQBQQonXynw5ASnpr6s4DD0CA5DRfq2cPQLRO/tOHyw9AddxjJLIXEECQkcheoEkQQKpGLZmOexBAxfuR03ytEEDgsPYNa98QQPplW0hZERFAFRvAgkdDEUAw0CS9NXURQEqFifcjpxFAZTruMRLZEUCA71JsAAsSQJqkt6buPBJAtVkc4dxuEkDQDoEby6ASQOrD5VW50hJABXlKkKcEE0AgLq/KlTYTQDrjEwWEaBNAVZh4P3KaE0BwTd15YMwTQIoCQrRO/hNApbem7jwwFEDAbAspK2IUQNohcGMZlBRA9dbUnQfGFEAQjDnY9fcUQCpBnhLkKRVARfYCTdJbFUBgq2eHwI0VQHpgzMGuvxVAlRUx/JzxFUCwypU2iyMWQMp/+nB5VRZA5TRfq2eHFkD/6cPlVbkWQBqfKCBE6xZANVSNWjIdF0BPCfKUIE8XQGq+Vs8OgRdAhXO7Cf2yF0CfKCBE6+QXQLrdhH7ZFhhA1ZLpuMdIGEDvR07ztXoYQAr9si2krBhAJbIXaJLeGEA/Z3yigBAZQFoc4dxuQhlAddFFF110GUA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"7I2YTSQDZz8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2WLrbbJxrPx5ndwOmLX0/WXP6f3/1hj/O/LPAHQCQPyi14OoQ2pQ/1/RhpiYHmj/0TRZb7IWfPz0pbrh3qqI/PkrJp165pT8W04uv8e6oP7gMpYN3Sqw/NkAE2DbLrz9NW0wwO7ixP3LcqGi+nLM/EEgPb8iStT+wQned/Jm3P81w2E3+sbk/73Yq2nDauz9wobYHchW+P8pR3Y1aP8A/JIn4moKgwT+5gVKzr0PDP2XGEF9gPsU/GuJYJhOmxz/DX1CRRpDKPzPKHCh5Es4/PNZxuRQh0T+0SOX8aprTP+eBe6L+f9Y/aUdH7o7c2T/DbcHjWbndP9KAEIGMBOE/7ImoH5hW4z9jB5G1SMPlP2kusioXO+g/VDT0Znyu6j9UTj9S8Q3tP5qxe9TuSe8/wcnI6nap8D+ZlLSes4zxP/RT9fnpRvI/dyJ/cFbQ8j8vAuzoeCHzP3vAvZbgOPM/A/Zd+isb8z/mItwGPc3yP0HHR6/1U/I/MWOw5je08T/PdiWg5fLwPz+Cts7gFPA/KAvmyhY+7j/dAdWujizsP+foWC/t/uk/ZMCQMva+5z8jjuoPYXblP15PtPP8LOM/8JhS5B7o4D8mZSkN41ndP/fHk/4+Adk/e+mC5qbQ1D8kWZUOcNLQP6pM04DfIco/hMA8i/Yswz9KWUifn7W5P1O/GoVXAK0/PUQLm5qLkz8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADbcqBREMBdP2LFhWek6pA/ksUJENU6nz8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1216"},"selection_policy":{"id":"1217"}},"id":"1097","type":"ColumnDataSource"},{"attributes":{"source":{"id":"1062"}},"id":"1066","type":"CDSView"},{"attributes":{"line_alpha":0.6,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1103","type":"Line"},{"attributes":{},"id":"1186","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.6,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1093","type":"Line"},{"attributes":{"line_alpha":0.6,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1098","type":"Line"},{"attributes":{},"id":"1110","type":"DataRange1d"},{"attributes":{"data":{"x":{"__ndarray__":"v2HtG9a+AUDQJL01decBQOLnjE8UEAJA86pcabM4AkAEbiyDUmECQBYx/JzxiQJAJ/TLtpCyAkA5t5vQL9sCQEp6a+rOAwNAWz07BG4sA0BtAAseDVUDQH7D2jesfQNAj4aqUUumA0ChSXpr6s4DQLIMSoWJ9wNAxM8ZnyggBEDVkum4x0gEQOZVudJmcQRA+BiJ7AWaBEAJ3FgGpcIEQBqfKCBE6wRALGL4OeMTBUA9JchTgjwFQE7ol20hZQVAYKtnh8CNBUBxbjehX7YFQIIxB7v+3gVAlPTW1J0HBkClt6buPDAGQLd6dgjcWAZAyD1GInuBBkDaABY8GqoGQOvD5VW50gZA/Ia1b1j7BkAOSoWJ9yMHQB8NVaOWTAdAMNAkvTV1B0BCk/TW1J0HQFNWxPBzxgdAZBmUChPvB0B23GMkshcIQIefMz5RQAhAmGIDWPBoCECqJdNxj5EIQLvooosuughAzKtypc3iCEDebkK/bAsJQO8xEtkLNAlAAPXh8qpcCUASuLEMSoUJQCN7gSbprQlAND5RQIjWCUBGASFaJ/8JQFjE8HPGJwpAaYfAjWVQCkB6SpCnBHkKQIwNYMGjoQpAndAv20LKCkCuk//04fIKQMBWzw6BGwtA0RmfKCBEC0Di3G5Cv2wLQPSfPlxelQtABWMOdv29C0AWJt6PnOYLQCjprak7DwxAOax9w9o3DEBKb03deWAMQFwyHfcYiQxAbvXsELixDEB+uLwqV9oMQJB7jET2Ag1Aoj5cXpUrDUCzASx4NFQNQMTE+5HTfA1A1ofLq3KlDUDnSpvFEc4NQPgNa9+w9g1ACtE6+U8fDkAblAoT70cOQCxX2iyOcA5APhqqRi2ZDkBP3XlgzMEOQGCgSXpr6g5AcmMZlAoTD0CDJumtqTsPQJTpuMdIZA9ApqyI4eeMD0C4b1j7hrUPQMgyKBUm3g9A7fp7l2IDEEB23GMkshcQQP69S7EBLBBAh58zPlFAEEAQgRvLoFQQQJhiA1jwaBBAIUTr5D99EECqJdNxj5EQQDIHu/7epRBAu+iiiy66EEA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"UFY6V98Ukz8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuFrwSbDRcz8hbWoezteTP1jEKTVm5aE/bhyNcgJAqj/nUmhfhWqxP/3jsgjnvrU/RPXesM0Juj8sOqXT4De+P0UzX/bjGsE/C5fxOxX4wj8oImb416nEP4Qumel/JsY/9RVnzWBkxz8ys7x/j1vIP8XZuB4YEck/QAgRfNaPyT8x//JtreLJPyd/jMp/FMo/uUgLaDAwyj91HJ0cokDKP++6b763UMo/uOSwI1Rryj9fWo4iWpvKP3ncNZGs68o/lSvVRS5nyz+hFp9IghfMPzEWmxdm+cw/XBebdfsBzj/Vpd34SibPP52m0JuuLdA/oUwSZB3L0D/QClMg9mXRP/omshu9+NE/+OZOofZ90j+kkEj8JvDSP89pvnfSSdM/VbjPXn2F0z+W0lI/853TPwAQMOwpktM/3QFdCUxk0z978g5YmRbTPzQse5lRq9I/W/nWjrQk0j9BpFf5AYXRPzh3Mpp5ztA/m7ycMlsD0D9vfZcHzUvOP76P6Z22cMw/3kSaqvJ5yj8vftq5EWzIP8gCrDgsTcY/mn/hdOIkxD897hPG5frBP3iQuAfPrb8/qQ6nCzKBuz8rSiVHV3+3Pyg2ZWmht7M/9sWYIXM5sD/y2eM9XiiqPz48RSFwrqQ/pZm5S+EjoD/LH0e6jE2ZP0OdBw+6dJQ/zFK00Ap+kT9QPGQ0liWQP39VLm9zJ5A/J5optrk/kT8HBm0+gCqTP+OUDz3eo5U/mUIo5+pnmD/JCs5xvTKbP0zpFxJtwJ0/9Nkc/RDNnz+p4BMElYqgP/8wgquSuqA/erIBV8Z/oD9T0i6oJ8yfP2SykOC98p0/Ew0z8haLmz+k6h94+qyYP2BTYQ0wcJU/Ik8BTX/skT9kzBOkX3OMP9ZBCm8S34Q/OBz0YUyXej+oB91/qKJnPwAAAAAAAAAAAAAAAAAAAAA=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1212"},"selection_policy":{"id":"1213"}},"id":"1067","type":"ColumnDataSource"},{"attributes":{"data_source":{"id":"1062"},"glyph":{"id":"1063"},"hover_glyph":null,"muted_glyph":null,"name":"versicolor","nonselection_glyph":{"id":"1064"},"selection_glyph":null,"view":{"id":"1066"}},"id":"1065","type":"GlyphRenderer"},{"attributes":{"source":{"id":"1092"}},"id":"1096","type":"CDSView"},{"attributes":{"line_alpha":0.1,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1064","type":"Line"},{"attributes":{"label":{"value":"virginica"},"renderers":[{"id":"1140"}]},"id":"1177","type":"LegendItem"},{"attributes":{"data_source":{"id":"1092"},"glyph":{"id":"1093"},"hover_glyph":null,"muted_glyph":null,"name":"setosa","nonselection_glyph":{"id":"1094"},"selection_glyph":null,"view":{"id":"1096"}},"id":"1095","type":"GlyphRenderer"},{"attributes":{"source":{"id":"1067"}},"id":"1071","type":"CDSView"},{"attributes":{"line_alpha":0.1,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1094","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"XXTRRRdd1D/ojE8UEKLVP3OlzeII59Y//r1LsQEs2D+I1sl/+nDZPxPvR07ztdo/ngfGHOz62z8oIETr5D/dP7Q4wrndhN4/PlFAiNbJ3z/kNF+rZ4fgPypBnhLkKeE/cE3deWDM4T+1WRzh3G7iP/plW0hZEeM/QHKar9Wz4z+FftkWUlbkP8qKGH7O+OQ/EJdX5Uqb5T9Vo5ZMxz3mP5qv1bND4OY/4LsUG8CC5z8myFOCPCXoP2vUkum4x+g/sODRUDVq6T/27BC4sQzqPzz5Tx8ur+o/gAWPhqpR6z/GEc7tJvTrPwweDVWjluw/UCpMvB857T+WNosjnNvtP9xCyooYfu4/IE8J8pQg7z9mW0hZEcPvP9azQ+DGMvA/+TnjEwWE8D8bwIJHQ9XwPz5GInuBJvE/YczBrr938T+DUmHi/cjxP6bYABY8GvI/yV6gSXpr8j/r5D99uLzyPw5r37D2DfM/MfF+5DRf8z9Udx4Yc7DzP3b9vUuxAfQ/mYNdf+9S9D+8Cf2yLaT0P96PnOZr9fQ/ARY8GqpG9T8knNtN6Jf1P0Yie4Em6fU/aagatWQ69j+MLrrooov2P660WRzh3PY/0Tr5Tx8u9z/0wJiDXX/3PxZHOLeb0Pc/Oc3X6tkh+D9cU3ceGHP4P3/ZFlJWxPg/oV+2hZQV+T/E5VW50mb5P+dr9ewQuPk/CfKUIE8J+j8seDRUjVr6P0/+04fLq/o/coRzuwn9+j+UChPvR077P7eQsiKGn/s/2hZSVsTw+z/8nPGJAkL8Px8jkb1Ak/w/Qqkw8X7k/D9kL9AkvTX9P4e1b1j7hv0/qjsPjDnY/T/Nwa6/dyn+P+9HTvO1ev4/Es7tJvTL/j81VI1aMh3/P1faLI5wbv8/emDMwa6//z9P87V6dggAQGC2hZQVMQBAcXlVrrRZAECDPCXIU4IAQJT/9OHyqgBApcLE+5HTAEC3hZQVMfwAQMhIZC/QJAFA2Qs0SW9NAUDrzgNjDnYBQPyR03ytngFADlWjlkzHAUAfGHOw6+8BQDDbQsqKGAJAQZ4S5ClBAkA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"4LxTEsXL6T+z1Sb4/VrnP5n9+eIjE+U/a/TGP8zy4j8Beod7jPjgP2acagb0Rd4/rGGUh1Th2j+Nw39UZcDXP69BIEdR4NQ/yltpOUM+0j8VI50KzK7PPzTFhgnJUcs/X512I9Nfxz/3qlMMQNPDP1XtBHhlpsA/qcfiNDKnuz+2GwBPYaq2P43VL6YDS7I/yed/RIn7rD8N6/xVn26mP1eyclCg2KA/OHb6BsZFmD/NBXF9fG2QP8McAkcj9oM/rCuKYcwEcz/PSwkpzo1CPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALw4VQfS+0M/WiHdj67BUz8UQTqaq1VcPxwdlH2D5GE/mKWGxXMVZT9A2ScROsVnP07Xqsxp+2k/DL9CZJa/az+5ryJEUxltP4vIfdgzEG4/1SiHjcurbj/M73HPrfNuP7I8cQpu724/yC64qp+mbj9Q5Xkc1iBuP4h/6cukZW0/tRw6JZ98bD8R3J6UWG1rP+LcSoZkP2o/Zj5xZlb6aD9Ju6R0oKVnP78ED+65RWY/kMJwDR/cZD/bN+rgKmpjP9Knm3Y48WE/oVWl3KJyYD/aCE9Cit9dP8XuhKT001o/XuMs/DrFVz8CbYdlE7ZUP+8R1fwzqVE/FbGsvKVCTT9kjpdMTEJHP0vI6+HHVkE/EddUagkLNz9cE1L7u08nP3EzyNq93OE+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1147"},"selection_policy":{"id":"1148"}},"id":"1127","type":"ColumnDataSource"},{"attributes":{"line_alpha":0.1,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1139","type":"Line"},{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1083"}],"center":[{"id":"1086"},{"id":"1090"}],"left":[{"id":"1087"}],"plot_height":200,"plot_width":400,"renderers":[{"id":"1095"},{"id":"1100"},{"id":"1105"}],"title":{"id":"1073"},"toolbar":{"id":"1091"},"x_range":{"id":"1075"},"x_scale":{"id":"1079"},"y_range":{"id":"1077"},"y_scale":{"id":"1081"}},"id":"1072","subtype":"Figure","type":"Plot"},{"attributes":{"source":{"id":"1097"}},"id":"1101","type":"CDSView"},{"attributes":{},"id":"1075","type":"DataRange1d"},{"attributes":{"line_alpha":0.6,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1128","type":"Line"},{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1118"}],"center":[{"id":"1121"},{"id":"1125"}],"left":[{"id":"1122"}],"plot_height":200,"plot_width":520,"renderers":[{"id":"1130"},{"id":"1135"},{"id":"1140"}],"right":[{"id":"1178"}],"title":{"id":"1108"},"toolbar":{"id":"1126"},"x_range":{"id":"1110"},"x_scale":{"id":"1114"},"y_range":{"id":"1112"},"y_scale":{"id":"1116"}},"id":"1107","subtype":"Figure","type":"Plot"},{"attributes":{"data_source":{"id":"1067"},"glyph":{"id":"1068"},"hover_glyph":null,"muted_glyph":null,"name":"virginica","nonselection_glyph":{"id":"1069"},"selection_glyph":null,"view":{"id":"1071"}},"id":"1070","type":"GlyphRenderer"},{"attributes":{"data":{"x":{"__ndarray__":"lSBPCfKU+D8A9eHyqlz5P2rJdNxjJPo/1Z0Hxhzs+j9Acpqv1bP7P6pGLZmOe/w/FRvAgkdD/T+A71JsAAv+P+rD5VW50v4/VZh4P3Ka/z9gtoWUFTEAQJUgTwnylABAyooYfs74AEAA9eHyqlwBQDVfq2eHwAFAasl03GMkAkCgMz5RQIgCQNWdB8Yc7AJACgjROvlPA0BAcpqv1bMDQHXcYySyFwRAqkYtmY57BEDgsPYNa98EQBUbwIJHQwVASoWJ9yOnBUCA71JsAAsGQLVZHOHcbgZA6sPlVbnSBkAgLq/KlTYHQFWYeD9ymgdAigJCtE7+B0DAbAspK2IIQPXW1J0HxghAKkGeEuQpCUBgq2eHwI0JQJUVMfyc8QlAyn/6cHlVCkAA6sPlVbkKQDVUjVoyHQtAar5Wzw6BC0CgKCBE6+QLQNWS6bjHSAxACv2yLaSsDEBAZ3yigBANQHTRRRdddA1AqjsPjDnYDUDgpdgAFjwOQBQQonXynw5ASnpr6s4DD0CA5DRfq2cPQLRO/tOHyw9AddxjJLIXEECQkcheoEkQQKpGLZmOexBAxfuR03ytEEDgsPYNa98QQPplW0hZERFAFRvAgkdDEUAw0CS9NXURQEqFifcjpxFAZTruMRLZEUCA71JsAAsSQJqkt6buPBJAtVkc4dxuEkDQDoEby6ASQOrD5VW50hJABXlKkKcEE0AgLq/KlTYTQDrjEwWEaBNAVZh4P3KaE0BwTd15YMwTQIoCQrRO/hNApbem7jwwFEDAbAspK2IUQNohcGMZlBRA9dbUnQfGFEAQjDnY9fcUQCpBnhLkKRVARfYCTdJbFUBgq2eHwI0VQHpgzMGuvxVAlRUx/JzxFUCwypU2iyMWQMp/+nB5VRZA5TRfq2eHFkD/6cPlVbkWQBqfKCBE6xZANVSNWjIdF0BPCfKUIE8XQGq+Vs8OgRdAhXO7Cf2yF0CfKCBE6+QXQLrdhH7ZFhhA1ZLpuMdIGEDvR07ztXoYQAr9si2krBhAJbIXaJLeGEA/Z3yigBAZQFoc4dxuQhlAddFFF110GUA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"lqLoAMKrWj8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAENdJ687GJT+AeydbFuBYPwSSU6mVhGc/gcPMyFw1cT/RhAULknl2PzXDJjNBd3s/kpqBbGALgD99yDbKMyCCP4hGnP5F7oM/4G+bVcJphT/Cnx0b1IaGP1MxDJumOYc/xH9QIWV2hz9H5tP5OjGHPxDAf3BTXoY/R2g90dnxhD8gOvZn+d+CP8mQk4DdHIA/9Y79zWI5eT9R8Y6c8qtwPwhWmjinu1o/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABigVX+28eD94Ys5lu8+ZP0Z+TxskJak/MRcJVx8GtD+LgD4SMeu8P7dZ7LOAmsM/uyApJrVWyT8/pSiWPI7PP5n7Ht2OEtM/chNepK9/1j8lIvv7gwDaP6KvHz8Ph90/DKJ6ZKqC4D+5s1L6qzbiP93QrA6O2OM/gb0dT1Jh5T9usHkIDcrmPzpuV3amDug/ot9RPrMu6T+rEHrfBirqP14N4dh0AOs/1OGXqdCx6z8Smq/Q7T3sPyRCOc2fpOw/HeZFHrrl7D8EkuZCEAHtP+pRLLp19uw/2zEoA77F7D+4ivvSwG7sP0o497Cb8us/HfV5bpRU6z8cQklcJpjqPxigKsvMwOk/9I/jCwPS6D+YkjlvRM/nP9Yo8kUMvOY/ldPS4NWb5T+3E6GQHHLkPxZqIqZbQuM/kVcccg4Q4j8QXVRFsN7gP832H+F4Y98/8mYpiVwZ3T8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1218"},"selection_policy":{"id":"1219"}},"id":"1102","type":"ColumnDataSource"},{"attributes":{},"id":"1150","type":"UnionRenderers"},{"attributes":{"data_source":{"id":"1097"},"glyph":{"id":"1098"},"hover_glyph":null,"muted_glyph":null,"name":"versicolor","nonselection_glyph":{"id":"1099"},"selection_glyph":null,"view":{"id":"1101"}},"id":"1100","type":"GlyphRenderer"},{"attributes":{"line_alpha":0.1,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1069","type":"Line"},{"attributes":{"source":{"id":"1127"}},"id":"1131","type":"CDSView"},{"attributes":{},"id":"1151","type":"Selection"},{"attributes":{"line_alpha":0.1,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1099","type":"Line"},{"attributes":{"data_source":{"id":"1127"},"glyph":{"id":"1128"},"hover_glyph":null,"muted_glyph":null,"name":"setosa","nonselection_glyph":{"id":"1129"},"selection_glyph":null,"view":{"id":"1131"}},"id":"1130","type":"GlyphRenderer"},{"attributes":{"children":[{"id":"1002"},{"id":"1037"}]},"id":"1179","type":"Row"},{"attributes":{},"id":"1077","type":"DataRange1d"},{"attributes":{"source":{"id":"1102"}},"id":"1106","type":"CDSView"},{"attributes":{"line_alpha":0.1,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1129","type":"Line"},{"attributes":{},"id":"1079","type":"LinearScale"},{"attributes":{},"id":"1152","type":"UnionRenderers"},{"attributes":{},"id":"1081","type":"LinearScale"},{"attributes":{},"id":"1190","type":"BasicTickFormatter"},{"attributes":{},"id":"1145","type":"BasicTickFormatter"},{"attributes":{"axis_label":"length (cm)","formatter":{"id":"1194"},"ticker":{"id":"1084"}},"id":"1083","type":"LinearAxis"},{"attributes":{"line_alpha":0.1,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1104","type":"Line"},{"attributes":{"axis":{"id":"1083"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1086","type":"Grid"},{"attributes":{"data_source":{"id":"1102"},"glyph":{"id":"1103"},"hover_glyph":null,"muted_glyph":null,"name":"virginica","nonselection_glyph":{"id":"1104"},"selection_glyph":null,"view":{"id":"1106"}},"id":"1105","type":"GlyphRenderer"}],"root_ids":["1181"]},"title":"Bokeh Application","version":"2.2.1"}};
  var render_items = [{"docid":"84b0e2f8-5c7e-4ac2-82d1-815cc4b7f17a","root_ids":["1181"],"roots":{"1181":"f728b29e-42c5-4bd7-8c70-f645176d208c"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>Ok, these <strong>distributions</strong> are certainly more helpful than the dataframe view above. What can we learn?</p>
<p>Well, it appears that smaller petals tend to correspond to <em>setosas</em>. In fact, it looks like there aren’t really any <em>versicolor</em> or <em>viginica</em> samples with petal lengths lower than ~2.2 cm, or petal widths lower than ~0.7 cm. So why don’t we make that our first rule:</p>
<blockquote>
<div><p>If your petal length is lower than 2.2 cm, or your petal width lower than 0.7 cm, you will be classified as a <em>setosa</em></p>
</div></blockquote>
<p>Now all we need to do is come up with a rule to distinguish <em>versicolors</em> and <em>virginicas</em>. Unfortunately, there seems to be much more overlap between these two. It looks like <em>virginica</em> tends to dominate at petal lengths above 5.1 and petal widths above 1.7 (though there are obviously a finite number of samples that break this rule). Let’s make our second rule:</p>
<blockquote>
<div><p>If your petal length is greater than 5.1 and your petal width is greater than 1.7, you will be classified as <em>virginica</em></p>
</div></blockquote>
<p>So now we’ll encode, in code, a function which uses these rules to map from a set of measurements (a <strong>sample</strong>), and returns a class name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rules_based_ai_classifier</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;petal length (cm)&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">2.2</span> <span class="ow">and</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;petal width (cm)&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;setosa&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;petal width (cm)&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.7</span> <span class="ow">and</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;petal length (cm)&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">5.1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;virginica&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;versicolor&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>So how well does this rule work? Let’s run it on our dataset and see how many (or, more usefully, what fraction) it classifies correctly. We can even take a look at the ones we got wrong to see where and why our rule failed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_right</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">wrong_rows</span><span class="p">,</span> <span class="n">wrong_predictions</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row_id</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">rules_based_ai_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="n">prediction</span><span class="p">:</span>
        <span class="n">num_right</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrong_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_id</span><span class="p">)</span>
        <span class="n">wrong_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">num_right</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">{:0.2f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy</span><span class="p">))</span>

<span class="n">wrong_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wrong_rows</span><span class="p">]</span>
<span class="n">wrong_df</span><span class="p">[</span><span class="s2">&quot;predicted class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrong_predictions</span>
<span class="n">wrong_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 92.00%
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>class</th>
      <th>predicted class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>106</th>
      <td>4.9</td>
      <td>2.5</td>
      <td>4.5</td>
      <td>1.7</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>113</th>
      <td>5.7</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>119</th>
      <td>6.0</td>
      <td>2.2</td>
      <td>5.0</td>
      <td>1.5</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>121</th>
      <td>5.6</td>
      <td>2.8</td>
      <td>4.9</td>
      <td>2.0</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>123</th>
      <td>6.3</td>
      <td>2.7</td>
      <td>4.9</td>
      <td>1.8</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>126</th>
      <td>6.2</td>
      <td>2.8</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>127</th>
      <td>6.1</td>
      <td>3.0</td>
      <td>4.9</td>
      <td>1.8</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>129</th>
      <td>7.2</td>
      <td>3.0</td>
      <td>5.8</td>
      <td>1.6</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>133</th>
      <td>6.3</td>
      <td>2.8</td>
      <td>5.1</td>
      <td>1.5</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>134</th>
      <td>6.1</td>
      <td>2.6</td>
      <td>5.6</td>
      <td>1.4</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>138</th>
      <td>6.0</td>
      <td>3.0</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So with just these simple rules (and not even leveraging the sepal measurements at all), we manage to classify 92% of our samples correctly. Not bad!</p>
<p>Moreover, it looks like the only mistake we made was calling a bunch of <em>virginicas</em> <em>versicolors</em>. This should be unsurprising, given the level of overlap between the feature distributions of these classes.</p>
<p>Still, an astute observer of the missed classifications may be bothered by one observation in particular. Take, for example, the error we made in row <span class="math notranslate nohighlight">\(106\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">106</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>sepal length (cm)          4.9
sepal width (cm)           2.5
petal length (cm)          4.5
petal width (cm)           1.7
class                virginica
Name: 106, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Looking back at our distributions, we see that <em>virginica</em> has a relatively low probability of having petal measurements in this region, especially in comparison to <em>versicolor</em>. The probability isn’t <em>zero</em>, so maybe it’s unsurprising that <em>one</em> of these measurements would come out so low, but what are the odds that <em>both</em> of them do?!</p>
<p>The resolution to this apparent paradox is that these measurements are <strong>correlated</strong>: the higher petal lengths are more likely to correspond to higher petal widths as well. When we looked at the distributions along each feature individually, we lost the ability to see how class probabilities are distributed across the entire <strong>feature space</strong> (in essence, we projected along each <strong>axis</strong> of the feature space). To see what I mean, let’s plot these features against one another and note how often an increase in one leads to an increase in the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">petal_features</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">feature_names</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;petal&quot;</span><span class="p">)]</span>
<span class="n">scatter_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">petal_features</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">fig_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">petal_features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]):</span>
    <span class="n">scatter_df</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">scatter_df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
    <span class="n">fig_kwargs</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_axis_label&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis</span><span class="p">)]</span> <span class="o">=</span> <span class="n">feature</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">plot_utils</span><span class="o">.</span><span class="n">make_2d_scatter_plot</span><span class="p">(</span><span class="n">scatter_df</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="n">fig_kwargs</span><span class="o">=</span><span class="n">fig_kwargs</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="o">=</span><span class="s2">&quot;top_left&quot;</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">





<div class="bk-root" id="be48e2a9-0bf5-462f-9a4b-a0b037cd649f" data-root-id="1447"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
    
  var docs_json = {"93ef8834-c902-47b0-b6a6-b243d2e25c8b":{"roots":{"references":[{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1456"}],"center":[{"id":"1459"},{"id":"1463"},{"id":"1478"}],"left":[{"id":"1460"}],"plot_height":500,"plot_width":500,"renderers":[{"id":"1468"}],"title":{"id":"1471"},"toolbar":{"id":"1464"},"x_range":{"id":"1448"},"x_scale":{"id":"1452"},"y_range":{"id":"1450"},"y_scale":{"id":"1454"}},"id":"1447","subtype":"Figure","type":"Plot"},{"attributes":{"axis":{"id":"1460"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1463","type":"Grid"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"1490"}]},"id":"1464","type":"Toolbar"},{"attributes":{"items":[{"id":"1479"},{"id":"1480"},{"id":"1481"}],"location":"top_left"},"id":"1478","type":"Legend"},{"attributes":{},"id":"1450","type":"DataRange1d"},{"attributes":{"fill_alpha":{"value":0.4},"fill_color":{"field":"color"},"line_alpha":{"value":0.8},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1466","type":"Circle"},{"attributes":{"data":{"class":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"color":["#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"petal_length_cm":{"__ndarray__":"ZmZmZmZm9j9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D9mZmZmZmb2PzMzMzMzM/s/ZmZmZmZm9j8AAAAAAAD4P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P5qZmZmZmfk/ZmZmZmZm9j+amZmZmZnxPzMzMzMzM/M/AAAAAAAA+D/NzMzMzMz0P2ZmZmZmZvY/MzMzMzMz+z8AAAAAAAD4PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwPzMzMzMzM/s/ZmZmZmZm/j+amZmZmZn5P5qZmZmZmfk/AAAAAAAA+D9mZmZmZmb2P5qZmZmZmfk/mpmZmZmZ+T8AAAAAAAD4PwAAAAAAAPg/ZmZmZmZm9j8AAAAAAAD4PzMzMzMzM/M/zczMzMzM9D9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P83MzMzMzPQ/zczMzMzM9D+amZmZmZn5P2ZmZmZmZv4/ZmZmZmZm9j+amZmZmZn5P2ZmZmZmZvY/AAAAAAAA+D9mZmZmZmb2P83MzMzMzBJAAAAAAAAAEkCamZmZmZkTQAAAAAAAABBAZmZmZmZmEkAAAAAAAAASQM3MzMzMzBJAZmZmZmZmCkBmZmZmZmYSQDMzMzMzMw9AAAAAAAAADEDNzMzMzMwQQAAAAAAAABBAzczMzMzMEkDNzMzMzMwMQJqZmZmZmRFAAAAAAAAAEkBmZmZmZmYQQAAAAAAAABJAMzMzMzMzD0AzMzMzMzMTQAAAAAAAABBAmpmZmZmZE0DNzMzMzMwSQDMzMzMzMxFAmpmZmZmZEUAzMzMzMzMTQAAAAAAAABRAAAAAAAAAEkAAAAAAAAAMQGZmZmZmZg5AmpmZmZmZDUAzMzMzMzMPQGZmZmZmZhRAAAAAAAAAEkAAAAAAAAASQM3MzMzMzBJAmpmZmZmZEUBmZmZmZmYQQAAAAAAAABBAmpmZmZmZEUBmZmZmZmYSQAAAAAAAABBAZmZmZmZmCkDNzMzMzMwQQM3MzMzMzBBAzczMzMzMEEAzMzMzMzMRQAAAAAAAAAhAZmZmZmZmEEAAAAAAAAAYQGZmZmZmZhRAmpmZmZmZF0BmZmZmZmYWQDMzMzMzMxdAZmZmZmZmGkAAAAAAAAASQDMzMzMzMxlAMzMzMzMzF0BmZmZmZmYYQGZmZmZmZhRAMzMzMzMzFUAAAAAAAAAWQAAAAAAAABRAZmZmZmZmFEAzMzMzMzMVQAAAAAAAABZAzczMzMzMGkCamZmZmZkbQAAAAAAAABRAzczMzMzMFkCamZmZmZkTQM3MzMzMzBpAmpmZmZmZE0DNzMzMzMwWQAAAAAAAABhAMzMzMzMzE0CamZmZmZkTQGZmZmZmZhZAMzMzMzMzF0BmZmZmZmYYQJqZmZmZmRlAZmZmZmZmFkBmZmZmZmYUQGZmZmZmZhZAZmZmZmZmGEBmZmZmZmYWQAAAAAAAABZAMzMzMzMzE0CamZmZmZkVQGZmZmZmZhZAZmZmZmZmFEBmZmZmZmYUQJqZmZmZmRdAzczMzMzMFkDNzMzMzMwUQAAAAAAAABRAzczMzMzMFECamZmZmZkVQGZmZmZmZhRA","dtype":"float64","order":"little","shape":[150]},"petal_width_cm":{"__ndarray__":"mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZm5P5qZmZmZmck/mpmZmZmZ2T+amZmZmZnZPzMzMzMzM9M/MzMzMzMz0z8zMzMzMzPTP5qZmZmZmck/mpmZmZmZ2T+amZmZmZnJPwAAAAAAAOA/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnZP5qZmZmZmbk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZm5P5qZmZmZmck/mpmZmZmZyT8zMzMzMzPTPzMzMzMzM9M/mpmZmZmZyT8zMzMzMzPjP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P5qZmZmZmfk/AAAAAAAA8D/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAPA/ZmZmZmZm9j/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAADwPwAAAAAAAPg/mpmZmZmZ8T/NzMzMzMz8P83MzMzMzPQ/AAAAAAAA+D8zMzMzMzPzP83MzMzMzPQ/ZmZmZmZm9j9mZmZmZmb2PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwP5qZmZmZmfE/AAAAAAAA8D8zMzMzMzPzP5qZmZmZmfk/AAAAAAAA+D+amZmZmZn5PwAAAAAAAPg/zczMzMzM9D/NzMzMzMz0P83MzMzMzPQ/MzMzMzMz8z9mZmZmZmb2PzMzMzMzM/M/AAAAAAAA8D/NzMzMzMz0PzMzMzMzM/M/zczMzMzM9D/NzMzMzMz0P5qZmZmZmfE/zczMzMzM9D8AAAAAAAAEQGZmZmZmZv4/zczMzMzMAEDNzMzMzMz8P5qZmZmZmQFAzczMzMzMAEAzMzMzMzP7P83MzMzMzPw/zczMzMzM/D8AAAAAAAAEQAAAAAAAAABAZmZmZmZm/j/NzMzMzMwAQAAAAAAAAABAMzMzMzMzA0BmZmZmZmYCQM3MzMzMzPw/mpmZmZmZAUBmZmZmZmYCQAAAAAAAAPg/ZmZmZmZmAkAAAAAAAAAAQAAAAAAAAABAzczMzMzM/D/NzMzMzMwAQM3MzMzMzPw/zczMzMzM/D/NzMzMzMz8P83MzMzMzABAmpmZmZmZ+T9mZmZmZmb+PwAAAAAAAABAmpmZmZmZAUAAAAAAAAD4P2ZmZmZmZvY/ZmZmZmZmAkAzMzMzMzMDQM3MzMzMzPw/zczMzMzM/D/NzMzMzMwAQDMzMzMzMwNAZmZmZmZmAkBmZmZmZmb+P2ZmZmZmZgJAAAAAAAAABEBmZmZmZmYCQGZmZmZmZv4/AAAAAAAAAEBmZmZmZmYCQM3MzMzMzPw/","dtype":"float64","order":"little","shape":[150]},"x":{"__ndarray__":"ZmZmZmZm9j9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D9mZmZmZmb2PzMzMzMzM/s/ZmZmZmZm9j8AAAAAAAD4P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P5qZmZmZmfk/ZmZmZmZm9j+amZmZmZnxPzMzMzMzM/M/AAAAAAAA+D/NzMzMzMz0P2ZmZmZmZvY/MzMzMzMz+z8AAAAAAAD4PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwPzMzMzMzM/s/ZmZmZmZm/j+amZmZmZn5P5qZmZmZmfk/AAAAAAAA+D9mZmZmZmb2P5qZmZmZmfk/mpmZmZmZ+T8AAAAAAAD4PwAAAAAAAPg/ZmZmZmZm9j8AAAAAAAD4PzMzMzMzM/M/zczMzMzM9D9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P83MzMzMzPQ/zczMzMzM9D+amZmZmZn5P2ZmZmZmZv4/ZmZmZmZm9j+amZmZmZn5P2ZmZmZmZvY/AAAAAAAA+D9mZmZmZmb2P83MzMzMzBJAAAAAAAAAEkCamZmZmZkTQAAAAAAAABBAZmZmZmZmEkAAAAAAAAASQM3MzMzMzBJAZmZmZmZmCkBmZmZmZmYSQDMzMzMzMw9AAAAAAAAADEDNzMzMzMwQQAAAAAAAABBAzczMzMzMEkDNzMzMzMwMQJqZmZmZmRFAAAAAAAAAEkBmZmZmZmYQQAAAAAAAABJAMzMzMzMzD0AzMzMzMzMTQAAAAAAAABBAmpmZmZmZE0DNzMzMzMwSQDMzMzMzMxFAmpmZmZmZEUAzMzMzMzMTQAAAAAAAABRAAAAAAAAAEkAAAAAAAAAMQGZmZmZmZg5AmpmZmZmZDUAzMzMzMzMPQGZmZmZmZhRAAAAAAAAAEkAAAAAAAAASQM3MzMzMzBJAmpmZmZmZEUBmZmZmZmYQQAAAAAAAABBAmpmZmZmZEUBmZmZmZmYSQAAAAAAAABBAZmZmZmZmCkDNzMzMzMwQQM3MzMzMzBBAzczMzMzMEEAzMzMzMzMRQAAAAAAAAAhAZmZmZmZmEEAAAAAAAAAYQGZmZmZmZhRAmpmZmZmZF0BmZmZmZmYWQDMzMzMzMxdAZmZmZmZmGkAAAAAAAAASQDMzMzMzMxlAMzMzMzMzF0BmZmZmZmYYQGZmZmZmZhRAMzMzMzMzFUAAAAAAAAAWQAAAAAAAABRAZmZmZmZmFEAzMzMzMzMVQAAAAAAAABZAzczMzMzMGkCamZmZmZkbQAAAAAAAABRAzczMzMzMFkCamZmZmZkTQM3MzMzMzBpAmpmZmZmZE0DNzMzMzMwWQAAAAAAAABhAMzMzMzMzE0CamZmZmZkTQGZmZmZmZhZAMzMzMzMzF0BmZmZmZmYYQJqZmZmZmRlAZmZmZmZmFkBmZmZmZmYUQGZmZmZmZhZAZmZmZmZmGEBmZmZmZmYWQAAAAAAAABZAMzMzMzMzE0CamZmZmZkVQGZmZmZmZhZAZmZmZmZmFEBmZmZmZmYUQJqZmZmZmRdAzczMzMzMFkDNzMzMzMwUQAAAAAAAABRAzczMzMzMFECamZmZmZkVQGZmZmZmZhRA","dtype":"float64","order":"little","shape":[150]},"y":{"__ndarray__":"mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZm5P5qZmZmZmck/mpmZmZmZ2T+amZmZmZnZPzMzMzMzM9M/MzMzMzMz0z8zMzMzMzPTP5qZmZmZmck/mpmZmZmZ2T+amZmZmZnJPwAAAAAAAOA/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnZP5qZmZmZmbk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZm5P5qZmZmZmck/mpmZmZmZyT8zMzMzMzPTPzMzMzMzM9M/mpmZmZmZyT8zMzMzMzPjP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P5qZmZmZmfk/AAAAAAAA8D/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAPA/ZmZmZmZm9j/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAADwPwAAAAAAAPg/mpmZmZmZ8T/NzMzMzMz8P83MzMzMzPQ/AAAAAAAA+D8zMzMzMzPzP83MzMzMzPQ/ZmZmZmZm9j9mZmZmZmb2PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwP5qZmZmZmfE/AAAAAAAA8D8zMzMzMzPzP5qZmZmZmfk/AAAAAAAA+D+amZmZmZn5PwAAAAAAAPg/zczMzMzM9D/NzMzMzMz0P83MzMzMzPQ/MzMzMzMz8z9mZmZmZmb2PzMzMzMzM/M/AAAAAAAA8D/NzMzMzMz0PzMzMzMzM/M/zczMzMzM9D/NzMzMzMz0P5qZmZmZmfE/zczMzMzM9D8AAAAAAAAEQGZmZmZmZv4/zczMzMzMAEDNzMzMzMz8P5qZmZmZmQFAzczMzMzMAEAzMzMzMzP7P83MzMzMzPw/zczMzMzM/D8AAAAAAAAEQAAAAAAAAABAZmZmZmZm/j/NzMzMzMwAQAAAAAAAAABAMzMzMzMzA0BmZmZmZmYCQM3MzMzMzPw/mpmZmZmZAUBmZmZmZmYCQAAAAAAAAPg/ZmZmZmZmAkAAAAAAAAAAQAAAAAAAAABAzczMzMzM/D/NzMzMzMwAQM3MzMzMzPw/zczMzMzM/D/NzMzMzMz8P83MzMzMzABAmpmZmZmZ+T9mZmZmZmb+PwAAAAAAAABAmpmZmZmZAUAAAAAAAAD4P2ZmZmZmZvY/ZmZmZmZmAkAzMzMzMzMDQM3MzMzMzPw/zczMzMzM/D/NzMzMzMwAQDMzMzMzMwNAZmZmZmZmAkBmZmZmZmb+P2ZmZmZmZgJAAAAAAAAABEBmZmZmZmYCQGZmZmZmZv4/AAAAAAAAAEBmZmZmZmYCQM3MzMzMzPw/","dtype":"float64","order":"little","shape":[150]}},"selected":{"id":"1476"},"selection_policy":{"id":"1477"}},"id":"1446","type":"ColumnDataSource"},{"attributes":{},"id":"1448","type":"DataRange1d"},{"attributes":{"text":""},"id":"1471","type":"Title"},{"attributes":{"index":0,"label":{"value":"setosa"},"renderers":[{"id":"1468"}]},"id":"1479","type":"LegendItem"},{"attributes":{"source":{"id":"1446"}},"id":"1469","type":"CDSView"},{"attributes":{},"id":"1454","type":"LinearScale"},{"attributes":{"axis_label":"petal length (cm)","formatter":{"id":"1472"},"ticker":{"id":"1457"}},"id":"1456","type":"LinearAxis"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"color"},"line_alpha":{"value":0.1},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1467","type":"Circle"},{"attributes":{},"id":"1461","type":"BasicTicker"},{"attributes":{"callback":null,"renderers":[{"id":"1468"}],"tooltips":[["petal length (cm)","@petal_length_cm"],["petal width (cm)","@petal_width_cm"],["Class","@class"]]},"id":"1490","type":"HoverTool"},{"attributes":{},"id":"1457","type":"BasicTicker"},{"attributes":{"data_source":{"id":"1446"},"glyph":{"id":"1466"},"hover_glyph":null,"muted_glyph":null,"name":"scatter","nonselection_glyph":{"id":"1467"},"selection_glyph":null,"view":{"id":"1469"}},"id":"1468","type":"GlyphRenderer"},{"attributes":{"index":50,"label":{"value":"versicolor"},"renderers":[{"id":"1468"}]},"id":"1480","type":"LegendItem"},{"attributes":{},"id":"1452","type":"LinearScale"},{"attributes":{"axis":{"id":"1456"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1459","type":"Grid"},{"attributes":{"index":100,"label":{"value":"virginica"},"renderers":[{"id":"1468"}]},"id":"1481","type":"LegendItem"},{"attributes":{},"id":"1474","type":"BasicTickFormatter"},{"attributes":{},"id":"1476","type":"Selection"},{"attributes":{},"id":"1472","type":"BasicTickFormatter"},{"attributes":{"axis_label":"petal width (cm)","formatter":{"id":"1474"},"ticker":{"id":"1461"}},"id":"1460","type":"LinearAxis"},{"attributes":{},"id":"1477","type":"UnionRenderers"}],"root_ids":["1447"]},"title":"Bokeh Application","version":"2.2.1"}};
  var render_items = [{"docid":"93ef8834-c902-47b0-b6a6-b243d2e25c8b","root_ids":["1447"],"roots":{"1447":"be48e2a9-0bf5-462f-9a4b-a0b037cd649f"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>This view should hopefully give us a <em>much</em> clearer idea of how these classes are separated along these two feature axes. In particular, it becomes extremely obvious how different <em>setosa</em> is from the other two classes. This might incentivize us to breaking the problem up into 2 subproblems: separating <em>setosa</em> from <em>versicolor</em> and <em>virginica</em> (relatively easy), and separating <em>versicolor</em> from <em>virginica</em> (more difficult). However, there’s another, more general observation I would like us to make.</p>
<p>If increases in petal length are frequently accompanied by increases in petal width, why do we need to bother tracking both of these measurements <em>separately</em>? Shouldn’t we be be able to combine them into one measurement that tells us just about everything we need to know (as far as classifying is concerened) about the petal?</p>
<p>Philosophically, we can imagine that we’ve chosen to represent the petal of an iris, a physical object in the real world, by projecting it along a <strong>basis</strong> corresponding to two measurements <em>about</em> the petal, which are floating point numbers in the “data world”. However, it appears that this basis is not orthogonal: when I move along one axis, I’m also unavoidably moving along the other axis as well. The less orthogonal these axes are, the more of a waste (and, for reasons we’ll touch on later, actually a <em>problem</em>) it is that I’m representing this object with two numbers instead of one.</p>
<p>So what one number could we use to represent the petal? Well, if higher lengths tend to lead to higher widths, then it sounds like what we’re talking about roughly is higher <em>areas</em> (length times width). So why don’t we calculate this value for our samples, and see how that combined measurement is distributed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">area_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">area_df</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">petal_features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="n">petal_features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">area_df</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>

<span class="n">fig_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Petal Area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;x_axis_label&quot;</span><span class="p">:</span> <span class="s2">&quot;Value (cm^2)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;y_axis_label&quot;</span><span class="p">:</span> <span class="s2">&quot;Probability&quot;</span><span class="p">,</span>
    <span class="s2">&quot;plot_height&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
    <span class="s2">&quot;plot_width&quot;</span><span class="p">:</span> <span class="mi">800</span>
<span class="p">}</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">plot_utils</span><span class="o">.</span><span class="n">make_distribution_plot</span><span class="p">(</span>
    <span class="n">area_df</span><span class="p">,</span>
    <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">label_column</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">,</span>
    <span class="n">fig_kwargs</span><span class="o">=</span><span class="n">fig_kwargs</span>
<span class="p">)</span>

<span class="c1"># configure a legend on just the last plot</span>
<span class="n">legend_items</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">class_name</span><span class="p">)</span>
    <span class="n">legend_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LegendItem</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">class_name</span><span class="p">,</span> <span class="n">renderers</span><span class="o">=</span><span class="n">r</span><span class="p">))</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">Legend</span><span class="p">(</span>
    <span class="n">items</span><span class="o">=</span><span class="n">legend_items</span><span class="p">,</span>
    <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">





<div class="bk-root" id="487832b1-3dbe-4468-9f87-cda06bf96bc1" data-root-id="1584"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
    
  var docs_json = {"8e090b68-a6d3-4d41-8e6e-b4f1eada68a9":{"roots":{"references":[{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1595"}],"center":[{"id":"1598"},{"id":"1602"}],"left":[{"id":"1599"}],"plot_height":300,"plot_width":800,"renderers":[{"id":"1607"},{"id":"1612"},{"id":"1617"}],"right":[{"id":"1655"}],"title":{"id":"1585"},"toolbar":{"id":"1603"},"x_range":{"id":"1587"},"x_scale":{"id":"1591"},"y_range":{"id":"1589"},"y_scale":{"id":"1593"}},"id":"1584","subtype":"Figure","type":"Plot"},{"attributes":{"text":"Petal Area"},"id":"1585","type":"Title"},{"attributes":{"data":{"x":{"__ndarray__":"ryzwygKv+D8KpnamgcT6P2Yf/YEA2vw/wZiDXX/v/j8OCYUcf4IAQLxFSIo+jQFAaoIL+P2XAkAXv85lvaIDQMX7kdN8rQRAcjhVQTy4BUAgdRiv+8IGQM6x2xy7zQdAfO6einrYCEAqK2L4OeMJQNdnJWb57QpAhaTo07j4C0Ay4atBeAMNQOAdb683Dg5AjloyHfcYD0Cey3pF2xEQQPVpXPw6lxBASwg+s5ocEUCiph9q+qERQPlEASFaJxJAUOPi17msEkCngcSOGTITQP4fpkV5txNAVb6H/Ng8FECrXGmzOMIUQAL7SmqYRxVAWZksIfjMFUCwNw7YV1IWQAfW74631xZAXnTRRRddF0C1ErP8duIXQAyxlLPWZxhAYk92ajbtGEC57VchlnIZQBCMOdj19xlAZyobj1V9GkC+yPxFtQIbQBVn3vwUiBtAawXAs3QNHEDCo6Fq1JIcQBlCgyE0GB1AcOBk2JOdHUDHfkaP8yIeQB4dKEZTqB5AdLsJ/bItH0DLWeuzErMfQBF8ZjU5HCBAPEvXEOleIEBoGkjsmKEgQJPpuMdI5CBAv7gpo/gmIUDqh5p+qGkhQBVXC1pYrCFAQSZ8NQjvIUBs9ewQuDEiQJjEXexndCJAw5POxxe3IkDuYj+jx/kiQBoysH53PCNARgEhWid/I0Bx0JE118EjQJyfAhGHBCRAyG5z7DZHJEDzPeTH5okkQB8NVaOWzCRAStzFfkYPJUB2qzZa9lElQKF6pzWmlCVAzEkYEVbXJUD4GInsBRomQCPo+ce1XCZAT7dqo2WfJkB6htt+FeImQKVVTFrFJCdA0SS9NXVnJ0D88y0RJaonQCjDnuzU7CdAU5IPyIQvKEB/YYCjNHIoQKow8X7ktChA1f9hWpT3KEABz9I1RDopQCyeQxH0fClAWG207KO/KUCDPCXIUwIqQK8LlqMDRSpA2toGf7OHKkAFqndaY8oqQDF56DUTDStAXEhZEcNPK0CIF8rscpIrQLPmOsgi1StA3rWro9IXLEAKhRx/glosQDVUjVoynSxAYCP+NeLfLEA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeWlTG5NZkz9esopi72vAP/AUYa6qo88/sVrE9Krw1z/3LKet+DzgPz0MDq6QquQ/OpM95Nk06T8Dity4kM/tP1fcSMo4N/E/pfMBcJyC8z//7uyB0cP1P2syXTS29Pc/9iGmuygP+j8neEMCZg38P6gO8+xm7P0/o13YG16q/z9Mv/fUv6IAQIRFGtn/XQFAPs7RJwkGAkA0ZpzO9ZkCQCwa+NrfGANA5PZiWuGBA0AeCVtaFNQDQJddXuiSDgRAFAHrEXcwBED6F0UE+TgEQGJPE+qHKARAjGWcZUoABEBZtDN4acEDQKSVLCMObQNATWPaZ2EEA0Azd5BHjIgCQDIrosO3+gFAKdli3QxcAUD52iWWtK0AQPgUfd6v4f8/JoMA1D9N/j94IfINgaD8PxphxqUk3/o/Yad8C9kN+T+sEV0zUzH3P3G9rxFITvU/C8i8mmxp8z/sTszCdYfxP/TeTPwwWu8/LY4mghO+6z9o5rX//EPoP2Uii11X9eQ/B302hIzb4T9bhrxvjv/dP7vDSO4Ly9g/s8xM9jUV1D/Zv19iZbLPP+Z3spBQJMg/sz5gynl2wT9NI2/EWj63P0K3G6zeUqo/kITmvCdrkj8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0vzzNtNgdj8zyZNtU1yFP4d9pA6reY0/6iRcvlLXkT+Jru3auxCUPwDzDFwrfJU/pQnAwLsslj/aCQ2IhzWWPwYL+jCpqZU/hySNOjuclD+5bcwjWCCTPwX+vWsaSZE/ktnPIjlTjj8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1626"},"selection_policy":{"id":"1627"}},"id":"1609","type":"ColumnDataSource"},{"attributes":{},"id":"1625","type":"UnionRenderers"},{"attributes":{"line_alpha":0.6,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1615","type":"Line"},{"attributes":{},"id":"1626","type":"Selection"},{"attributes":{},"id":"1620","type":"BasicTickFormatter"},{"attributes":{"source":{"id":"1604"}},"id":"1608","type":"CDSView"},{"attributes":{},"id":"1627","type":"UnionRenderers"},{"attributes":{},"id":"1589","type":"DataRange1d"},{"attributes":{"data_source":{"id":"1604"},"glyph":{"id":"1605"},"hover_glyph":null,"muted_glyph":null,"name":"setosa","nonselection_glyph":{"id":"1606"},"selection_glyph":null,"view":{"id":"1608"}},"id":"1607","type":"GlyphRenderer"},{"attributes":{},"id":"1628","type":"Selection"},{"attributes":{"axis":{"id":"1595"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1598","type":"Grid"},{"attributes":{"axis":{"id":"1599"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1602","type":"Grid"},{"attributes":{},"id":"1591","type":"LinearScale"},{"attributes":{},"id":"1629","type":"UnionRenderers"},{"attributes":{},"id":"1593","type":"LinearScale"},{"attributes":{"line_alpha":0.1,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1606","type":"Line"},{"attributes":{"source":{"id":"1609"}},"id":"1613","type":"CDSView"},{"attributes":{"axis_label":"Value (cm^2)","formatter":{"id":"1620"},"ticker":{"id":"1596"}},"id":"1595","type":"LinearAxis"},{"attributes":{"label":{"value":"virginica"},"renderers":[{"id":"1617"}]},"id":"1654","type":"LegendItem"},{"attributes":{},"id":"1596","type":"BasicTicker"},{"attributes":{"data":{"x":{"__ndarray__":"ryzwygKv+D8KpnamgcT6P2Yf/YEA2vw/wZiDXX/v/j8OCYUcf4IAQLxFSIo+jQFAaoIL+P2XAkAXv85lvaIDQMX7kdN8rQRAcjhVQTy4BUAgdRiv+8IGQM6x2xy7zQdAfO6einrYCEAqK2L4OeMJQNdnJWb57QpAhaTo07j4C0Ay4atBeAMNQOAdb683Dg5AjloyHfcYD0Cey3pF2xEQQPVpXPw6lxBASwg+s5ocEUCiph9q+qERQPlEASFaJxJAUOPi17msEkCngcSOGTITQP4fpkV5txNAVb6H/Ng8FECrXGmzOMIUQAL7SmqYRxVAWZksIfjMFUCwNw7YV1IWQAfW74631xZAXnTRRRddF0C1ErP8duIXQAyxlLPWZxhAYk92ajbtGEC57VchlnIZQBCMOdj19xlAZyobj1V9GkC+yPxFtQIbQBVn3vwUiBtAawXAs3QNHEDCo6Fq1JIcQBlCgyE0GB1AcOBk2JOdHUDHfkaP8yIeQB4dKEZTqB5AdLsJ/bItH0DLWeuzErMfQBF8ZjU5HCBAPEvXEOleIEBoGkjsmKEgQJPpuMdI5CBAv7gpo/gmIUDqh5p+qGkhQBVXC1pYrCFAQSZ8NQjvIUBs9ewQuDEiQJjEXexndCJAw5POxxe3IkDuYj+jx/kiQBoysH53PCNARgEhWid/I0Bx0JE118EjQJyfAhGHBCRAyG5z7DZHJEDzPeTH5okkQB8NVaOWzCRAStzFfkYPJUB2qzZa9lElQKF6pzWmlCVAzEkYEVbXJUD4GInsBRomQCPo+ce1XCZAT7dqo2WfJkB6htt+FeImQKVVTFrFJCdA0SS9NXVnJ0D88y0RJaonQCjDnuzU7CdAU5IPyIQvKEB/YYCjNHIoQKow8X7ktChA1f9hWpT3KEABz9I1RDopQCyeQxH0fClAWG207KO/KUCDPCXIUwIqQK8LlqMDRSpA2toGf7OHKkAFqndaY8oqQDF56DUTDStAXEhZEcNPK0CIF8rscpIrQLPmOsgi1StA3rWro9IXLEAKhRx/glosQDVUjVoynSxAYCP+NeLfLEA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"S97OZ0IvkD+hktdYKYSQP1/SwGJV5o8/NAq2WNskjT/eEnIJM/CIP4Iy2OqqdIM/rV6X5SK9eT80Pr9c1GhlPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKcXvzW+LoU/g4IYMJUbmT8d/4KFZr+kP/rQTPOW660/KURxv7cOtD++fYcoVK+5P4WDVkl71b8/9uxa0nI9wz854UsIn8zGP0A/d7EXlco/uyfWOLKTzj+43bAEomLRP4uNCUdRk9M/sLPxmFHa1T+E4OWvDTbYP2ikYkHwpNo/rI/kAmQl3T+6Muip07XfP/YO9fVUKuE/ynAzvyiA4j8Rh22LmtvjP+yZYbXfO+U/lvHNly2g5j8z1nCNuQfoP/SPCPG4cek/D2dTHWHd6j+oow9t50nsP/SN+zqBtu0/Gm7V4WMi7z8UHBdzYUbwP3koQsdT+vA/BcehcXis8T9pOFULPlzyP2O9ey0TCfM/qpY0cWay8z/2BJ9vplf0P/1I2sFB+PQ/dqMFAaeT9T8bVUDGRCn2P6KeqaqJuPY/wsBgR+RA9z81/IQ1w8H3P7GRNQ6VOvg/8cGRasiq+D+nzbjjyxH5P4/1yRIOb/k/XXrkkP3B+T/OnCf3CAr6P5adst6eRvo/a72k4C13+j8IPR2WJJv6PyJdO5jxsfo/dl4egAO7+j/+tsRnybX6P8HaClzZofo/0Rcdbwt/+j/ARE4YPk36Pw448c5PDPo/RchYCh+8+T/ry9dBilz5P4kZwexv7fg/qIdngq5u+D/L7B16JOD3P34fN0uwQfc/R/YFbTCT9j+uR91Wg9T1PzjqD4CHBfU/c7TwXxsm9D8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1628"},"selection_policy":{"id":"1629"}},"id":"1614","type":"ColumnDataSource"},{"attributes":{"data_source":{"id":"1609"},"glyph":{"id":"1610"},"hover_glyph":null,"muted_glyph":null,"name":"versicolor","nonselection_glyph":{"id":"1611"},"selection_glyph":null,"view":{"id":"1613"}},"id":"1612","type":"GlyphRenderer"},{"attributes":{"line_alpha":0.1,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1611","type":"Line"},{"attributes":{"source":{"id":"1614"}},"id":"1618","type":"CDSView"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto"},"id":"1603","type":"Toolbar"},{"attributes":{"label":{"value":"versicolor"},"renderers":[{"id":"1612"}]},"id":"1642","type":"LegendItem"},{"attributes":{"data":{"x":{"__ndarray__":"ryzwygKv+D8KpnamgcT6P2Yf/YEA2vw/wZiDXX/v/j8OCYUcf4IAQLxFSIo+jQFAaoIL+P2XAkAXv85lvaIDQMX7kdN8rQRAcjhVQTy4BUAgdRiv+8IGQM6x2xy7zQdAfO6einrYCEAqK2L4OeMJQNdnJWb57QpAhaTo07j4C0Ay4atBeAMNQOAdb683Dg5AjloyHfcYD0Cey3pF2xEQQPVpXPw6lxBASwg+s5ocEUCiph9q+qERQPlEASFaJxJAUOPi17msEkCngcSOGTITQP4fpkV5txNAVb6H/Ng8FECrXGmzOMIUQAL7SmqYRxVAWZksIfjMFUCwNw7YV1IWQAfW74631xZAXnTRRRddF0C1ErP8duIXQAyxlLPWZxhAYk92ajbtGEC57VchlnIZQBCMOdj19xlAZyobj1V9GkC+yPxFtQIbQBVn3vwUiBtAawXAs3QNHEDCo6Fq1JIcQBlCgyE0GB1AcOBk2JOdHUDHfkaP8yIeQB4dKEZTqB5AdLsJ/bItH0DLWeuzErMfQBF8ZjU5HCBAPEvXEOleIEBoGkjsmKEgQJPpuMdI5CBAv7gpo/gmIUDqh5p+qGkhQBVXC1pYrCFAQSZ8NQjvIUBs9ewQuDEiQJjEXexndCJAw5POxxe3IkDuYj+jx/kiQBoysH53PCNARgEhWid/I0Bx0JE118EjQJyfAhGHBCRAyG5z7DZHJEDzPeTH5okkQB8NVaOWzCRAStzFfkYPJUB2qzZa9lElQKF6pzWmlCVAzEkYEVbXJUD4GInsBRomQCPo+ce1XCZAT7dqo2WfJkB6htt+FeImQKVVTFrFJCdA0SS9NXVnJ0D88y0RJaonQCjDnuzU7CdAU5IPyIQvKEB/YYCjNHIoQKow8X7ktChA1f9hWpT3KEABz9I1RDopQCyeQxH0fClAWG207KO/KUCDPCXIUwIqQK8LlqMDRSpA2toGf7OHKkAFqndaY8oqQDF56DUTDStAXEhZEcNPK0CIF8rscpIrQLPmOsgi1StA3rWro9IXLEAKhRx/glosQDVUjVoynSxAYCP+NeLfLEA=","dtype":"float64","order":"little","shape":[100]},"y":{"__ndarray__":"4QmUALT1GUBUrVqjjToWQOBEln6q1xJAPauDwvKRD0AwybA00hQKQMztqfHQLwVALyNll8zaAEAC57CHRRv6P8bR8yligPM/+DX+olSp6z+7rX10sg/iP/ZmfICoJtQ/U36/8IOdvD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL5JbX4nQWU/ESM0P6FYkz/4LLNY6T6gP39bLYcqRKU/tdEDD2L0qD8mxDHU3YerP2hnsrrrNq0/EPCAptk5rj+OxOfQG8auP608saa5864/uDIxol7Jrj9S9sbNfE2uPyDX0TOGhq0/wSSx3ux6rD/cLsTYIjGrPwpFaiyar6k//LYC5MT8pz9O1OwJFR+mP6Dsh6j8HKQ/n08zyu38oT/EmZzytIqfPx5ocIBp+Zo/pKmgUt1Slj99/et99KORPyAGIi4m84k/+7KcZTrBgD+cARUvty9vPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABubRFYH9ZWP4OLm43hXGw/bahE6nVgdj+7NQSY6TZ+P0jQ0xOPzoI/mw1l+DI/hj85bIOlCWOJP3aF/Ea8L4w/ifKdCPSajj9sphoLLU2QP8sWyM3LEZE/Dhc+4iqWkT/cc2PeHtWRP9r5Hlh8yZE/r3VX5RdukT8=","dtype":"float64","order":"little","shape":[100]}},"selected":{"id":"1624"},"selection_policy":{"id":"1625"}},"id":"1604","type":"ColumnDataSource"},{"attributes":{},"id":"1624","type":"Selection"},{"attributes":{"line_alpha":0.6,"line_color":"#fdae61","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1610","type":"Line"},{"attributes":{"items":[{"id":"1630"},{"id":"1642"},{"id":"1654"}],"location":[10,60]},"id":"1655","type":"Legend"},{"attributes":{},"id":"1587","type":"DataRange1d"},{"attributes":{},"id":"1622","type":"BasicTickFormatter"},{"attributes":{"data_source":{"id":"1614"},"glyph":{"id":"1615"},"hover_glyph":null,"muted_glyph":null,"name":"virginica","nonselection_glyph":{"id":"1616"},"selection_glyph":null,"view":{"id":"1618"}},"id":"1617","type":"GlyphRenderer"},{"attributes":{},"id":"1600","type":"BasicTicker"},{"attributes":{"label":{"value":"setosa"},"renderers":[{"id":"1607"}]},"id":"1630","type":"LegendItem"},{"attributes":{"line_alpha":0.6,"line_color":"#74add1","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1605","type":"Line"},{"attributes":{"line_alpha":0.1,"line_color":"#f46d43","line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1616","type":"Line"},{"attributes":{"axis_label":"Probability","formatter":{"id":"1622"},"ticker":{"id":"1600"}},"id":"1599","type":"LinearAxis"}],"root_ids":["1584"]},"title":"Bokeh Application","version":"2.2.1"}};
  var render_items = [{"docid":"8e090b68-a6d3-4d41-8e6e-b4f1eada68a9","root_ids":["1584"],"roots":{"1584":"487832b1-3dbe-4468-9f87-cda06bf96bc1"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>So what if we tried to implement the following rules:</p>
<blockquote>
<div><p>If your petal area is greater than 8.4 <span class="math notranslate nohighlight">\(\text{cm}^2\)</span>, you’re a <em>virginica</em></p>
</div></blockquote>
<blockquote>
<div><p>If your petal area is less than 2.7 <span class="math notranslate nohighlight">\(\text{cm}^2\)</span>, you’re a <em>setosa</em></p>
</div></blockquote>
<blockquote>
<div><p>Otherwise, you’re a <em>versicolor</em></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">area_rules_based_ai_classifier</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">petal_area</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="n">petal_features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">sample</span><span class="p">[</span><span class="n">petal_features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">petal_area</span> <span class="o">&gt;</span> <span class="mf">8.4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;virginica&quot;</span>
    <span class="k">elif</span> <span class="n">petal_area</span> <span class="o">&lt;</span> <span class="mf">2.7</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;setosa&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;versicolor&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Does this rule improve our accuracy?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_right</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">wrong_rows</span><span class="p">,</span> <span class="n">wrong_predictions</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row_id</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">area_rules_based_ai_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="n">prediction</span><span class="p">:</span>
        <span class="n">num_right</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrong_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_id</span><span class="p">)</span>
        <span class="n">wrong_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">num_right</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">{:0.2f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy</span><span class="p">))</span>

<span class="n">wrong_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wrong_rows</span><span class="p">]</span>
<span class="n">wrong_df</span><span class="p">[</span><span class="s2">&quot;predicted class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrong_predictions</span>
<span class="n">wrong_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 96.00%
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>class</th>
      <th>predicted class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>70</th>
      <td>5.9</td>
      <td>3.2</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>versicolor</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>77</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.7</td>
      <td>versicolor</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>106</th>
      <td>4.9</td>
      <td>2.5</td>
      <td>4.5</td>
      <td>1.7</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>119</th>
      <td>6.0</td>
      <td>2.2</td>
      <td>5.0</td>
      <td>1.5</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>133</th>
      <td>6.3</td>
      <td>2.8</td>
      <td>5.1</td>
      <td>1.5</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>134</th>
      <td>6.1</td>
      <td>2.6</td>
      <td>5.6</td>
      <td>1.4</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Not a bad lift from what amounts to just a pretty small change in perspective! One interesting to note is that since our rule has the form (mathematically) of:</p>
<blockquote>
<div><p>If <span class="math notranslate nohighlight">\(\text{petal length}*\text{petal width} &gt; a, ...\)</span></p>
</div></blockquote>
<p>for some value <span class="math notranslate nohighlight">\(a\)</span>, this amount so checking which side of the curve <span class="math notranslate nohighlight">\(y=\frac{a}{x}\)</span> we are in the 2D feature space above. Let’s plot these curves and see what they look like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">petal_features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]):</span>
    <span class="n">scatter_df</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">scatter_df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
    <span class="n">fig_kwargs</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_axis_label&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis</span><span class="p">)]</span> <span class="o">=</span> <span class="n">feature</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">plot_utils</span><span class="o">.</span><span class="n">make_2d_scatter_plot</span><span class="p">(</span><span class="n">scatter_df</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="n">fig_kwargs</span><span class="o">=</span><span class="n">fig_kwargs</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="o">=</span><span class="s2">&quot;top_left&quot;</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">scatter_df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">scatter_df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.7</span><span class="p">,</span> <span class="mf">8.4</span><span class="p">]:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">threshold</span> <span class="o">/</span> <span class="n">x</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">scatter_df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;2 2&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">





<div class="bk-root" id="b2cb06e6-c455-4ec8-bd3f-bfb9ea744add" data-root-id="1775"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
    
  var docs_json = {"7b604dbb-b50a-48b4-a5e9-69dc0fcdf031":{"roots":{"references":[{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1784"}],"center":[{"id":"1787"},{"id":"1791"},{"id":"1806"}],"left":[{"id":"1788"}],"plot_height":500,"plot_width":500,"renderers":[{"id":"1796"},{"id":"1823"},{"id":"1828"}],"title":{"id":"1799"},"toolbar":{"id":"1792"},"x_range":{"id":"1776"},"x_scale":{"id":"1780"},"y_range":{"id":"1778"},"y_scale":{"id":"1782"}},"id":"1775","subtype":"Figure","type":"Plot"},{"attributes":{"text":""},"id":"1799","type":"Title"},{"attributes":{"index":100,"label":{"value":"virginica"},"renderers":[{"id":"1796"}]},"id":"1809","type":"LegendItem"},{"attributes":{"fill_alpha":{"value":0.4},"fill_color":{"field":"color"},"line_alpha":{"value":0.8},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1794","type":"Circle"},{"attributes":{"data_source":{"id":"1820"},"glyph":{"id":"1821"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1822"},"selection_glyph":null,"view":{"id":"1824"}},"id":"1823","type":"GlyphRenderer"},{"attributes":{"callback":null,"renderers":[{"id":"1796"}],"tooltips":[["petal length (cm)","@petal_length_cm"],["petal width (cm)","@petal_width_cm"],["Class","@class"]]},"id":"1818","type":"HoverTool"},{"attributes":{"axis":{"id":"1788"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1791","type":"Grid"},{"attributes":{"source":{"id":"1820"}},"id":"1824","type":"CDSView"},{"attributes":{"line_alpha":0.9,"line_color":"#000000","line_dash":[2,2],"line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1826","type":"Line"},{"attributes":{"data":{"class":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"color":["#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"petal_length_cm":{"__ndarray__":"ZmZmZmZm9j9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D9mZmZmZmb2PzMzMzMzM/s/ZmZmZmZm9j8AAAAAAAD4P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P5qZmZmZmfk/ZmZmZmZm9j+amZmZmZnxPzMzMzMzM/M/AAAAAAAA+D/NzMzMzMz0P2ZmZmZmZvY/MzMzMzMz+z8AAAAAAAD4PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwPzMzMzMzM/s/ZmZmZmZm/j+amZmZmZn5P5qZmZmZmfk/AAAAAAAA+D9mZmZmZmb2P5qZmZmZmfk/mpmZmZmZ+T8AAAAAAAD4PwAAAAAAAPg/ZmZmZmZm9j8AAAAAAAD4PzMzMzMzM/M/zczMzMzM9D9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P83MzMzMzPQ/zczMzMzM9D+amZmZmZn5P2ZmZmZmZv4/ZmZmZmZm9j+amZmZmZn5P2ZmZmZmZvY/AAAAAAAA+D9mZmZmZmb2P83MzMzMzBJAAAAAAAAAEkCamZmZmZkTQAAAAAAAABBAZmZmZmZmEkAAAAAAAAASQM3MzMzMzBJAZmZmZmZmCkBmZmZmZmYSQDMzMzMzMw9AAAAAAAAADEDNzMzMzMwQQAAAAAAAABBAzczMzMzMEkDNzMzMzMwMQJqZmZmZmRFAAAAAAAAAEkBmZmZmZmYQQAAAAAAAABJAMzMzMzMzD0AzMzMzMzMTQAAAAAAAABBAmpmZmZmZE0DNzMzMzMwSQDMzMzMzMxFAmpmZmZmZEUAzMzMzMzMTQAAAAAAAABRAAAAAAAAAEkAAAAAAAAAMQGZmZmZmZg5AmpmZmZmZDUAzMzMzMzMPQGZmZmZmZhRAAAAAAAAAEkAAAAAAAAASQM3MzMzMzBJAmpmZmZmZEUBmZmZmZmYQQAAAAAAAABBAmpmZmZmZEUBmZmZmZmYSQAAAAAAAABBAZmZmZmZmCkDNzMzMzMwQQM3MzMzMzBBAzczMzMzMEEAzMzMzMzMRQAAAAAAAAAhAZmZmZmZmEEAAAAAAAAAYQGZmZmZmZhRAmpmZmZmZF0BmZmZmZmYWQDMzMzMzMxdAZmZmZmZmGkAAAAAAAAASQDMzMzMzMxlAMzMzMzMzF0BmZmZmZmYYQGZmZmZmZhRAMzMzMzMzFUAAAAAAAAAWQAAAAAAAABRAZmZmZmZmFEAzMzMzMzMVQAAAAAAAABZAzczMzMzMGkCamZmZmZkbQAAAAAAAABRAzczMzMzMFkCamZmZmZkTQM3MzMzMzBpAmpmZmZmZE0DNzMzMzMwWQAAAAAAAABhAMzMzMzMzE0CamZmZmZkTQGZmZmZmZhZAMzMzMzMzF0BmZmZmZmYYQJqZmZmZmRlAZmZmZmZmFkBmZmZmZmYUQGZmZmZmZhZAZmZmZmZmGEBmZmZmZmYWQAAAAAAAABZAMzMzMzMzE0CamZmZmZkVQGZmZmZmZhZAZmZmZmZmFEBmZmZmZmYUQJqZmZmZmRdAzczMzMzMFkDNzMzMzMwUQAAAAAAAABRAzczMzMzMFECamZmZmZkVQGZmZmZmZhRA","dtype":"float64","order":"little","shape":[150]},"petal_width_cm":{"__ndarray__":"mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZm5P5qZmZmZmck/mpmZmZmZ2T+amZmZmZnZPzMzMzMzM9M/MzMzMzMz0z8zMzMzMzPTP5qZmZmZmck/mpmZmZmZ2T+amZmZmZnJPwAAAAAAAOA/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnZP5qZmZmZmbk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZm5P5qZmZmZmck/mpmZmZmZyT8zMzMzMzPTPzMzMzMzM9M/mpmZmZmZyT8zMzMzMzPjP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P5qZmZmZmfk/AAAAAAAA8D/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAPA/ZmZmZmZm9j/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAADwPwAAAAAAAPg/mpmZmZmZ8T/NzMzMzMz8P83MzMzMzPQ/AAAAAAAA+D8zMzMzMzPzP83MzMzMzPQ/ZmZmZmZm9j9mZmZmZmb2PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwP5qZmZmZmfE/AAAAAAAA8D8zMzMzMzPzP5qZmZmZmfk/AAAAAAAA+D+amZmZmZn5PwAAAAAAAPg/zczMzMzM9D/NzMzMzMz0P83MzMzMzPQ/MzMzMzMz8z9mZmZmZmb2PzMzMzMzM/M/AAAAAAAA8D/NzMzMzMz0PzMzMzMzM/M/zczMzMzM9D/NzMzMzMz0P5qZmZmZmfE/zczMzMzM9D8AAAAAAAAEQGZmZmZmZv4/zczMzMzMAEDNzMzMzMz8P5qZmZmZmQFAzczMzMzMAEAzMzMzMzP7P83MzMzMzPw/zczMzMzM/D8AAAAAAAAEQAAAAAAAAABAZmZmZmZm/j/NzMzMzMwAQAAAAAAAAABAMzMzMzMzA0BmZmZmZmYCQM3MzMzMzPw/mpmZmZmZAUBmZmZmZmYCQAAAAAAAAPg/ZmZmZmZmAkAAAAAAAAAAQAAAAAAAAABAzczMzMzM/D/NzMzMzMwAQM3MzMzMzPw/zczMzMzM/D/NzMzMzMz8P83MzMzMzABAmpmZmZmZ+T9mZmZmZmb+PwAAAAAAAABAmpmZmZmZAUAAAAAAAAD4P2ZmZmZmZvY/ZmZmZmZmAkAzMzMzMzMDQM3MzMzMzPw/zczMzMzM/D/NzMzMzMwAQDMzMzMzMwNAZmZmZmZmAkBmZmZmZmb+P2ZmZmZmZgJAAAAAAAAABEBmZmZmZmYCQGZmZmZmZv4/AAAAAAAAAEBmZmZmZmYCQM3MzMzMzPw/","dtype":"float64","order":"little","shape":[150]},"x":{"__ndarray__":"ZmZmZmZm9j9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D9mZmZmZmb2PzMzMzMzM/s/ZmZmZmZm9j8AAAAAAAD4P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P5qZmZmZmfk/ZmZmZmZm9j+amZmZmZnxPzMzMzMzM/M/AAAAAAAA+D/NzMzMzMz0P2ZmZmZmZvY/MzMzMzMz+z8AAAAAAAD4PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwPzMzMzMzM/s/ZmZmZmZm/j+amZmZmZn5P5qZmZmZmfk/AAAAAAAA+D9mZmZmZmb2P5qZmZmZmfk/mpmZmZmZ+T8AAAAAAAD4PwAAAAAAAPg/ZmZmZmZm9j8AAAAAAAD4PzMzMzMzM/M/zczMzMzM9D9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P83MzMzMzPQ/zczMzMzM9D+amZmZmZn5P2ZmZmZmZv4/ZmZmZmZm9j+amZmZmZn5P2ZmZmZmZvY/AAAAAAAA+D9mZmZmZmb2P83MzMzMzBJAAAAAAAAAEkCamZmZmZkTQAAAAAAAABBAZmZmZmZmEkAAAAAAAAASQM3MzMzMzBJAZmZmZmZmCkBmZmZmZmYSQDMzMzMzMw9AAAAAAAAADEDNzMzMzMwQQAAAAAAAABBAzczMzMzMEkDNzMzMzMwMQJqZmZmZmRFAAAAAAAAAEkBmZmZmZmYQQAAAAAAAABJAMzMzMzMzD0AzMzMzMzMTQAAAAAAAABBAmpmZmZmZE0DNzMzMzMwSQDMzMzMzMxFAmpmZmZmZEUAzMzMzMzMTQAAAAAAAABRAAAAAAAAAEkAAAAAAAAAMQGZmZmZmZg5AmpmZmZmZDUAzMzMzMzMPQGZmZmZmZhRAAAAAAAAAEkAAAAAAAAASQM3MzMzMzBJAmpmZmZmZEUBmZmZmZmYQQAAAAAAAABBAmpmZmZmZEUBmZmZmZmYSQAAAAAAAABBAZmZmZmZmCkDNzMzMzMwQQM3MzMzMzBBAzczMzMzMEEAzMzMzMzMRQAAAAAAAAAhAZmZmZmZmEEAAAAAAAAAYQGZmZmZmZhRAmpmZmZmZF0BmZmZmZmYWQDMzMzMzMxdAZmZmZmZmGkAAAAAAAAASQDMzMzMzMxlAMzMzMzMzF0BmZmZmZmYYQGZmZmZmZhRAMzMzMzMzFUAAAAAAAAAWQAAAAAAAABRAZmZmZmZmFEAzMzMzMzMVQAAAAAAAABZAzczMzMzMGkCamZmZmZkbQAAAAAAAABRAzczMzMzMFkCamZmZmZkTQM3MzMzMzBpAmpmZmZmZE0DNzMzMzMwWQAAAAAAAABhAMzMzMzMzE0CamZmZmZkTQGZmZmZmZhZAMzMzMzMzF0BmZmZmZmYYQJqZmZmZmRlAZmZmZmZmFkBmZmZmZmYUQGZmZmZmZhZAZmZmZmZmGEBmZmZmZmYWQAAAAAAAABZAMzMzMzMzE0CamZmZmZkVQGZmZmZmZhZAZmZmZmZmFEBmZmZmZmYUQJqZmZmZmRdAzczMzMzMFkDNzMzMzMwUQAAAAAAAABRAzczMzMzMFECamZmZmZkVQGZmZmZmZhRA","dtype":"float64","order":"little","shape":[150]},"y":{"__ndarray__":"mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZm5P5qZmZmZmck/mpmZmZmZ2T+amZmZmZnZPzMzMzMzM9M/MzMzMzMz0z8zMzMzMzPTP5qZmZmZmck/mpmZmZmZ2T+amZmZmZnJPwAAAAAAAOA/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnZP5qZmZmZmbk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZm5P5qZmZmZmck/mpmZmZmZyT8zMzMzMzPTPzMzMzMzM9M/mpmZmZmZyT8zMzMzMzPjP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P5qZmZmZmfk/AAAAAAAA8D/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAPA/ZmZmZmZm9j/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAADwPwAAAAAAAPg/mpmZmZmZ8T/NzMzMzMz8P83MzMzMzPQ/AAAAAAAA+D8zMzMzMzPzP83MzMzMzPQ/ZmZmZmZm9j9mZmZmZmb2PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwP5qZmZmZmfE/AAAAAAAA8D8zMzMzMzPzP5qZmZmZmfk/AAAAAAAA+D+amZmZmZn5PwAAAAAAAPg/zczMzMzM9D/NzMzMzMz0P83MzMzMzPQ/MzMzMzMz8z9mZmZmZmb2PzMzMzMzM/M/AAAAAAAA8D/NzMzMzMz0PzMzMzMzM/M/zczMzMzM9D/NzMzMzMz0P5qZmZmZmfE/zczMzMzM9D8AAAAAAAAEQGZmZmZmZv4/zczMzMzMAEDNzMzMzMz8P5qZmZmZmQFAzczMzMzMAEAzMzMzMzP7P83MzMzMzPw/zczMzMzM/D8AAAAAAAAEQAAAAAAAAABAZmZmZmZm/j/NzMzMzMwAQAAAAAAAAABAMzMzMzMzA0BmZmZmZmYCQM3MzMzMzPw/mpmZmZmZAUBmZmZmZmYCQAAAAAAAAPg/ZmZmZmZmAkAAAAAAAAAAQAAAAAAAAABAzczMzMzM/D/NzMzMzMwAQM3MzMzMzPw/zczMzMzM/D/NzMzMzMz8P83MzMzMzABAmpmZmZmZ+T9mZmZmZmb+PwAAAAAAAABAmpmZmZmZAUAAAAAAAAD4P2ZmZmZmZvY/ZmZmZmZmAkAzMzMzMzMDQM3MzMzMzPw/zczMzMzM/D/NzMzMzMwAQDMzMzMzMwNAZmZmZmZmAkBmZmZmZmb+P2ZmZmZmZgJAAAAAAAAABEBmZmZmZmYCQGZmZmZmZv4/AAAAAAAAAEBmZmZmZmYCQM3MzMzMzPw/","dtype":"float64","order":"little","shape":[150]}},"selected":{"id":"1804"},"selection_policy":{"id":"1805"}},"id":"1774","type":"ColumnDataSource"},{"attributes":{"data_source":{"id":"1825"},"glyph":{"id":"1826"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1827"},"selection_glyph":null,"view":{"id":"1829"}},"id":"1828","type":"GlyphRenderer"},{"attributes":{},"id":"1780","type":"LinearScale"},{"attributes":{},"id":"1802","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.1,"line_color":"#000000","line_dash":[2,2],"line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1827","type":"Line"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"color"},"line_alpha":{"value":0.1},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1795","type":"Circle"},{"attributes":{"source":{"id":"1825"}},"id":"1829","type":"CDSView"},{"attributes":{"index":0,"label":{"value":"setosa"},"renderers":[{"id":"1796"}]},"id":"1807","type":"LegendItem"},{"attributes":{},"id":"1776","type":"DataRange1d"},{"attributes":{"data":{"x":{"__ndarray__":"PgcuyTXo8T/cCsWtUNzyP3sOXJJr0PM/GhLzdobE9D+5FYpbobj1P1gZIUC8rPY/9hy4JNeg9z+VIE8J8pT4PzQk5u0Mifk/0id90id9+j9yKxS3QnH7PxAvq5tdZfw/rzJCgHhZ/T9ONtlkk03+P+w5cEmuQf8/xp4Dl+QaAECVIE8J8pQAQGSimnv/DgFANCTm7QyJAUADpjFgGgMCQNInfdInfQJAoqnIRDX3AkByKxS3QnEDQEGtXylQ6wNAEC+rm11lBEDgsPYNa98EQK8yQoB4WQVAfrSN8oXTBUBONtlkk00GQB24JNegxwZA7DlwSa5BB0C8u7u7u7sHQIs9By7JNQhAW79SoNavCEAqQZ4S5CkJQPnC6YTxowlAyUQ19/4dCkCYxoBpDJgKQGhIzNsZEgtAN8oXTieMC0AGTGPANAYMQNbNrjJCgAxApU/6pE/6DEB10UUXXXQNQERTkYlq7g1AE9Xc+3doDkDjVihuheIOQLLYc+CSXA9Aglq/UqDWD0AoboXiVigQQBAvq5tdZRBA+O/QVGSiEEDgsPYNa98QQMdxHMdxHBFArzJCgHhZEUCW82c5f5YRQH60jfKF0xFAZnWzq4wQEkBONtlkk00SQDb3/h2aihJAHbgk16DHEkAFeUqQpwQTQOw5cEmuQRNA1PqVArV+E0C8u7u7u7sTQKR84XTC+BNAiz0HLsk1FEBz/iznz3IUQFu/UqDWrxRAQoB4Wd3sFEAqQZ4S5CkVQBICxMvqZhVA+cLphPGjFUDhgw8++OAVQMlENff+HRZAsQVbsAVbFkCYxoBpDJgWQICHpiIT1RZAaEjM2xkSF0BPCfKUIE8XQDfKF04njBdAH4s9By7JF0AGTGPANAYYQO4MiXk7QxhA1s2uMkKAGEC9jtTrSL0YQKVP+qRP+hhAjRAgXlY3GUB10UUXXXQZQFySa9BjsRlARFORiWruGUAsFLdCcSsaQBPV3Pt3aBpA+5UCtX6lGkDjVihuheIaQMoXTieMHxtAsthz4JJcG0CamZmZmZkbQA==","dtype":"float64","order":"little","shape":[98]},"y":{"__ndarray__":"GxcLJLVMA0D3NVaZ61ICQAVRZq8scQFAKaQopCikAEAlSZIkSdL/P0gcn0i2e/4/JJTbt8lA/T9vX1m9Sx78P4oEC61/Efs/7h62vg0Y+j/d0ciG8S/5P+AAQvdrV/g/k+oQG/iM9z9z1xLyQc/2Pw2wYfkeHfY//XMxB4h19T96DeU1lNf0P8XSSql0QvQ/kaJ7BHG18z9bSKJv5C/zPxU7sRM7sfI/sCJG9+848j+hxAwsi8bxPxOpJD+gWfE/qHWS4czx8D+z6ca/t47wP8I/34APMPA/svoXzxOr7z+wSyofxv3uP2c0lYe5V+4/XeO+0Xu47T/Sj370ox/tP9c8xizRjOw/G+YaMar/6z+v8kx83HfrPwYtaqwb9eo/waRT8yB36j8pwsCWqv3pP2asyH17iOk/u4xOyloX6T+6T+Z8E6roPxEE+CF0QOg/rUYRh07a5z93d3d3d3fnPyuuK3/GF+c/ol6rsxW75j9d+M6BQWHmPzAaO4AoCuY/E6bpRau15T/WfF5ErGPlP5c/KKUPFOU/8mtYKrvG5D9huacRlnvkP1j9A/qIMuQ/IDFMy33r4z9SpQWgX6bjP9YY27AaY+M/sme7QZwh4z+x7XGQ0uHiP/2elsSso+I/Oky34Bpn4j+9l560DSziPzDan9B28uE/0aDReUi64T83mCKfdYPhP46jNs/xTeE/PJn7LrEZ4T9xqOZwqObgP83MzMzMtOA/qPJJ+BOE4D/hi6sfdFTgP6RVVN/jJeA/pu0fe7Tw3z+I3ptJnZffP7EYeLxxQN8/T4NyGSLr3j/7vDRQn5feP0FJdfHaRd4/l4alJsf13T+qWCKqVqfdP9ND3r98Wt0/t3R8Li0P3T8Z3NQ4XMXcP8Ak2pf+fNw/gNnadAk23D+jlBdkcvDbP3uKqF8vrNs/uS6twjZp2z/eGMFEfyfbP3uosfX/5to/jD5wObCn2j8TLz3Eh2naP2PVB5d+LNo/P3cA/Izw2T9031iDq7XZPxHQMADTe9k/1Z+rhfxC2T+RhSxkIQvZPw==","dtype":"float64","order":"little","shape":[98]}},"selected":{"id":"1901"},"selection_policy":{"id":"1902"}},"id":"1820","type":"ColumnDataSource"},{"attributes":{},"id":"1902","type":"UnionRenderers"},{"attributes":{"index":50,"label":{"value":"versicolor"},"renderers":[{"id":"1796"}]},"id":"1808","type":"LegendItem"},{"attributes":{},"id":"1778","type":"DataRange1d"},{"attributes":{"line_alpha":0.1,"line_color":"#000000","line_dash":[2,2],"line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1822","type":"Line"},{"attributes":{},"id":"1904","type":"UnionRenderers"},{"attributes":{},"id":"1804","type":"Selection"},{"attributes":{},"id":"1782","type":"LinearScale"},{"attributes":{"items":[{"id":"1807"},{"id":"1808"},{"id":"1809"}],"location":"top_left"},"id":"1806","type":"Legend"},{"attributes":{},"id":"1903","type":"Selection"},{"attributes":{"axis_label":"petal length (cm)","formatter":{"id":"1800"},"ticker":{"id":"1785"}},"id":"1784","type":"LinearAxis"},{"attributes":{"data":{"x":{"__ndarray__":"aEjM2xkSC0A3yhdOJ4wLQAZMY8A0BgxA1s2uMkKADEClT/qkT/oMQHXRRRdddA1ARFORiWruDUAT1dz7d2gOQONWKG6F4g5Asthz4JJcD0CCWr9SoNYPQChuheJWKBBAEC+rm11lEED479BUZKIQQOCw9g1r3xBAx3Ecx3EcEUCvMkKAeFkRQJbzZzl/lhFAfrSN8oXTEUBmdbOrjBASQE422WSTTRJANvf+HZqKEkAduCTXoMcSQAV5SpCnBBNA7DlwSa5BE0DU+pUCtX4TQLy7u7u7uxNApHzhdML4E0CLPQcuyTUUQHP+LOfPchRAW79SoNavFEBCgHhZ3ewUQCpBnhLkKRVAEgLEy+pmFUD5wumE8aMVQOGDDz744BVAyUQ19/4dFkCxBVuwBVsWQJjGgGkMmBZAgIemIhPVFkBoSMzbGRIXQE8J8pQgTxdAN8oXTieMF0Afiz0HLskXQAZMY8A0BhhA7gyJeTtDGEDWza4yQoAYQL2O1OtIvRhApU/6pE/6GECNECBeVjcZQHXRRRdddBlAXJJr0GOxGUBEU5GJau4ZQCwUt0JxKxpAE9Xc+3doGkD7lQK1fqUaQONWKG6F4hpAyhdOJ4wfG0Cy2HPgklwbQJqZmZmZmRtA","dtype":"float64","order":"little","shape":[60]},"y":{"__ndarray__":"wTBjRe7bA0CRNARI8YMDQAI+erbyLgNAYpFrGszcAkD4Nn+FWY0CQAck61x5QAJAd4cFKgz2AUAMZkxv9K0BQIEWaIEWaAFA0DC8Y1gkAUArgSeooeIAQN/SnlHbogBAdjFYue9kAEC8xUR2yigAQAjLPY2w3P8/bN+w9g1r/z9OhXbKivz+Pw06JYcGkf4/FENxaGIo/j+GL85JgcL9P4TjW4tHX/0/pUzq+Jr+/D+wPeSyYqD8Pyaz9hiHRPw/Ev5NtvHq+z+bFkYvjZP7P+SzbjBFPvs/h8XGXgbr+j8HmRVJvpn6P1pbSlpbSvo/zMzMzMz8+T8+66ueArH5P3oSmYbtZvk/qaGf6X4e+T9lnIrRqNf4P2kC6+Ndkvg/372yWZFO+D/LEFn3Ngz4PxlafgVDy/c/pOMFSqqL9z/LL50BYk33P6HvqNlfEPc/pG2Q6pnU9j+OzGCyBpr2P4UAwg+dYPY/suM3PVQo9j9jN6rMI/H1P/DILqMDu/U/Q08R9euF9T9z6xRC1VH1Px6F61G4HvU/CoPfMI7s9D9soqwsULv0P7nrhNH3ivQ/Tfs+535b9D9qB6tu3yz0PwQ8DJ8T//M/DTC04xXS8z/eX77Z4KXzPzi96U1vevM/","dtype":"float64","order":"little","shape":[60]}},"selected":{"id":"1903"},"selection_policy":{"id":"1904"}},"id":"1825","type":"ColumnDataSource"},{"attributes":{},"id":"1901","type":"Selection"},{"attributes":{},"id":"1800","type":"BasicTickFormatter"},{"attributes":{},"id":"1785","type":"BasicTicker"},{"attributes":{},"id":"1805","type":"UnionRenderers"},{"attributes":{"data_source":{"id":"1774"},"glyph":{"id":"1794"},"hover_glyph":null,"muted_glyph":null,"name":"scatter","nonselection_glyph":{"id":"1795"},"selection_glyph":null,"view":{"id":"1797"}},"id":"1796","type":"GlyphRenderer"},{"attributes":{"axis":{"id":"1784"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1787","type":"Grid"},{"attributes":{"line_alpha":0.9,"line_color":"#000000","line_dash":[2,2],"line_width":2.3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1821","type":"Line"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"1818"}]},"id":"1792","type":"Toolbar"},{"attributes":{},"id":"1789","type":"BasicTicker"},{"attributes":{"axis_label":"petal width (cm)","formatter":{"id":"1802"},"ticker":{"id":"1789"}},"id":"1788","type":"LinearAxis"},{"attributes":{"source":{"id":"1774"}},"id":"1797","type":"CDSView"}],"root_ids":["1775"]},"title":"Bokeh Application","version":"2.2.1"}};
  var render_items = [{"docid":"7b604dbb-b50a-48b4-a5e9-69dc0fcdf031","root_ids":["1775"],"roots":{"1775":"b2cb06e6-c455-4ec8-bd3f-bfb9ea744add"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>What I like about this view is that it shows us very clearly which samples we misclassified and <em>why</em> we misclassified them. More importantly, I think it illustrates the cross-section of what we’re doing here both mathematically and philosophically.</p>
<p>For this particular classification rule, we decided that this 2D <strong>slice</strong> of the full 4D feature space (both petal and sepal measurements) can be neatly divided by two curves of the form
<span class="math notranslate nohighlight">\($ \text{petal width}\ =\ \frac{a_i}{\text{petal length}}, i \in \{0, 1\} \text{,}\)</span>$
with categories assigned depending on which <em>side</em> of the curves a sample falls. The values <span class="math notranslate nohighlight">\(a_i\)</span> are called <strong>parameters</strong> of these family of curves. This reduced the problem to finding the <em>best</em> values <span class="math notranslate nohighlight">\(a_i\)</span> such that we classified our samples as well as possible. And how did we find these best values? We looked at the distributions for the feature <span class="math notranslate nohighlight">\(\text{petal length}*\text{petal width}\)</span> and manually picked values that looked good.</p>
<p>We could, of course, have picked another form for the curves that divide up this subspace, and then tried to find the best <em>particular</em> curves that fit that form for our data. But we picked this one. Why? Well, it seemed natural and solvable and, frankly, it worked pretty well. So why not?</p>
<p>Of course, we still haven’t even used our sepal measurements. Surely those could add something to the picture. What if we came up with families of curves in the full 4 dimensional space and found which of their members best separated the data? But how would we do that, since we can’t <em>view</em> the data in the 4D space? Well, we could try to reduce those curves to some 1D distribution like we did above and manually find the cut points. But we relied on some hand-wavy intuition to come up with that “area” feature above, and I for one certainly don’t know enough about botany to come up with something that represents information from all four features at once.</p>
<p>Perhaps more importantly, what would this exercise do that might help us on any other problem we might want to solve down the line? Sure, right now irises and their petals and sepals are all we care about, but maybe we’ll have a project down the road involving other flowers or plants, maybe ones without petals at all. Maybe we’ll stop caring about botany altogether and start applying machine learning to some new field entirely. What good will these insights about the information contained in sepal and petal measurements do us then? We’ll have to start completely from scratch and repeat the whole process!</p>
<p>What would be ideal for us would be if there was some way to automatically reduce <em>any</em> dataset down to fewer dimensions in some way that retained information about the <em>structure</em> of the dataset in the original space. Such a tool would not only help us visualize and build rules for <em>this</em> dataset, but would (with enormous caveats) help with making rules for any <em>other</em> dataset as well. Our job would then be reduced to finding good rules in this 2D space, rather than laboriously trying different curves and feature combinations to see if they work or not.</p>
<p>Luckily, there’s a great off-the-shelf statistical tool for building these reduced representations called <a class="reference external" href="https://en.wikipedia.org/wiki/Principal_component_analysis">Principal Component Analysis</a> (PCA). We’ll <strong>transform</strong> our data using PCA, then visualize it and try to come up with a new and better rule for classification.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eig</span>


<span class="k">def</span> <span class="nf">principal_component_analysis</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    simple PCA implementation using eigenvectors of the </span>
<span class="sd">    normalized X^T X matrix</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># X is a 150 x 4 matrix corresponding to our measurements</span>
    <span class="c1"># STEP 1:</span>
    <span class="c1"># &quot;normalize&quot; the data: center each feature at 0 w/ standard dev. of 1</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">X</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># STEP 2:</span>
    <span class="c1"># take the eigenvalues and eigenvectors of matrix product X^T X</span>
    <span class="c1"># note that this makes X^T X real and symmetric, so eigenvectors are real</span>
    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="o">.</span><span class="n">real</span>

    <span class="c1"># STEP 3:</span>
    <span class="c1"># make a matrix whose rows are the top n eigenvectors</span>
    <span class="c1"># (i.e. the ones corresponding to the n largest eignvalues)</span>
    <span class="n">top_n_eigenvalue_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)[:</span><span class="n">n_components</span><span class="p">]</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[</span><span class="n">top_n_eigenvalue_indices</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># 2 x 4 matrix</span>

    <span class="c1"># STEP 4:</span>
    <span class="c1"># map X down to the 2D space using this matrix transformation</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">W</span><span class="o">.</span><span class="n">T</span> <span class="c1"># (150 x 4)(4 x 2) -&gt; (150 x 2)</span>

    <span class="c1"># This is just a little convenience thing I&#39;m doing for</span>
    <span class="c1"># plotting to assign these values to the x and y axes,</span>
    <span class="c1"># it has nothing to do with PCA</span>
    <span class="k">if</span> <span class="n">n_components</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>

    <span class="c1"># return both the transformed data, as well as the matrix</span>
    <span class="c1"># we used to make the transformation, in case we feel like</span>
    <span class="c1"># using it to transform anything else (like, say, new samples</span>
    <span class="c1"># that we encounter when we deploy our system &quot;in production&quot;)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">W</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">]</span>
<span class="n">X_2d</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">principal_component_analysis</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_2d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_2d</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;PCA Transformed Data&quot;</span><span class="p">}</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">plot_utils</span><span class="o">.</span><span class="n">make_2d_scatter_plot</span><span class="p">(</span><span class="n">X_2d</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="n">fig_kwargs</span><span class="o">=</span><span class="n">fig_kwargs</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;bottom_left&#39;</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">





<div class="bk-root" id="7a291801-1bb2-4b8b-8f37-2b00529e834e" data-root-id="1966"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
    
  var docs_json = {"a8c8a1cf-50b9-47dc-90e3-91beeb2d773e":{"roots":{"references":[{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1977"}],"center":[{"id":"1980"},{"id":"1984"},{"id":"1998"}],"left":[{"id":"1981"}],"plot_height":500,"plot_width":500,"renderers":[{"id":"1989"}],"title":{"id":"1967"},"toolbar":{"id":"1985"},"x_range":{"id":"1969"},"x_scale":{"id":"1973"},"y_range":{"id":"1971"},"y_scale":{"id":"1975"}},"id":"1966","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1997","type":"UnionRenderers"},{"attributes":{"source":{"id":"1965"}},"id":"1990","type":"CDSView"},{"attributes":{},"id":"1973","type":"LinearScale"},{"attributes":{"index":100,"label":{"value":"virginica"},"renderers":[{"id":"1989"}]},"id":"2001","type":"LegendItem"},{"attributes":{},"id":"1971","type":"DataRange1d"},{"attributes":{},"id":"1982","type":"BasicTicker"},{"attributes":{"data":{"class":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"color":["#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"petal_length_cm":{"__ndarray__":"ZmZmZmZm9j9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D9mZmZmZmb2PzMzMzMzM/s/ZmZmZmZm9j8AAAAAAAD4P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P5qZmZmZmfk/ZmZmZmZm9j+amZmZmZnxPzMzMzMzM/M/AAAAAAAA+D/NzMzMzMz0P2ZmZmZmZvY/MzMzMzMz+z8AAAAAAAD4PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwPzMzMzMzM/s/ZmZmZmZm/j+amZmZmZn5P5qZmZmZmfk/AAAAAAAA+D9mZmZmZmb2P5qZmZmZmfk/mpmZmZmZ+T8AAAAAAAD4PwAAAAAAAPg/ZmZmZmZm9j8AAAAAAAD4PzMzMzMzM/M/zczMzMzM9D9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P83MzMzMzPQ/zczMzMzM9D+amZmZmZn5P2ZmZmZmZv4/ZmZmZmZm9j+amZmZmZn5P2ZmZmZmZvY/AAAAAAAA+D9mZmZmZmb2P83MzMzMzBJAAAAAAAAAEkCamZmZmZkTQAAAAAAAABBAZmZmZmZmEkAAAAAAAAASQM3MzMzMzBJAZmZmZmZmCkBmZmZmZmYSQDMzMzMzMw9AAAAAAAAADEDNzMzMzMwQQAAAAAAAABBAzczMzMzMEkDNzMzMzMwMQJqZmZmZmRFAAAAAAAAAEkBmZmZmZmYQQAAAAAAAABJAMzMzMzMzD0AzMzMzMzMTQAAAAAAAABBAmpmZmZmZE0DNzMzMzMwSQDMzMzMzMxFAmpmZmZmZEUAzMzMzMzMTQAAAAAAAABRAAAAAAAAAEkAAAAAAAAAMQGZmZmZmZg5AmpmZmZmZDUAzMzMzMzMPQGZmZmZmZhRAAAAAAAAAEkAAAAAAAAASQM3MzMzMzBJAmpmZmZmZEUBmZmZmZmYQQAAAAAAAABBAmpmZmZmZEUBmZmZmZmYSQAAAAAAAABBAZmZmZmZmCkDNzMzMzMwQQM3MzMzMzBBAzczMzMzMEEAzMzMzMzMRQAAAAAAAAAhAZmZmZmZmEEAAAAAAAAAYQGZmZmZmZhRAmpmZmZmZF0BmZmZmZmYWQDMzMzMzMxdAZmZmZmZmGkAAAAAAAAASQDMzMzMzMxlAMzMzMzMzF0BmZmZmZmYYQGZmZmZmZhRAMzMzMzMzFUAAAAAAAAAWQAAAAAAAABRAZmZmZmZmFEAzMzMzMzMVQAAAAAAAABZAzczMzMzMGkCamZmZmZkbQAAAAAAAABRAzczMzMzMFkCamZmZmZkTQM3MzMzMzBpAmpmZmZmZE0DNzMzMzMwWQAAAAAAAABhAMzMzMzMzE0CamZmZmZkTQGZmZmZmZhZAMzMzMzMzF0BmZmZmZmYYQJqZmZmZmRlAZmZmZmZmFkBmZmZmZmYUQGZmZmZmZhZAZmZmZmZmGEBmZmZmZmYWQAAAAAAAABZAMzMzMzMzE0CamZmZmZkVQGZmZmZmZhZAZmZmZmZmFEBmZmZmZmYUQJqZmZmZmRdAzczMzMzMFkDNzMzMzMwUQAAAAAAAABRAzczMzMzMFECamZmZmZkVQGZmZmZmZhRA","dtype":"float64","order":"little","shape":[150]},"petal_width_cm":{"__ndarray__":"mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZm5P5qZmZmZmck/mpmZmZmZ2T+amZmZmZnZPzMzMzMzM9M/MzMzMzMz0z8zMzMzMzPTP5qZmZmZmck/mpmZmZmZ2T+amZmZmZnJPwAAAAAAAOA/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnZP5qZmZmZmbk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZm5P5qZmZmZmck/mpmZmZmZyT8zMzMzMzPTPzMzMzMzM9M/mpmZmZmZyT8zMzMzMzPjP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P5qZmZmZmfk/AAAAAAAA8D/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAPA/ZmZmZmZm9j/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAADwPwAAAAAAAPg/mpmZmZmZ8T/NzMzMzMz8P83MzMzMzPQ/AAAAAAAA+D8zMzMzMzPzP83MzMzMzPQ/ZmZmZmZm9j9mZmZmZmb2PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwP5qZmZmZmfE/AAAAAAAA8D8zMzMzMzPzP5qZmZmZmfk/AAAAAAAA+D+amZmZmZn5PwAAAAAAAPg/zczMzMzM9D/NzMzMzMz0P83MzMzMzPQ/MzMzMzMz8z9mZmZmZmb2PzMzMzMzM/M/AAAAAAAA8D/NzMzMzMz0PzMzMzMzM/M/zczMzMzM9D/NzMzMzMz0P5qZmZmZmfE/zczMzMzM9D8AAAAAAAAEQGZmZmZmZv4/zczMzMzMAEDNzMzMzMz8P5qZmZmZmQFAzczMzMzMAEAzMzMzMzP7P83MzMzMzPw/zczMzMzM/D8AAAAAAAAEQAAAAAAAAABAZmZmZmZm/j/NzMzMzMwAQAAAAAAAAABAMzMzMzMzA0BmZmZmZmYCQM3MzMzMzPw/mpmZmZmZAUBmZmZmZmYCQAAAAAAAAPg/ZmZmZmZmAkAAAAAAAAAAQAAAAAAAAABAzczMzMzM/D/NzMzMzMwAQM3MzMzMzPw/zczMzMzM/D/NzMzMzMz8P83MzMzMzABAmpmZmZmZ+T9mZmZmZmb+PwAAAAAAAABAmpmZmZmZAUAAAAAAAAD4P2ZmZmZmZvY/ZmZmZmZmAkAzMzMzMzMDQM3MzMzMzPw/zczMzMzM/D/NzMzMzMwAQDMzMzMzMwNAZmZmZmZmAkBmZmZmZmb+P2ZmZmZmZgJAAAAAAAAABEBmZmZmZmYCQGZmZmZmZv4/AAAAAAAAAEBmZmZmZmYCQM3MzMzMzPw/","dtype":"float64","order":"little","shape":[150]},"sepal_length_cm":{"__ndarray__":"ZmZmZmZmFECamZmZmZkTQM3MzMzMzBJAZmZmZmZmEkAAAAAAAAAUQJqZmZmZmRVAZmZmZmZmEkAAAAAAAAAUQJqZmZmZmRFAmpmZmZmZE0CamZmZmZkVQDMzMzMzMxNAMzMzMzMzE0AzMzMzMzMRQDMzMzMzMxdAzczMzMzMFkCamZmZmZkVQGZmZmZmZhRAzczMzMzMFkBmZmZmZmYUQJqZmZmZmRVAZmZmZmZmFEBmZmZmZmYSQGZmZmZmZhRAMzMzMzMzE0AAAAAAAAAUQAAAAAAAABRAzczMzMzMFEDNzMzMzMwUQM3MzMzMzBJAMzMzMzMzE0CamZmZmZkVQM3MzMzMzBRAAAAAAAAAFkCamZmZmZkTQAAAAAAAABRAAAAAAAAAFkCamZmZmZkTQJqZmZmZmRFAZmZmZmZmFEAAAAAAAAAUQAAAAAAAABJAmpmZmZmZEUAAAAAAAAAUQGZmZmZmZhRAMzMzMzMzE0BmZmZmZmYUQGZmZmZmZhJAMzMzMzMzFUAAAAAAAAAUQAAAAAAAABxAmpmZmZmZGUCamZmZmZkbQAAAAAAAABZAAAAAAAAAGkDNzMzMzMwWQDMzMzMzMxlAmpmZmZmZE0BmZmZmZmYaQM3MzMzMzBRAAAAAAAAAFECamZmZmZkXQAAAAAAAABhAZmZmZmZmGEBmZmZmZmYWQM3MzMzMzBpAZmZmZmZmFkAzMzMzMzMXQM3MzMzMzBhAZmZmZmZmFkCamZmZmZkXQGZmZmZmZhhAMzMzMzMzGUBmZmZmZmYYQJqZmZmZmRlAZmZmZmZmGkAzMzMzMzMbQM3MzMzMzBpAAAAAAAAAGEDNzMzMzMwWQAAAAAAAABZAAAAAAAAAFkAzMzMzMzMXQAAAAAAAABhAmpmZmZmZFUAAAAAAAAAYQM3MzMzMzBpAMzMzMzMzGUBmZmZmZmYWQAAAAAAAABZAAAAAAAAAFkBmZmZmZmYYQDMzMzMzMxdAAAAAAAAAFEBmZmZmZmYWQM3MzMzMzBZAzczMzMzMFkDNzMzMzMwYQGZmZmZmZhRAzczMzMzMFkAzMzMzMzMZQDMzMzMzMxdAZmZmZmZmHEAzMzMzMzMZQAAAAAAAABpAZmZmZmZmHkCamZmZmZkTQDMzMzMzMx1AzczMzMzMGkDNzMzMzMwcQAAAAAAAABpAmpmZmZmZGUAzMzMzMzMbQM3MzMzMzBZAMzMzMzMzF0CamZmZmZkZQAAAAAAAABpAzczMzMzMHkDNzMzMzMweQAAAAAAAABhAmpmZmZmZG0BmZmZmZmYWQM3MzMzMzB5AMzMzMzMzGUDNzMzMzMwaQM3MzMzMzBxAzczMzMzMGEBmZmZmZmYYQJqZmZmZmRlAzczMzMzMHECamZmZmZkdQJqZmZmZmR9AmpmZmZmZGUAzMzMzMzMZQGZmZmZmZhhAzczMzMzMHkAzMzMzMzMZQJqZmZmZmRlAAAAAAAAAGECamZmZmZkbQM3MzMzMzBpAmpmZmZmZG0AzMzMzMzMXQDMzMzMzMxtAzczMzMzMGkDNzMzMzMwaQDMzMzMzMxlAAAAAAAAAGkDNzMzMzMwYQJqZmZmZmRdA","dtype":"float64","order":"little","shape":[150]},"sepal_width_cm":{"__ndarray__":"AAAAAAAADEAAAAAAAAAIQJqZmZmZmQlAzczMzMzMCEDNzMzMzMwMQDMzMzMzMw9AMzMzMzMzC0AzMzMzMzMLQDMzMzMzMwdAzczMzMzMCECamZmZmZkNQDMzMzMzMwtAAAAAAAAACEAAAAAAAAAIQAAAAAAAABBAmpmZmZmZEUAzMzMzMzMPQAAAAAAAAAxAZmZmZmZmDkBmZmZmZmYOQDMzMzMzMwtAmpmZmZmZDUDNzMzMzMwMQGZmZmZmZgpAMzMzMzMzC0AAAAAAAAAIQDMzMzMzMwtAAAAAAAAADEAzMzMzMzMLQJqZmZmZmQlAzczMzMzMCEAzMzMzMzMLQGZmZmZmZhBAzczMzMzMEEDNzMzMzMwIQJqZmZmZmQlAAAAAAAAADEDNzMzMzMwMQAAAAAAAAAhAMzMzMzMzC0AAAAAAAAAMQGZmZmZmZgJAmpmZmZmZCUAAAAAAAAAMQGZmZmZmZg5AAAAAAAAACEBmZmZmZmYOQJqZmZmZmQlAmpmZmZmZDUBmZmZmZmYKQJqZmZmZmQlAmpmZmZmZCUDNzMzMzMwIQGZmZmZmZgJAZmZmZmZmBkBmZmZmZmYGQGZmZmZmZgpAMzMzMzMzA0AzMzMzMzMHQJqZmZmZmQVAAAAAAAAAAEAAAAAAAAAIQJqZmZmZmQFAMzMzMzMzB0AzMzMzMzMHQM3MzMzMzAhAAAAAAAAACECamZmZmZkFQJqZmZmZmQFAAAAAAAAABECamZmZmZkJQGZmZmZmZgZAAAAAAAAABEBmZmZmZmYGQDMzMzMzMwdAAAAAAAAACEBmZmZmZmYGQAAAAAAAAAhAMzMzMzMzB0DNzMzMzMwEQDMzMzMzMwNAMzMzMzMzA0CamZmZmZkFQJqZmZmZmQVAAAAAAAAACEAzMzMzMzMLQM3MzMzMzAhAZmZmZmZmAkAAAAAAAAAIQAAAAAAAAARAzczMzMzMBEAAAAAAAAAIQM3MzMzMzARAZmZmZmZmAkCamZmZmZkFQAAAAAAAAAhAMzMzMzMzB0AzMzMzMzMHQAAAAAAAAARAZmZmZmZmBkBmZmZmZmYKQJqZmZmZmQVAAAAAAAAACEAzMzMzMzMHQAAAAAAAAAhAAAAAAAAACEAAAAAAAAAEQDMzMzMzMwdAAAAAAAAABEDNzMzMzMwMQJqZmZmZmQlAmpmZmZmZBUAAAAAAAAAIQAAAAAAAAARAZmZmZmZmBkCamZmZmZkJQAAAAAAAAAhAZmZmZmZmDkDNzMzMzMwEQJqZmZmZmQFAmpmZmZmZCUBmZmZmZmYGQGZmZmZmZgZAmpmZmZmZBUBmZmZmZmYKQJqZmZmZmQlAZmZmZmZmBkAAAAAAAAAIQGZmZmZmZgZAAAAAAAAACEBmZmZmZmYGQGZmZmZmZg5AZmZmZmZmBkBmZmZmZmYGQM3MzMzMzARAAAAAAAAACEAzMzMzMzMLQM3MzMzMzAhAAAAAAAAACEDNzMzMzMwIQM3MzMzMzAhAzczMzMzMCECamZmZmZkFQJqZmZmZmQlAZmZmZmZmCkAAAAAAAAAIQAAAAAAAAARAAAAAAAAACEAzMzMzMzMLQAAAAAAAAAhA","dtype":"float64","order":"little","shape":[150]},"x":{"__ndarray__":"aEg6srHeAMDrBiki1FgBwHSRfcK5+ALAOwDC5c3RAsAD3suo2YkBwDPVy5iShvu/+wVzyRHtAsB/FrCIWwEBwFu6Qazi8wPAkNFMGGG7AcCHWTxX0mH+vzJ6t1UtzwHAS14lVTZxAsDHY0cveggGwPjBQNBvevy/bRJ7BT2h+r+8z1YyQNP9v4tSWj8DUgDArg/3kNAa+b+Hj4gvymYAwKijt0PCfvy/IMtmDE91/79Q4QJ2/94EwFLBN6b5Ofy/P1wjPGzyAMDH5qn79DkAwOaWfd/RPP+/lIfsPmgJAMDLsqi7iTMAwIBz6aj4GwLA5d1XstBwAcB3Sf1EX3L7vwu2i/jPUgHAJ176XSAY/7+z22ylsi4BwD/MWTU0nwHAYUP0yfDy/b9iNcjbO6ICwMZN6JXsXATA/bSTyKd1AMBdE6iyTCcBwLOJt+VcaALA+rXSAtWbBMCkJ+iAAEn9v8o4xt+JZ/2/kHJlb9lXAcATJjfv4qkAwKWTaM/XOgPAjBx11zl5/7+2QWwFfSsBwL3AOl735PM/OjrB6yCX6j/uznH9K0z1P7NkO5a/kKM/Hn9LIIrj7z9fRfRxj8LRP8a1hXboaew/iTEA3ysC67/SheivFC/tP94MJ8IF+ci/X2+w3WuP5L8kisVtZmvaP+x5wsvpIsg/Yzz2RRqe5T+gbPZQlZHAv/9HpS5OSO4/gVW9N5U41D+Bar9qvxeHPyxSLm2rI+s/W4XM7Ij8uL88mlmyR7jpP/KQyXWjudc/CK6biTE58D/fXcuId7bhP/oBtUhyXuU/WpIICFCX7D8kmtV39UTzPy9HzZsqIvY/S5N5d1dV4z8ZTyXrT3XQvzwO70OY28e/jzCCUu2f0r9okP3YJ6mzPyb7Q8O7ae0/z3rua7L6xj+/WNEB/RLjP6DLOjAG9/E/ntsFMN9I5z9IbJAcvdehP6m+Ct0itX4/kRXbm9YxsT+37luf8vnjP+L+54YyZcA/HNu5BIxV6L/zqWdgKeq9P/+UAZw+/7E/82lT48nBwz/p9dFH1ADhPzmWwlKpYui/eLaQF7IfwT+t0gWCbJL/P3N14CRLpO8/7lqUZuEIAkDYBuVT1o/2P91QMUuHC/4/rt17DXzGBkB1F7wOl/KqP7jtZ5EIwAJA/DA31WwP/T/tGdQRwZ0EQJByKdnMVPc/GEqKYOmE9z9HcvOy3n7+P2zq0taAfe8/K21Fog0S9T8C8PXW0q/6PwxmCYGR7Pc/k/P/P9IsB0BHGcGmHsYJQG+4Jmy/hew/0FzO+MI4AUDqdR186K7qP9kQ1Hr/TQdA0aAGYXcH8z/v88C4FNH9P/bRVxQ3+QBA+LaADfwd8T8u4tUZ7xvwP0H1R/I8Mvs/mR8/ai4X/z+PunaUs2QDQOqs5MAbTgZA/OAH2JlL/D+w8qEPz6LwP30KMwNNuPA/V05hM6D7BkA2hNCVee37P9U65pNBlvY/EMF0Zrji7D95Dt9fMsT+P3FkuW7ogwBABao2+Gk9/z9zdeAkS6TvP++5FJ86QAFAbVHgJ0QbAUDTShLLruD9P5Mb/obQMfU/mgFhGcll+D81WBJjXpb4P9ayU8ztJu4/","dtype":"float64","order":"little","shape":[150]},"y":{"__ndarray__":"+MwaN/ko1D99atFd/PjJP9Qzn5ROPaY/YRQ914M2dL9NuaPvBqHOP1snhYNGRNQ/B+kPVERHwb8kBGd3jIzQP3OgGlDcKsK/nELvBQbf0z9LfhV/+bTgP+WV1PBTL8A/IDtrFY91zj+0neTs3n3Bv2AV03XPXeg/kjaRflXl3j8Db3kMozTSP+0h3FmU3Mo/ej3dVBto5D/hUeuvBbzJP3AXNnb6wuE/lSbIeo/9uT8GqeTi2sKyvyDlfJ025qE/ZSpmI8lGwz8IZc6YtYDSP8vRgwa62Kw/uI49w0cp2T9WvWP2bgHZP/LCcq+RTbE/GUJLVrRXwj+x2owcxQjVP36e82eWu90/TykdvQ/L4T9BDYX3rUjKP5nm4P/jcc8/uZZriVPL4j8ExZ7TzI7RPwO2ci3O6sO/wtfGJfII1T+FnpZB99vAP/f0TPh/XsO/0ygXcQ5bxb/uNOTIrWzEv49KqYnuZcA/JVnCZZdWnD8IU+W/mhzUP5jxj+AvDZO/7ijLT43t3D/CMo2qs2TQP4BcfbvCXOU/C1YSNkUZwD8gkW5FKXPgP9JxmC6ONNK/Fb+g1WL6zD9EZy+jDenAv18pNZeD9aO/69KOR1Hm3L85R1COcgngP80EprJLLOS/U7AEmtnx1b8AEJmI6GnOvw0BtmiLxdg/4fK8QhRxqz/CArtcLPDRv4uQe+OpFNw/sTgjtmoe27+vcFcqsQjNPyQWJTu/Y6U/SdtEtzbtl79zsAkp1oLgv9jRY0wOprs/PbEptKFIwD8OM5qtkD/RP/QcmCZfjtU/l9kERlT01z9OOdGdcdrhP4Ab4BBEsMY/2pp114ehwb+ws40UNzK9P9DKt5pHjLi/3zfbu0W0Uz9BvJAxFaM8Pw13B0O7d8e/9m9xCZsL4r/xGHVKw1fRv8uel3K15dY/l+Nxu0K+0z8U8qoxYHHPvzqralCu7NK/LKc2wNf8xL+RnFzNTHGkPxbfDX825Iw/meJFiNsN2L+xaa4QLkHMv0naLxSU7a+/LDWT96K4xL9a67CTJyvJP6TOLZ//j9y/8ddGkVQIxb8FlclFAi7sv2XLZA5bcuS/IyxblLEIvD8zl4LvPMHDv9nUF5nNJtu/5jelbsOF4D+meqMOkIvxv669KDRcS+M/46PQgRQSxT9TIS2/uIzQv9UY5bbtBNK/kIkJlgTlyb9q0Cg6UAXBv4pto8jJ8+m/3pckWIy58r8joiJkx9Tkv6zx2prAfJy/64/316Vw3D+KCD5UiQ7bP7zwYgQ5xq2/vmla6e4r0b93eRIoCf7sv3sTtkpSv+Y/kSmHzLiHyb+Ca1OF2BbKv2OH7e1net8/MHNPAzsg0r8skr7119DWvzuP/tY1ONm/Ta5JNApQ5j/H6fOwVtbhP3vy41eKqeg/PUsr4eTy379dvb7F5C/AP3Km2g0FS8I/EiWCIgJ/1T+Koa2EhAbqv7N92iMHgbq/4FPhgSbR279FfYJ17ZizvzVPkA6hg+C/juECC1Tn079ly2QOW3Lkvz5hNNyCoNS/3lKuNRT7478OfhZ5JgDcv0kp23CCQtK/V/FPt+TI0L9vG4q0SGvpvz1d+JbRwd6/","dtype":"float64","order":"little","shape":[150]}},"selected":{"id":"1996"},"selection_policy":{"id":"1997"}},"id":"1965","type":"ColumnDataSource"},{"attributes":{"callback":null,"renderers":[{"id":"1989"}],"tooltips":[["sepal length (cm)","@sepal_length_cm"],["sepal width (cm)","@sepal_width_cm"],["petal length (cm)","@petal_length_cm"],["petal width (cm)","@petal_width_cm"],["Class","@class"]]},"id":"2009","type":"HoverTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"2009"}]},"id":"1985","type":"Toolbar"},{"attributes":{"data_source":{"id":"1965"},"glyph":{"id":"1987"},"hover_glyph":null,"muted_glyph":null,"name":"scatter","nonselection_glyph":{"id":"1988"},"selection_glyph":null,"view":{"id":"1990"}},"id":"1989","type":"GlyphRenderer"},{"attributes":{},"id":"1992","type":"BasicTickFormatter"},{"attributes":{"fill_alpha":{"value":0.4},"fill_color":{"field":"color"},"line_alpha":{"value":0.8},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1987","type":"Circle"},{"attributes":{},"id":"1996","type":"Selection"},{"attributes":{},"id":"1975","type":"LinearScale"},{"attributes":{},"id":"1994","type":"BasicTickFormatter"},{"attributes":{},"id":"1978","type":"BasicTicker"},{"attributes":{"axis":{"id":"1981"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1984","type":"Grid"},{"attributes":{"formatter":{"id":"1994"},"ticker":{"id":"1982"}},"id":"1981","type":"LinearAxis"},{"attributes":{"index":0,"label":{"value":"setosa"},"renderers":[{"id":"1989"}]},"id":"1999","type":"LegendItem"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"color"},"line_alpha":{"value":0.1},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1988","type":"Circle"},{"attributes":{"axis":{"id":"1977"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1980","type":"Grid"},{"attributes":{"text":"PCA Transformed Data"},"id":"1967","type":"Title"},{"attributes":{"index":50,"label":{"value":"versicolor"},"renderers":[{"id":"1989"}]},"id":"2000","type":"LegendItem"},{"attributes":{"formatter":{"id":"1992"},"ticker":{"id":"1978"}},"id":"1977","type":"LinearAxis"},{"attributes":{},"id":"1969","type":"DataRange1d"},{"attributes":{"items":[{"id":"1999"},{"id":"2000"},{"id":"2001"}],"location":"bottom_left"},"id":"1998","type":"Legend"}],"root_ids":["1966"]},"title":"Bokeh Application","version":"2.2.1"}};
  var render_items = [{"docid":"a8c8a1cf-50b9-47dc-90e3-91beeb2d773e","root_ids":["1966"],"roots":{"1966":"7a291801-1bb2-4b8b-8f37-2b00529e834e"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>Pause for a moment and appreciate how impressive this visualization is: here we’ve used an algorithm that was formulated without knowing <em>anything</em> about irises or how large their sepals and petals are supposed to be. And yet, we’ve managed to use it to build a more <em>efficient</em> representation of our data that still manages to create some clear separation between these classes! And since the algorithm didn’t rely on anything specific to this particular dataset of iris measurements, or irises at all, we could just as easily use it on another set of measurements or another problem entirely!</p>
<p>Everything we’ve done up to this point would probably be more commonly termed “data analytics” than “artificial intelligence” or “machine learning”. Sure, we used a computer to generate the plots and even execute the requisite logic, but all the intelligence was built-in manually by us, the programmer, entirely from our insights about botany.</p>
<p>What’s different about this scenario? If I was sufficiently motivated and equipped with a linear algebra textbook and a lot of time, I could have calculated the PCA matrix with pencil and paper and transformed the original matrix myself. That the computation of these values was executed using silicon and electricity was more a matter of <em>convenience</em> than of fundamental intellectual ability. If I had made this graph on paper and used it to build some classification rule, would that still be “machine learning”?</p>
<p>I would argue that it would. What separates this from the analytics we did earlier is that the <em>algorithm</em> for generating this representation (and hence any rule we might build from it) <em>does not rely on a priori knowledge of the system in question</em>. PCA is an automatic representation building <em>machine</em>. Whether those representations are always <em>useful</em> is another matter entirely, and will still require a data scientist or domain expert to determine. But in my mind what separates ML techniques from more traditional rules-based AI is the use of these domain-agnostic transformation mechanisms that can be robustly applied across a variety of ontologically disparate but statistically reconcilable problems.</p>
<p>We’ll see soon that we can take this a step farther and use ML algorithms to not only build representations, but also learn classification rules <em>from</em> those representations. We can even imagine how this might generalize to truly intelligent systems: systems which are capable of not just adapting their representations and classification rules from domain to domain, but of efficiently and robustly adapting the mechanism <em>by which</em> they learn representations and rules to new domains. Sufficiently robust mechanisms might require that the representations learned by the algorithm reflect some real knowledge or understanding of the systems in question.</p>
<p>But now we’re getting a few football fields out over our skis. Let’s get back to the problem at hand. So we have this nice 2D representation of our data. Let’s do what we did above: pick families for a couple curves that will break up our 2D space and be used to classify samples, and then figure out which curves in those families are best.</p>
<p>In this case, the family of curves I’m going to pick are straight lines, since those are easiest for me to visualize. Using the grid on the plot as a reference, I’ll take a stab at a couple lines below, and we’ll plot them with our samples and see how they look.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">line1_points</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span> <span class="c1"># line separating blue from yellow</span>
<span class="n">line2_points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span> <span class="c1"># line separating yellow from red</span>

<span class="n">p</span><span class="o">.</span><span class="n">line</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">line1_points</span><span class="p">],</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">line1_points</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;2 2&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">line</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">line2_points</span><span class="p">],</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">line2_points</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;2 2&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">





<div class="bk-root" id="fc879771-9b61-408e-8825-f4c63c451a85" data-root-id="1966"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
    
  var docs_json = {"0e7d745d-6cd4-419e-b695-e23596b13a96":{"roots":{"references":[{"attributes":{"background_fill_alpha":0.8,"background_fill_color":"#e8ded5","below":[{"id":"1977"}],"center":[{"id":"1980"},{"id":"1984"},{"id":"1998"}],"left":[{"id":"1981"}],"plot_height":500,"plot_width":500,"renderers":[{"id":"1989"},{"id":"2131"},{"id":"2220"}],"title":{"id":"1967"},"toolbar":{"id":"1985"},"x_range":{"id":"1969"},"x_scale":{"id":"1973"},"y_range":{"id":"1971"},"y_scale":{"id":"1975"}},"id":"1966","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1997","type":"UnionRenderers"},{"attributes":{"source":{"id":"2128"}},"id":"2132","type":"CDSView"},{"attributes":{"source":{"id":"2217"}},"id":"2221","type":"CDSView"},{"attributes":{"data_source":{"id":"2128"},"glyph":{"id":"2129"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"2130"},"selection_glyph":null,"view":{"id":"2132"}},"id":"2131","type":"GlyphRenderer"},{"attributes":{"source":{"id":"1965"}},"id":"1990","type":"CDSView"},{"attributes":{},"id":"1973","type":"LinearScale"},{"attributes":{"index":100,"label":{"value":"virginica"},"renderers":[{"id":"1989"}]},"id":"2001","type":"LegendItem"},{"attributes":{},"id":"2216","type":"UnionRenderers"},{"attributes":{},"id":"1971","type":"DataRange1d"},{"attributes":{},"id":"2215","type":"Selection"},{"attributes":{},"id":"1982","type":"BasicTicker"},{"attributes":{"line_alpha":0.1,"line_color":"#000000","line_dash":[2,2],"line_width":1.5,"x":{"field":"x"},"y":{"field":"y"}},"id":"2130","type":"Line"},{"attributes":{"line_alpha":0.1,"line_color":"#000000","line_dash":[2,2],"line_width":1.5,"x":{"field":"x"},"y":{"field":"y"}},"id":"2219","type":"Line"},{"attributes":{"data_source":{"id":"2217"},"glyph":{"id":"2218"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"2219"},"selection_glyph":null,"view":{"id":"2221"}},"id":"2220","type":"GlyphRenderer"},{"attributes":{"data":{"class":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"color":["#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#74add1","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#fdae61","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43","#f46d43"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"petal_length_cm":{"__ndarray__":"ZmZmZmZm9j9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D9mZmZmZmb2PzMzMzMzM/s/ZmZmZmZm9j8AAAAAAAD4P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P5qZmZmZmfk/ZmZmZmZm9j+amZmZmZnxPzMzMzMzM/M/AAAAAAAA+D/NzMzMzMz0P2ZmZmZmZvY/MzMzMzMz+z8AAAAAAAD4PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwPzMzMzMzM/s/ZmZmZmZm/j+amZmZmZn5P5qZmZmZmfk/AAAAAAAA+D9mZmZmZmb2P5qZmZmZmfk/mpmZmZmZ+T8AAAAAAAD4PwAAAAAAAPg/ZmZmZmZm9j8AAAAAAAD4PzMzMzMzM/M/zczMzMzM9D9mZmZmZmb2P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P83MzMzMzPQ/zczMzMzM9D+amZmZmZn5P2ZmZmZmZv4/ZmZmZmZm9j+amZmZmZn5P2ZmZmZmZvY/AAAAAAAA+D9mZmZmZmb2P83MzMzMzBJAAAAAAAAAEkCamZmZmZkTQAAAAAAAABBAZmZmZmZmEkAAAAAAAAASQM3MzMzMzBJAZmZmZmZmCkBmZmZmZmYSQDMzMzMzMw9AAAAAAAAADEDNzMzMzMwQQAAAAAAAABBAzczMzMzMEkDNzMzMzMwMQJqZmZmZmRFAAAAAAAAAEkBmZmZmZmYQQAAAAAAAABJAMzMzMzMzD0AzMzMzMzMTQAAAAAAAABBAmpmZmZmZE0DNzMzMzMwSQDMzMzMzMxFAmpmZmZmZEUAzMzMzMzMTQAAAAAAAABRAAAAAAAAAEkAAAAAAAAAMQGZmZmZmZg5AmpmZmZmZDUAzMzMzMzMPQGZmZmZmZhRAAAAAAAAAEkAAAAAAAAASQM3MzMzMzBJAmpmZmZmZEUBmZmZmZmYQQAAAAAAAABBAmpmZmZmZEUBmZmZmZmYSQAAAAAAAABBAZmZmZmZmCkDNzMzMzMwQQM3MzMzMzBBAzczMzMzMEEAzMzMzMzMRQAAAAAAAAAhAZmZmZmZmEEAAAAAAAAAYQGZmZmZmZhRAmpmZmZmZF0BmZmZmZmYWQDMzMzMzMxdAZmZmZmZmGkAAAAAAAAASQDMzMzMzMxlAMzMzMzMzF0BmZmZmZmYYQGZmZmZmZhRAMzMzMzMzFUAAAAAAAAAWQAAAAAAAABRAZmZmZmZmFEAzMzMzMzMVQAAAAAAAABZAzczMzMzMGkCamZmZmZkbQAAAAAAAABRAzczMzMzMFkCamZmZmZkTQM3MzMzMzBpAmpmZmZmZE0DNzMzMzMwWQAAAAAAAABhAMzMzMzMzE0CamZmZmZkTQGZmZmZmZhZAMzMzMzMzF0BmZmZmZmYYQJqZmZmZmRlAZmZmZmZmFkBmZmZmZmYUQGZmZmZmZhZAZmZmZmZmGEBmZmZmZmYWQAAAAAAAABZAMzMzMzMzE0CamZmZmZkVQGZmZmZmZhZAZmZmZmZmFEBmZmZmZmYUQJqZmZmZmRdAzczMzMzMFkDNzMzMzMwUQAAAAAAAABRAzczMzMzMFECamZmZmZkVQGZmZmZmZhRA","dtype":"float64","order":"little","shape":[150]},"petal_width_cm":{"__ndarray__":"mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZnJP5qZmZmZmck/mpmZmZmZuT+amZmZmZm5P5qZmZmZmck/mpmZmZmZ2T+amZmZmZnZPzMzMzMzM9M/MzMzMzMz0z8zMzMzMzPTP5qZmZmZmck/mpmZmZmZ2T+amZmZmZnJPwAAAAAAAOA/mpmZmZmZyT+amZmZmZnJP5qZmZmZmdk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnZP5qZmZmZmbk/mpmZmZmZyT+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZm5P5qZmZmZmck/mpmZmZmZyT8zMzMzMzPTPzMzMzMzM9M/mpmZmZmZyT8zMzMzMzPjP5qZmZmZmdk/MzMzMzMz0z+amZmZmZnJP5qZmZmZmck/mpmZmZmZyT+amZmZmZnJP2ZmZmZmZvY/AAAAAAAA+D8AAAAAAAD4P83MzMzMzPQ/AAAAAAAA+D/NzMzMzMz0P5qZmZmZmfk/AAAAAAAA8D/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAPA/ZmZmZmZm9j/NzMzMzMz0P2ZmZmZmZvY/AAAAAAAA+D8AAAAAAADwPwAAAAAAAPg/mpmZmZmZ8T/NzMzMzMz8P83MzMzMzPQ/AAAAAAAA+D8zMzMzMzPzP83MzMzMzPQ/ZmZmZmZm9j9mZmZmZmb2PzMzMzMzM/s/AAAAAAAA+D8AAAAAAADwP5qZmZmZmfE/AAAAAAAA8D8zMzMzMzPzP5qZmZmZmfk/AAAAAAAA+D+amZmZmZn5PwAAAAAAAPg/zczMzMzM9D/NzMzMzMz0P83MzMzMzPQ/MzMzMzMz8z9mZmZmZmb2PzMzMzMzM/M/AAAAAAAA8D/NzMzMzMz0PzMzMzMzM/M/zczMzMzM9D/NzMzMzMz0P5qZmZmZmfE/zczMzMzM9D8AAAAAAAAEQGZmZmZmZv4/zczMzMzMAEDNzMzMzMz8P5qZmZmZmQFAzczMzMzMAEAzMzMzMzP7P83MzMzMzPw/zczMzMzM/D8AAAAAAAAEQAAAAAAAAABAZmZmZmZm/j/NzMzMzMwAQAAAAAAAAABAMzMzMzMzA0BmZmZmZmYCQM3MzMzMzPw/mpmZmZmZAUBmZmZmZmYCQAAAAAAAAPg/ZmZmZmZmAkAAAAAAAAAAQAAAAAAAAABAzczMzMzM/D/NzMzMzMwAQM3MzMzMzPw/zczMzMzM/D/NzMzMzMz8P83MzMzMzABAmpmZmZmZ+T9mZmZmZmb+PwAAAAAAAABAmpmZmZmZAUAAAAAAAAD4P2ZmZmZmZvY/ZmZmZmZmAkAzMzMzMzMDQM3MzMzMzPw/zczMzMzM/D/NzMzMzMwAQDMzMzMzMwNAZmZmZmZmAkBmZmZmZmb+P2ZmZmZmZgJAAAAAAAAABEBmZmZmZmYCQGZmZmZmZv4/AAAAAAAAAEBmZmZmZmYCQM3MzMzMzPw/","dtype":"float64","order":"little","shape":[150]},"sepal_length_cm":{"__ndarray__":"ZmZmZmZmFECamZmZmZkTQM3MzMzMzBJAZmZmZmZmEkAAAAAAAAAUQJqZmZmZmRVAZmZmZmZmEkAAAAAAAAAUQJqZmZmZmRFAmpmZmZmZE0CamZmZmZkVQDMzMzMzMxNAMzMzMzMzE0AzMzMzMzMRQDMzMzMzMxdAzczMzMzMFkCamZmZmZkVQGZmZmZmZhRAzczMzMzMFkBmZmZmZmYUQJqZmZmZmRVAZmZmZmZmFEBmZmZmZmYSQGZmZmZmZhRAMzMzMzMzE0AAAAAAAAAUQAAAAAAAABRAzczMzMzMFEDNzMzMzMwUQM3MzMzMzBJAMzMzMzMzE0CamZmZmZkVQM3MzMzMzBRAAAAAAAAAFkCamZmZmZkTQAAAAAAAABRAAAAAAAAAFkCamZmZmZkTQJqZmZmZmRFAZmZmZmZmFEAAAAAAAAAUQAAAAAAAABJAmpmZmZmZEUAAAAAAAAAUQGZmZmZmZhRAMzMzMzMzE0BmZmZmZmYUQGZmZmZmZhJAMzMzMzMzFUAAAAAAAAAUQAAAAAAAABxAmpmZmZmZGUCamZmZmZkbQAAAAAAAABZAAAAAAAAAGkDNzMzMzMwWQDMzMzMzMxlAmpmZmZmZE0BmZmZmZmYaQM3MzMzMzBRAAAAAAAAAFECamZmZmZkXQAAAAAAAABhAZmZmZmZmGEBmZmZmZmYWQM3MzMzMzBpAZmZmZmZmFkAzMzMzMzMXQM3MzMzMzBhAZmZmZmZmFkCamZmZmZkXQGZmZmZmZhhAMzMzMzMzGUBmZmZmZmYYQJqZmZmZmRlAZmZmZmZmGkAzMzMzMzMbQM3MzMzMzBpAAAAAAAAAGEDNzMzMzMwWQAAAAAAAABZAAAAAAAAAFkAzMzMzMzMXQAAAAAAAABhAmpmZmZmZFUAAAAAAAAAYQM3MzMzMzBpAMzMzMzMzGUBmZmZmZmYWQAAAAAAAABZAAAAAAAAAFkBmZmZmZmYYQDMzMzMzMxdAAAAAAAAAFEBmZmZmZmYWQM3MzMzMzBZAzczMzMzMFkDNzMzMzMwYQGZmZmZmZhRAzczMzMzMFkAzMzMzMzMZQDMzMzMzMxdAZmZmZmZmHEAzMzMzMzMZQAAAAAAAABpAZmZmZmZmHkCamZmZmZkTQDMzMzMzMx1AzczMzMzMGkDNzMzMzMwcQAAAAAAAABpAmpmZmZmZGUAzMzMzMzMbQM3MzMzMzBZAMzMzMzMzF0CamZmZmZkZQAAAAAAAABpAzczMzMzMHkDNzMzMzMweQAAAAAAAABhAmpmZmZmZG0BmZmZmZmYWQM3MzMzMzB5AMzMzMzMzGUDNzMzMzMwaQM3MzMzMzBxAzczMzMzMGEBmZmZmZmYYQJqZmZmZmRlAzczMzMzMHECamZmZmZkdQJqZmZmZmR9AmpmZmZmZGUAzMzMzMzMZQGZmZmZmZhhAzczMzMzMHkAzMzMzMzMZQJqZmZmZmRlAAAAAAAAAGECamZmZmZkbQM3MzMzMzBpAmpmZmZmZG0AzMzMzMzMXQDMzMzMzMxtAzczMzMzMGkDNzMzMzMwaQDMzMzMzMxlAAAAAAAAAGkDNzMzMzMwYQJqZmZmZmRdA","dtype":"float64","order":"little","shape":[150]},"sepal_width_cm":{"__ndarray__":"AAAAAAAADEAAAAAAAAAIQJqZmZmZmQlAzczMzMzMCEDNzMzMzMwMQDMzMzMzMw9AMzMzMzMzC0AzMzMzMzMLQDMzMzMzMwdAzczMzMzMCECamZmZmZkNQDMzMzMzMwtAAAAAAAAACEAAAAAAAAAIQAAAAAAAABBAmpmZmZmZEUAzMzMzMzMPQAAAAAAAAAxAZmZmZmZmDkBmZmZmZmYOQDMzMzMzMwtAmpmZmZmZDUDNzMzMzMwMQGZmZmZmZgpAMzMzMzMzC0AAAAAAAAAIQDMzMzMzMwtAAAAAAAAADEAzMzMzMzMLQJqZmZmZmQlAzczMzMzMCEAzMzMzMzMLQGZmZmZmZhBAzczMzMzMEEDNzMzMzMwIQJqZmZmZmQlAAAAAAAAADEDNzMzMzMwMQAAAAAAAAAhAMzMzMzMzC0AAAAAAAAAMQGZmZmZmZgJAmpmZmZmZCUAAAAAAAAAMQGZmZmZmZg5AAAAAAAAACEBmZmZmZmYOQJqZmZmZmQlAmpmZmZmZDUBmZmZmZmYKQJqZmZmZmQlAmpmZmZmZCUDNzMzMzMwIQGZmZmZmZgJAZmZmZmZmBkBmZmZmZmYGQGZmZmZmZgpAMzMzMzMzA0AzMzMzMzMHQJqZmZmZmQVAAAAAAAAAAEAAAAAAAAAIQJqZmZmZmQFAMzMzMzMzB0AzMzMzMzMHQM3MzMzMzAhAAAAAAAAACECamZmZmZkFQJqZmZmZmQFAAAAAAAAABECamZmZmZkJQGZmZmZmZgZAAAAAAAAABEBmZmZmZmYGQDMzMzMzMwdAAAAAAAAACEBmZmZmZmYGQAAAAAAAAAhAMzMzMzMzB0DNzMzMzMwEQDMzMzMzMwNAMzMzMzMzA0CamZmZmZkFQJqZmZmZmQVAAAAAAAAACEAzMzMzMzMLQM3MzMzMzAhAZmZmZmZmAkAAAAAAAAAIQAAAAAAAAARAzczMzMzMBEAAAAAAAAAIQM3MzMzMzARAZmZmZmZmAkCamZmZmZkFQAAAAAAAAAhAMzMzMzMzB0AzMzMzMzMHQAAAAAAAAARAZmZmZmZmBkBmZmZmZmYKQJqZmZmZmQVAAAAAAAAACEAzMzMzMzMHQAAAAAAAAAhAAAAAAAAACEAAAAAAAAAEQDMzMzMzMwdAAAAAAAAABEDNzMzMzMwMQJqZmZmZmQlAmpmZmZmZBUAAAAAAAAAIQAAAAAAAAARAZmZmZmZmBkCamZmZmZkJQAAAAAAAAAhAZmZmZmZmDkDNzMzMzMwEQJqZmZmZmQFAmpmZmZmZCUBmZmZmZmYGQGZmZmZmZgZAmpmZmZmZBUBmZmZmZmYKQJqZmZmZmQlAZmZmZmZmBkAAAAAAAAAIQGZmZmZmZgZAAAAAAAAACEBmZmZmZmYGQGZmZmZmZg5AZmZmZmZmBkBmZmZmZmYGQM3MzMzMzARAAAAAAAAACEAzMzMzMzMLQM3MzMzMzAhAAAAAAAAACEDNzMzMzMwIQM3MzMzMzAhAzczMzMzMCECamZmZmZkFQJqZmZmZmQlAZmZmZmZmCkAAAAAAAAAIQAAAAAAAAARAAAAAAAAACEAzMzMzMzMLQAAAAAAAAAhA","dtype":"float64","order":"little","shape":[150]},"x":{"__ndarray__":"aEg6srHeAMDrBiki1FgBwHSRfcK5+ALAOwDC5c3RAsAD3suo2YkBwDPVy5iShvu/+wVzyRHtAsB/FrCIWwEBwFu6Qazi8wPAkNFMGGG7AcCHWTxX0mH+vzJ6t1UtzwHAS14lVTZxAsDHY0cveggGwPjBQNBvevy/bRJ7BT2h+r+8z1YyQNP9v4tSWj8DUgDArg/3kNAa+b+Hj4gvymYAwKijt0PCfvy/IMtmDE91/79Q4QJ2/94EwFLBN6b5Ofy/P1wjPGzyAMDH5qn79DkAwOaWfd/RPP+/lIfsPmgJAMDLsqi7iTMAwIBz6aj4GwLA5d1XstBwAcB3Sf1EX3L7vwu2i/jPUgHAJ176XSAY/7+z22ylsi4BwD/MWTU0nwHAYUP0yfDy/b9iNcjbO6ICwMZN6JXsXATA/bSTyKd1AMBdE6iyTCcBwLOJt+VcaALA+rXSAtWbBMCkJ+iAAEn9v8o4xt+JZ/2/kHJlb9lXAcATJjfv4qkAwKWTaM/XOgPAjBx11zl5/7+2QWwFfSsBwL3AOl735PM/OjrB6yCX6j/uznH9K0z1P7NkO5a/kKM/Hn9LIIrj7z9fRfRxj8LRP8a1hXboaew/iTEA3ysC67/SheivFC/tP94MJ8IF+ci/X2+w3WuP5L8kisVtZmvaP+x5wsvpIsg/Yzz2RRqe5T+gbPZQlZHAv/9HpS5OSO4/gVW9N5U41D+Bar9qvxeHPyxSLm2rI+s/W4XM7Ij8uL88mlmyR7jpP/KQyXWjudc/CK6biTE58D/fXcuId7bhP/oBtUhyXuU/WpIICFCX7D8kmtV39UTzPy9HzZsqIvY/S5N5d1dV4z8ZTyXrT3XQvzwO70OY28e/jzCCUu2f0r9okP3YJ6mzPyb7Q8O7ae0/z3rua7L6xj+/WNEB/RLjP6DLOjAG9/E/ntsFMN9I5z9IbJAcvdehP6m+Ct0itX4/kRXbm9YxsT+37luf8vnjP+L+54YyZcA/HNu5BIxV6L/zqWdgKeq9P/+UAZw+/7E/82lT48nBwz/p9dFH1ADhPzmWwlKpYui/eLaQF7IfwT+t0gWCbJL/P3N14CRLpO8/7lqUZuEIAkDYBuVT1o/2P91QMUuHC/4/rt17DXzGBkB1F7wOl/KqP7jtZ5EIwAJA/DA31WwP/T/tGdQRwZ0EQJByKdnMVPc/GEqKYOmE9z9HcvOy3n7+P2zq0taAfe8/K21Fog0S9T8C8PXW0q/6PwxmCYGR7Pc/k/P/P9IsB0BHGcGmHsYJQG+4Jmy/hew/0FzO+MI4AUDqdR186K7qP9kQ1Hr/TQdA0aAGYXcH8z/v88C4FNH9P/bRVxQ3+QBA+LaADfwd8T8u4tUZ7xvwP0H1R/I8Mvs/mR8/ai4X/z+PunaUs2QDQOqs5MAbTgZA/OAH2JlL/D+w8qEPz6LwP30KMwNNuPA/V05hM6D7BkA2hNCVee37P9U65pNBlvY/EMF0Zrji7D95Dt9fMsT+P3FkuW7ogwBABao2+Gk9/z9zdeAkS6TvP++5FJ86QAFAbVHgJ0QbAUDTShLLruD9P5Mb/obQMfU/mgFhGcll+D81WBJjXpb4P9ayU8ztJu4/","dtype":"float64","order":"little","shape":[150]},"y":{"__ndarray__":"+MwaN/ko1D99atFd/PjJP9Qzn5ROPaY/YRQ914M2dL9NuaPvBqHOP1snhYNGRNQ/B+kPVERHwb8kBGd3jIzQP3OgGlDcKsK/nELvBQbf0z9LfhV/+bTgP+WV1PBTL8A/IDtrFY91zj+0neTs3n3Bv2AV03XPXeg/kjaRflXl3j8Db3kMozTSP+0h3FmU3Mo/ej3dVBto5D/hUeuvBbzJP3AXNnb6wuE/lSbIeo/9uT8GqeTi2sKyvyDlfJ025qE/ZSpmI8lGwz8IZc6YtYDSP8vRgwa62Kw/uI49w0cp2T9WvWP2bgHZP/LCcq+RTbE/GUJLVrRXwj+x2owcxQjVP36e82eWu90/TykdvQ/L4T9BDYX3rUjKP5nm4P/jcc8/uZZriVPL4j8ExZ7TzI7RPwO2ci3O6sO/wtfGJfII1T+FnpZB99vAP/f0TPh/XsO/0ygXcQ5bxb/uNOTIrWzEv49KqYnuZcA/JVnCZZdWnD8IU+W/mhzUP5jxj+AvDZO/7ijLT43t3D/CMo2qs2TQP4BcfbvCXOU/C1YSNkUZwD8gkW5FKXPgP9JxmC6ONNK/Fb+g1WL6zD9EZy+jDenAv18pNZeD9aO/69KOR1Hm3L85R1COcgngP80EprJLLOS/U7AEmtnx1b8AEJmI6GnOvw0BtmiLxdg/4fK8QhRxqz/CArtcLPDRv4uQe+OpFNw/sTgjtmoe27+vcFcqsQjNPyQWJTu/Y6U/SdtEtzbtl79zsAkp1oLgv9jRY0wOprs/PbEptKFIwD8OM5qtkD/RP/QcmCZfjtU/l9kERlT01z9OOdGdcdrhP4Ab4BBEsMY/2pp114ehwb+ws40UNzK9P9DKt5pHjLi/3zfbu0W0Uz9BvJAxFaM8Pw13B0O7d8e/9m9xCZsL4r/xGHVKw1fRv8uel3K15dY/l+Nxu0K+0z8U8qoxYHHPvzqralCu7NK/LKc2wNf8xL+RnFzNTHGkPxbfDX825Iw/meJFiNsN2L+xaa4QLkHMv0naLxSU7a+/LDWT96K4xL9a67CTJyvJP6TOLZ//j9y/8ddGkVQIxb8FlclFAi7sv2XLZA5bcuS/IyxblLEIvD8zl4LvPMHDv9nUF5nNJtu/5jelbsOF4D+meqMOkIvxv669KDRcS+M/46PQgRQSxT9TIS2/uIzQv9UY5bbtBNK/kIkJlgTlyb9q0Cg6UAXBv4pto8jJ8+m/3pckWIy58r8joiJkx9Tkv6zx2prAfJy/64/316Vw3D+KCD5UiQ7bP7zwYgQ5xq2/vmla6e4r0b93eRIoCf7sv3sTtkpSv+Y/kSmHzLiHyb+Ca1OF2BbKv2OH7e1net8/MHNPAzsg0r8skr7119DWvzuP/tY1ONm/Ta5JNApQ5j/H6fOwVtbhP3vy41eKqeg/PUsr4eTy379dvb7F5C/AP3Km2g0FS8I/EiWCIgJ/1T+Koa2EhAbqv7N92iMHgbq/4FPhgSbR279FfYJ17ZizvzVPkA6hg+C/juECC1Tn079ly2QOW3Lkvz5hNNyCoNS/3lKuNRT7478OfhZ5JgDcv0kp23CCQtK/V/FPt+TI0L9vG4q0SGvpvz1d+JbRwd6/","dtype":"float64","order":"little","shape":[150]}},"selected":{"id":"1996"},"selection_policy":{"id":"1997"}},"id":"1965","type":"ColumnDataSource"},{"attributes":{},"id":"2306","type":"Selection"},{"attributes":{"callback":null,"renderers":[{"id":"1989"}],"tooltips":[["sepal length (cm)","@sepal_length_cm"],["sepal width (cm)","@sepal_width_cm"],["petal length (cm)","@petal_length_cm"],["petal width (cm)","@petal_width_cm"],["Class","@class"]]},"id":"2009","type":"HoverTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"2009"}]},"id":"1985","type":"Toolbar"},{"attributes":{"data_source":{"id":"1965"},"glyph":{"id":"1987"},"hover_glyph":null,"muted_glyph":null,"name":"scatter","nonselection_glyph":{"id":"1988"},"selection_glyph":null,"view":{"id":"1990"}},"id":"1989","type":"GlyphRenderer"},{"attributes":{},"id":"2307","type":"UnionRenderers"},{"attributes":{"line_alpha":0.6,"line_color":"#000000","line_dash":[2,2],"line_width":1.5,"x":{"field":"x"},"y":{"field":"y"}},"id":"2129","type":"Line"},{"attributes":{},"id":"1992","type":"BasicTickFormatter"},{"attributes":{"fill_alpha":{"value":0.4},"fill_color":{"field":"color"},"line_alpha":{"value":0.8},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1987","type":"Circle"},{"attributes":{},"id":"1996","type":"Selection"},{"attributes":{},"id":"1975","type":"LinearScale"},{"attributes":{},"id":"1994","type":"BasicTickFormatter"},{"attributes":{},"id":"1978","type":"BasicTicker"},{"attributes":{"data":{"x":[-3,0],"y":[-1,0.5]},"selected":{"id":"2215"},"selection_policy":{"id":"2216"}},"id":"2128","type":"ColumnDataSource"},{"attributes":{"axis":{"id":"1981"},"dimension":1,"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1984","type":"Grid"},{"attributes":{"data":{"x":[0,2],"y":[-1,0.5]},"selected":{"id":"2306"},"selection_policy":{"id":"2307"}},"id":"2217","type":"ColumnDataSource"},{"attributes":{"formatter":{"id":"1994"},"ticker":{"id":"1982"}},"id":"1981","type":"LinearAxis"},{"attributes":{"line_alpha":0.6,"line_color":"#000000","line_dash":[2,2],"line_width":1.5,"x":{"field":"x"},"y":{"field":"y"}},"id":"2218","type":"Line"},{"attributes":{"index":0,"label":{"value":"setosa"},"renderers":[{"id":"1989"}]},"id":"1999","type":"LegendItem"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"color"},"line_alpha":{"value":0.1},"line_color":{"field":"color"},"line_width":{"value":1.2},"size":{"units":"screen","value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1988","type":"Circle"},{"attributes":{"axis":{"id":"1977"},"grid_line_color":"#ffffff","grid_line_width":2,"ticker":null},"id":"1980","type":"Grid"},{"attributes":{"text":"PCA Transformed Data"},"id":"1967","type":"Title"},{"attributes":{"index":50,"label":{"value":"versicolor"},"renderers":[{"id":"1989"}]},"id":"2000","type":"LegendItem"},{"attributes":{"formatter":{"id":"1992"},"ticker":{"id":"1978"}},"id":"1977","type":"LinearAxis"},{"attributes":{},"id":"1969","type":"DataRange1d"},{"attributes":{"items":[{"id":"1999"},{"id":"2000"},{"id":"2001"}],"location":"bottom_left"},"id":"1998","type":"Legend"}],"root_ids":["1966"]},"title":"Bokeh Application","version":"2.2.1"}};
  var render_items = [{"docid":"0e7d745d-6cd4-419e-b695-e23596b13a96","root_ids":["1966"],"roots":{"1966":"fc879771-9b61-408e-8825-f4c63c451a85"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>Those look about as good as I’m going to get without zooming in, so let’s see how our accuracy looks now by checking which side of each line our points fall.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pca_rules_based_ai_classifier</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
    <span class="n">distance_from_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line_points</span> <span class="ow">in</span> <span class="p">[</span><span class="n">line1_points</span><span class="p">,</span> <span class="n">line2_points</span><span class="p">]:</span>
        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">line_points</span>
        <span class="n">distance_from_line</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
        <span class="n">distance_from_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance_from_line</span><span class="p">)</span>

    <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">distance_from_lines</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;setosa&#39;</span>
    <span class="k">elif</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;versicolor&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;virginica&#39;</span>

<span class="n">num_right</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">wrong_rows</span><span class="p">,</span> <span class="n">wrong_predictions</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row_id</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_2d</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">pca_rules_based_ai_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="n">prediction</span><span class="p">:</span>
        <span class="n">num_right</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrong_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_id</span><span class="p">)</span>
        <span class="n">wrong_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">num_right</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">{:0.2f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy</span><span class="p">))</span>

<span class="n">wrong_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wrong_rows</span><span class="p">]</span>
<span class="n">wrong_df</span><span class="p">[</span><span class="s2">&quot;predicted class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrong_predictions</span>
<span class="n">wrong_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Accuracy: 96.67%
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>class</th>
      <th>predicted class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>70</th>
      <td>5.9</td>
      <td>3.2</td>
      <td>4.8</td>
      <td>1.8</td>
      <td>versicolor</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>119</th>
      <td>6.0</td>
      <td>2.2</td>
      <td>5.0</td>
      <td>1.5</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>129</th>
      <td>7.2</td>
      <td>3.0</td>
      <td>5.8</td>
      <td>1.6</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>133</th>
      <td>6.3</td>
      <td>2.8</td>
      <td>5.1</td>
      <td>1.5</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>134</th>
      <td>6.1</td>
      <td>2.6</td>
      <td>5.6</td>
      <td>1.4</td>
      <td>virginica</td>
      <td>versicolor</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So the good news is that we made another slight improvement! But the even better news is that, once again, we did it using a representation that took more or less <em>no work</em> and <em>no thought</em> (at least about irises) to generate. Sure, we had to code up the PCA implementation. But now that we have it, we can use it forever. In fact, we didn’t even really need to put in this work at all. Most (read: all, unless you’re doing some groundbreaking research) of these common ML algorithms are already available in open-sourced implementations in Python libraries like SKLearn, RAPIDS (for GPU usage), and TensorFlow. But where would the fun in that have been?</p>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Hopefully, this has provided some helpful insights into what ML is trying to <em>do</em>, and what distinguishes it as a sub-category of artificial intelligence. Of course, this is just the beginning. The question of <em>how</em> ML does these things, and what we can do as data scientists to leverage it most effectively, is a rich and fascinating topic that I’m hoping to explore more in a follow-up notebook to this. In the meantime, I encourage the reader to think critically about not only the math and code that we’ve used here, but about the philosophical issues at play as well.</p>
<p>For example, we’ve been measuring the quality of our classification rules by evaluating their accuracy on our dataset. However, we used that same dataset to inform our understanding of the problem and build those rules in the first place, so shouldn’t we <em>expect</em> that the rules perform reasonably well? We never considered building deliberately <em>worse</em> rules at any point. This seems relevant because, ultimately, we don’t care about how well our rule does on <em>this</em> dataset: once I’ve used it to make my rules, I frankly don’t care if I ever see this data again. We care about how well our rule will perform on <em>new</em> data we’ve never seen before! After all, that’s the data that we don’t already have classified, and is presumably why we undertook this whole exercise to begin with. So does our evaluation of our rules on the data used to <em>inform</em> those rules represent an accurate estimate of how well I should expect those same rules to perform “in the wild”?</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alec Gunny<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>